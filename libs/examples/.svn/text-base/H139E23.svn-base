"Source: Text/Geometry/ModSym.text";
"Line: 2549";
"Date: Tue Jun  7 22:27:14 2016";
"Main: Mon May 30 13:40:42 2016";
// original file: Text/Geometry/ModSym.text, line: 2549
// Example: H139E23 ()
print "Example: H139E23";
ei := GetEchoInput();
SetEchoInput(true);
M43 := ModularSymbols(43,2);     // Level 43, weight 2.
H1  := CuspidalSubspace(M43);    // H_1(X_0(43),Q)
D   := NewformDecomposition(H1); // factors corresponding to newforms
A,B := Explode(D);
A;     // The homology of the elliptic curve "43A"
B;     // The homology of the 2-dimensional abelian variety "43B"
LRatio(B,1);        // L(B,1)/Omega_B
T := TorsionBound(B,11);  T; // #B(Q) divides this number
// Compute the subgroup of B(Q) generated by (0)-(oo). 
C := SubgroupOfTorus(B,WindingElement(M43));  C;
TamagawaNumber(B,43);
assert $1 eq 7;
ShaAn := LRatio(B,1)*TorsionBound(B,11)^2/TamagawaNumber(B,43);
ShaAn; 
assert $1 eq 2;
qEigenform(B,12);
BaseRing(Parent(qEigenform(B,12)));
qIntegralBasis(B,12);
Periods(B,97);   
G := MordellWeilGroup(EllipticCurve(A)); G;
IntersectionGroup(A,B);
SetEchoInput(ei);
