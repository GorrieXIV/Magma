freeze;

// test cases for code 
K := QuadraticField(2); w := K.1;

// reducible
G := MatrixGroup< 8, K |
    [w-1,0,1,1,0,0,0,0,0,-1,0,0,1,1,0,0,2*w-4,0,-w+1,-w+1,0,0,0,1,0,0,0,0,
     0,0,0,-1,0,-2,0,0,1,1,1,-w+1,0,0,0,0,0,0,-1,w-1,0,0,0,w-1,0,1,0,0,0,
     0,0,1,0,0,0,0],
    [0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,-w+1,-w+1,0,-1,-1,0,0,0,-w,1,0,0,0,0,0,
     0,0,0,1,0,0,-1,-1,0,0,0,1,0,0,0,0,0,0,-w+1,-1,0,w-1,0,1,1,0,-1,0,0,1,
     0,0,0,1],
    [1,0,0,-1,0,0,0,-1,0,1,0,0,0,-1,-1,w-1,-w,0,0,w,0,0,0,w-1,-w+2,0,-1,
     -1,0,0,0,-1,0,0,0,0,0,0,-1,w-1,0,2,0,0,-1,-1,-1,w-1,-w+2,0,w-1,0,1,0,
     0,0,w,0,1,0,0,0,0,0]
    >;
G;
IsIrreducibleFiniteNilpotent(G);

// irreducible but (evidently) imprimitive
G := MatrixGroup< 8, K |
    [1/2*w,1/2*w,0,0,0,0,0,0,-1/2*w,1/2*w,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,
     0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,
     0,0,0,1],
    [1,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,
     0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1],
    [0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,
    0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0]
    >;
G;
IsIrreducibleFiniteNilpotent(G);
r, B := IsPrimitiveFiniteNilpotent(G);
r;
#B;

// primitive
G := MatrixGroup< 4, Rationals() |
    [ 0, 1, -1, -1, -1, -1, 1, 0, -1, -1, 0, -1, 1, 0, 1, 1 ],
    [ 0, 0, 0, 1, 0, 0, -1, -1, 0, -1, 0, 0, 1, 1, 0, 0 ] >;
G;
IsIrreducibleFiniteNilpotent(G);
IsPrimitiveFiniteNilpotent(G);
