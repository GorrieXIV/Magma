freeze;

// A Atlas generators and AW corresponding SLPs for SL(4, 3)
// return LGO standard generators + words 

SL43AtlasToLGOGens := function (G, A, AW)
W := SLPGroup (2);

words := 
[ function(W)
    w2 := W.2^-1; w3 := W.1 * W.2; w4 := w2 * w3; w5 := W.1^-1; w6 := w2 * 
    w5; w7 := w5 * w6; w8 := w4 * w7; w1 := W.1^-2; w35 := w8 * w1; w14 := 
    w8^3; w10 := w2 * w8; w11 := w2 * w1; w12 := w5 * w11; w13 := w10 * 
    w12; w9 := w8^-1; w15 := w13 * w9; w16 := w14 * w15; w19 := w13^2; w17 
    := w16 * w13; w18 := w17^2; w20 := w13^-2; w21 := w18 * w20; w22 := w19
    * w21; w36 := w22 * w8; w37 := w16 * w36; w38 := w35 * w37; w25 := 
    w13^-1; w39 := w16^-1; w23 := w16 * w18; w24 := w22^-1; w26 := w24 * 
    w25; w27 := w23 * w26; w40 := w27^-1; w41 := w39 * w40; w42 := w25 * 
    w41; w30 := w22^-2; w32 := w17^-2; w43 := w30 * w32; w44 := w42 * w43; 
    w45 := w38 * w44; w46 := w45 * w18; w47 := w46 * w18; w48 := w47 * w22;
    w49 := w48 * w13; w50 := w49 * w13; w51 := w50 * w13; w52 := w51 * w16;
    w53 := w52 * w13; w54 := w53 * w16; w55 := w54 * w16; w56 := w55 * w1; 
    w57 := w56 * w8; w58 := w57 * w8; w59 := w58 * w8; w60 := w59 * w8; w61
    := w60 * w8; w62 := w61 * w8; w63 := w62 * w13; w64 := w63 * w8; w65 :=
    w64 * W.2; return w65;
end function where W is SLPGroup(2), function(W)
    w2 := W.2^-1; w3 := W.1 * W.2; w4 := w2 * w3; w5 := W.1^-1; w6 := w2 * 
    w5; w7 := w5 * w6; w8 := w4 * w7; w1 := W.1^-2; w35 := w8 * w1; w14 := 
    w8^3; w10 := w2 * w8; w11 := w2 * w1; w12 := w5 * w11; w13 := w10 * 
    w12; w9 := w8^-1; w15 := w13 * w9; w16 := w14 * w15; w19 := w13^2; w17 
    := w16 * w13; w18 := w17^2; w20 := w13^-2; w21 := w18 * w20; w22 := w19
    * w21; w36 := w22 * w8; w37 := w16 * w36; w38 := w35 * w37; w25 := 
    w13^-1; w39 := w16^-1; w23 := w16 * w18; w24 := w22^-1; w26 := w24 * 
    w25; w27 := w23 * w26; w40 := w27^-1; w41 := w39 * w40; w42 := w25 * 
    w41; w30 := w22^-2; w32 := w17^-2; w43 := w30 * w32; w44 := w42 * w43; 
    w45 := w38 * w44; w66 := w45 * w27; w67 := w66 * w27; w68 := w67 * w13;
    w69 := w68 * w13; w70 := w69 * w13; w71 := w70 * w8; w72 := w71 * w8; 
    w73 := w72 * w8; w74 := w73 * w8; w75 := w74 * w8; w76 := w75 * w8; w77
    := w76 * w8; w78 := w77 * w8; w79 := w78 * w8; w80 := w79 * w8; w81 := 
    w80 * W.1; w82 := w81 * W.2; w83 := w82 * W.2; w84 := w83 * W.1; w85 :=
    w84 * W.2; return w85;
end function where W is SLPGroup(2), function(W)
    w2 := W.2^-1; w3 := W.1 * W.2; w4 := w2 * w3; w5 := W.1^-1; w6 := w2 * 
    w5; w7 := w5 * w6; w8 := w4 * w7; w1 := W.1^-2; w35 := w8 * w1; w14 := 
    w8^3; w10 := w2 * w8; w11 := w2 * w1; w12 := w5 * w11; w13 := w10 * 
    w12; w9 := w8^-1; w15 := w13 * w9; w16 := w14 * w15; w19 := w13^2; w17 
    := w16 * w13; w18 := w17^2; w20 := w13^-2; w21 := w18 * w20; w22 := w19
    * w21; w36 := w22 * w8; w37 := w16 * w36; w38 := w35 * w37; w25 := 
    w13^-1; w39 := w16^-1; w23 := w16 * w18; w24 := w22^-1; w26 := w24 * 
    w25; w27 := w23 * w26; w40 := w27^-1; w41 := w39 * w40; w42 := w25 * 
    w41; w30 := w22^-2; w32 := w17^-2; w43 := w30 * w32; w44 := w42 * w43; 
    w45 := w38 * w44; w28 := w22 * w27; w29 := w25 * w28; w31 := w25 * w30;
    w33 := w31 * w32; w34 := w29 * w33; w86 := w45 * w34; w87 := w86 * w18;
    w88 := w87 * w22; w89 := w88 * w27; w90 := w89 * w27; w91 := w90 * w13;
    w92 := w91 * w13; w93 := w92 * w13; w94 := w93 * w16; w95 := w94 * w13;
    w96 := w95 * w8; w97 := w96 * w8; w98 := w97 * w8; w99 := w98 * W.1; 
    w100 := w99 * W.2; w101 := w100 * W.2; w102 := w101 * W.1; w103 := w102
    * W.2; w104 := w103 * W.2; w105 := w104 * W.2; return w105;
end function where W is SLPGroup(2), function(W)
    w2 := W.2^-1; w3 := W.1 * W.2; w4 := w2 * w3; w5 := W.1^-1; w6 := w2 * 
    w5; w7 := w5 * w6; w8 := w4 * w7; w1 := W.1^-2; w35 := w8 * w1; w14 := 
    w8^3; w10 := w2 * w8; w11 := w2 * w1; w12 := w5 * w11; w13 := w10 * 
    w12; w9 := w8^-1; w15 := w13 * w9; w16 := w14 * w15; w19 := w13^2; w17 
    := w16 * w13; w18 := w17^2; w20 := w13^-2; w21 := w18 * w20; w22 := w19
    * w21; w36 := w22 * w8; w37 := w16 * w36; w38 := w35 * w37; w25 := 
    w13^-1; w39 := w16^-1; w23 := w16 * w18; w24 := w22^-1; w26 := w24 * 
    w25; w27 := w23 * w26; w40 := w27^-1; w41 := w39 * w40; w42 := w25 * 
    w41; w30 := w22^-2; w32 := w17^-2; w43 := w30 * w32; w44 := w42 * w43; 
    w45 := w38 * w44; return w45;
end function where W is SLPGroup(2) ];

words := [r (W): r in words];

gens := Evaluate (words, A);

words := Evaluate (words, AW);

return gens, words;

end function;

L43AtlasToLGOGens := function (G, A, AW)

W := SLPGroup (2);

words :=
[  function(W)
    w6 := W.2 * W.1; w1 := W.1^-1; w2 := W.2^-1; w7 := w1 * w2; w8 := W.2 * w7; 
    w9 := w6 * w8; w3 := W.2 * w1; w4 := W.1 * w3; w11 := w4^2; w16 := w9 * w11;
    w17 := w9^-2; w18 := w16 * w17; w19 := w4^-3; w20 := w18 * w19; w12 := 
    w4^-2; w13 := w9 * w12; w14 := w11 * w13; w22 := w14^2; w23 := w20 * w22; 
    w24 := w20^-2; w25 := w14^-2; w26 := w24 * w25; w27 := w23 * w26; w43 := 
    w27^2; w35 := W.2^2; w36 := W.1 * w35; w37 := w35 * w36; w38 := W.2^-2; w39 
    := w1 * w38; w40 := w39 * w25; w41 := w37 * w40; w44 := w43 * w41; w46 := 
    w14^3; w47 := w41 * w25; w48 := w46 * w47; w15 := w14^-1; w49 := w24 * w15; 
    w42 := w41^-1; w29 := w14 * w20; w30 := w29 * w22; w21 := w20^-1; w31 := 
    w14^-3; w32 := w21 * w31; w33 := w30 * w32; w34 := w33^-1; w28 := w27^-1; 
    w50 := w34 * w28; w51 := w42 * w50; w52 := w49 * w51; w53 := w48 * w52; w55 
    := w44 * w53; w56 := w55 * w33; w57 := w56 * w33; w58 := w57 * w41; w59 := 
    w58 * w33; w60 := w59 * w14; w61 := w60 * w41; w62 := w61 * w20; w63 := w62 
    * w4; w64 := w63 * w9; w65 := w64 * w4; w66 := w65 * w4; w67 := w66 * W.2; 
    w68 := w67 * W.2; return w68;
end function where W is SLPGroup(2), function(W)
    w6 := W.2 * W.1; w1 := W.1^-1; w2 := W.2^-1; w7 := w1 * w2; w8 := W.2 * w7; 
    w9 := w6 * w8; w3 := W.2 * w1; w4 := W.1 * w3; w11 := w4^2; w16 := w9 * w11;
    w17 := w9^-2; w18 := w16 * w17; w19 := w4^-3; w20 := w18 * w19; w12 := 
    w4^-2; w13 := w9 * w12; w14 := w11 * w13; w22 := w14^2; w23 := w20 * w22; 
    w24 := w20^-2; w25 := w14^-2; w26 := w24 * w25; w27 := w23 * w26; w43 := 
    w27^2; w29 := w14 * w20; w30 := w29 * w22; w21 := w20^-1; w31 := w14^-3; w32
    := w21 * w31; w33 := w30 * w32; w69 := w43 * w33; w35 := W.2^2; w36 := W.1 *
    w35; w37 := w35 * w36; w38 := W.2^-2; w39 := w1 * w38; w40 := w39 * w25; w41
    := w37 * w40; w70 := w69 * w41; w71 := w70 * w20; w72 := w71 * w4; w73 := 
    w72 * w4; w74 := w73 * w4; w75 := w74 * w9; w76 := w75 * w2; w77 := w76 * 
    W.1; w78 := w77 * w2; w79 := w78 * W.1; w80 := w79 * w2; w81 := w80 * W.1; 
    return w81;
end function where W is SLPGroup(2), function(W)
    w1 := W.1^-1; w3 := W.2 * w1; w4 := W.1 * w3; w11 := w4^2; w6 := W.2 * W.1; 
    w2 := W.2^-1; w7 := w1 * w2; w8 := W.2 * w7; w9 := w6 * w8; w12 := w4^-2; 
    w13 := w9 * w12; w14 := w11 * w13; w46 := w14^3; w35 := W.2^2; w36 := W.1 * 
    w35; w37 := w35 * w36; w38 := W.2^-2; w39 := w1 * w38; w25 := w14^-2; w40 :=
    w39 * w25; w41 := w37 * w40; w47 := w41 * w25; w48 := w46 * w47; w16 := w9 *
    w11; w17 := w9^-2; w18 := w16 * w17; w19 := w4^-3; w20 := w18 * w19; w24 := 
    w20^-2; w15 := w14^-1; w49 := w24 * w15; w42 := w41^-1; w29 := w14 * w20; 
    w22 := w14^2; w30 := w29 * w22; w21 := w20^-1; w31 := w14^-3; w32 := w21 * 
    w31; w33 := w30 * w32; w34 := w33^-1; w23 := w20 * w22; w26 := w24 * w25; 
    w27 := w23 * w26; w28 := w27^-1; w50 := w34 * w28; w51 := w42 * w50; w52 := 
    w49 * w51; w53 := w48 * w52; w82 := w53 * w27; w83 := w82 * w14; w84 := w83 
    * w20; w85 := w84 * w14; w86 := w85 * w41; w87 := w86 * w41; w88 := w87 * 
    w4; w89 := w88 * w4; w90 := w89 * w4; w91 := w90 * w9; w92 := w91 * w9; w93 
    := w92 * w2; w94 := w93 * W.1; w95 := w94 * W.2; w96 := w95 * W.2; w97 := 
    w96 * W.1; w98 := w97 * w2; w99 := w98 * W.1; return w99;
end function where W is SLPGroup(2), function(W)
    w6 := W.2 * W.1; w1 := W.1^-1; w2 := W.2^-1; w7 := w1 * w2; w8 := W.2 * w7; 
    w9 := w6 * w8; w3 := W.2 * w1; w4 := W.1 * w3; w11 := w4^2; w16 := w9 * w11;
    w17 := w9^-2; w18 := w16 * w17; w19 := w4^-3; w20 := w18 * w19; w12 := 
    w4^-2; w13 := w9 * w12; w14 := w11 * w13; w22 := w14^2; w23 := w20 * w22; 
    w24 := w20^-2; w25 := w14^-2; w26 := w24 * w25; w27 := w23 * w26; w35 := 
    W.2^2; w36 := W.1 * w35; w37 := w35 * w36; w38 := W.2^-2; w39 := w1 * w38; 
    w40 := w39 * w25; w41 := w37 * w40; w100 := w27 * w41; w101 := w100 * w41; 
    w102 := w101 * w14; w103 := w102 * w14; w104 := w103 * w14; w105 := w104 * 
    w20; w106 := w105 * w20; w107 := w106 * w14; w108 := w107 * w9; w109 := w108
    * w4; w110 := w109 * w2; w111 := w110 * W.1; w112 := w111 * W.2; w113 := 
    w112 * W.2; return w113;
end function where W is SLPGroup(2) ];

words := [r (W): r in words];

gens := Evaluate (words, A);
words := Evaluate (words, AW);

return gens, words;
end function;

