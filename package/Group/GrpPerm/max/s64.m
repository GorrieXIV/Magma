freeze;
import "sympreds.m": PointStabSp, IsotropicStabSp, SymplecticStab;
import "sympimprims.m": GetWreathProd;
import "superfield.m": GammaSp;
import "subfield.m": SubfieldSp;
 

/*
Code to identify and get maximal subgroups of almost simple groups with
socle S(6,4)
*/

AutS64 := function()
return
PermutationGroup<1365|
\[1,8,9,4,10,11,12,2,3,5,6,7,43,44,45,46,47,48,49,50,
51,52,23,53,54,55,27,56,57,58,59,60,33,61,35,62,37,63,64,
65,41,42,13,14,15,16,17,18,19,20,21,22,24,25,26,28,29,30,
31,32,34,36,38,39,40,190,191,192,193,194,195,196,73,197,
198,76,199,200,201,202,203,204,205,206,207,208,87,209,210,
211,212,92,213,214,215,216,217,151,218,219,101,102,220,221,
222,223,224,108,109,225,226,227,228,229,148,230,231,232,233,
234,235,122,188,236,125,237,127,128,129,238,239,132,240,241,
242,243,137,244,245,140,246,142,247,144,248,146,147,115,249,
250,98,152,251,252,253,254,255,256,257,160,161,258,259,260,
261,262,263,264,265,170,171,266,267,268,175,269,177,178,179,
270,271,272,273,184,274,186,275,123,276,66,67,68,69,70,71,
72,74,75,77,78,79,80,81,82,83,84,85,86,88,89,90,91,93,94,
95,96,97,99,100,103,104,105,106,107,110,111,112,113,114,116,
117,118,119,120,121,124,126,130,131,133,134,135,136,138,139,
141,143,145,149,150,153,154,155,156,157,158,159,162,163,164,
165,166,167,168,169,172,173,174,176,180,181,182,183,185,187,
189,722,723,279,724,593,725,283,726,727,728,729,609,349,730,
731,292,293,295,294,732,733,734,429,735,675,302,303,581,736,
737,486,738,739,740,741,742,368,743,509,322,744,745,319,746,
367,316,747,748,749,750,327,328,330,329,685,588,751,334,752,
753,754,755,339,756,757,758,759,655,760,346,761,348,289,762,
351,352,353,488,355,763,764,358,661,658,765,766,628,767,365,
768,321,313,769,370,371,770,373,771,507,376,772,773,774,380,
775,382,383,622,776,777,391,601,389,647,387,392,778,779,780,
781,397,782,467,783,784,405,403,404,402,516,785,408,409,786,
787,788,413,789,790,791,562,792,419,420,793,422,794,424,425,
426,427,428,299,795,796,797,798,799,544,800,801,802,444,440,
441,803,490,439,612,446,804,805,806,807,808,809,453,651,455,
810,457,580,459,811,495,812,813,640,642,466,399,814,469,648,
471,472,815,816,817,818,477,819,820,821,481,482,590,822,485,
307,823,354,824,443,602,492,493,585,461,496,825,826,694,827,
828,653,829,504,505,830,375,508,315,831,624,832,833,834,835,
406,836,837,838,520,839,840,535,524,525,841,527,721,529,842,
843,844,546,845,523,667,846,538,847,540,599,542,543,435,848,
533,849,548,549,850,551,552,553,851,555,556,852,558,697,669,
561,417,853,854,565,855,856,857,858,859,860,861,573,862,575,
863,656,578,864,458,304,582,690,865,494,866,867,332,713,483,
715,592,281,868,869,870,871,872,541,873,388,491,874,875,876,
877,607,608,288,878,611,445,879,880,881,882,883,884,699,666,
885,384,886,511,887,626,627,363,629,888,889,890,691,634,891,
892,893,638,639,464,641,465,894,895,896,897,390,470,649,898,
454,899,502,900,344,577,657,360,659,901,359,902,903,664,665,
620,536,668,560,904,905,906,673,907,301,676,677,678,679,908,
909,682,910,911,331,686,912,913,914,583,633,915,693,499,916,
696,559,698,619,700,917,918,919,920,705,921,922,708,923,710,
924,712,589,714,591,925,926,718,927,928,528,277,278,280,282,
284,285,286,287,290,291,296,297,298,300,305,306,308,309,310,
311,312,314,317,318,320,323,324,325,326,333,335,336,337,338,
340,341,342,343,345,347,350,356,357,361,362,364,366,369,372,
374,377,378,379,381,385,386,393,394,395,396,398,400,401,407,
410,411,412,414,415,416,418,421,423,430,431,432,433,434,436,
437,438,442,447,448,449,450,451,452,456,460,462,463,468,473,
474,475,476,478,479,480,484,487,489,497,498,500,501,503,506,
510,512,513,514,515,517,518,519,521,522,526,530,531,532,534,
537,539,545,547,550,554,557,563,564,566,567,568,569,570,571,
572,574,576,579,584,586,587,594,595,596,597,598,600,603,604,
605,606,610,613,614,615,616,617,618,621,623,625,630,631,632,
635,636,637,643,644,645,646,650,652,654,660,662,663,670,671,
672,674,680,681,683,684,687,688,689,692,695,701,702,703,704,
706,707,709,711,716,717,719,720,979,1159,1245,954,933,934,
1254,1324,1044,1220,1325,1326,1218,1030,945,944,943,1301,947,
1135,1038,950,951,952,957,932,955,959,953,958,956,1136,1211,
962,1327,964,1222,1009,967,1248,1170,1025,996,1226,973,974,
975,1067,1083,978,929,1328,1153,982,1202,984,985,1173,1207,
988,1091,1312,991,992,1050,1329,1280,971,1189,998,1274,1194,
1001,1002,1118,1004,1330,1268,1192,1177,966,1010,1037,1012,
1306,1014,1015,1016,1020,1018,1019,1017,1021,1293,1331,1024,
970,1221,1072,1028,1029,942,1031,1228,1139,1034,1277,1036,1011,
949,1039,1040,1041,1082,1043,937,1263,1137,1047,1048,1140,993,
1199,1130,1053,1054,1055,1056,1332,1058,1156,1060,1061,1062,
1122,1064,1229,1066,976,1204,1069,1102,1167,1027,1073,1107,
1075,1092,1077,1078,1079,1080,1081,1042,977,1084,1094,1086,
1087,1279,1089,1320,989,1076,1213,1085,1095,1264,1097,1098,
1241,1100,1261,1070,1315,1187,1131,1106,1074,1269,1243,1110,
1313,1112,1217,1114,1304,1116,1333,1003,1319,1257,1296,1063,
1123,1203,1267,1334,1127,1128,1129,1052,1105,1132,1133,1134,
948,960,1046,1138,1033,1049,1141,1142,1309,1144,1335,1317,1147,
1148,1149,1150,1151,1152,981,1305,1155,1059,1276,1336,930,1160,
1161,1316,1240,1164,1165,1166,1071,1168,1169,969,1215,1242,986,
1174,1216,1302,1008,1178,1179,1180,1181,1182,1337,1246,1185,
1186,1104,1188,997,1190,1191,1007,1193,1000,1195,1235,1338,
1198,1051,1271,1201,983,1124,1068,1205,1339,987,1208,1209,1270,
961,1340,1093,1214,1171,1175,1113,941,1219,938,1026,965,1223,
1224,1225,972,1236,1032,1065,1230,1231,1341,1233,1295,1196,
1227,1237,1238,1239,1163,1099,1172,1109,1244,931,1184,1342,968,
1343,1250,1251,1252,1253,935,1255,1256,1120,1258,1259,1260,
1101,1262,1045,1096,1344,1266,1125,1006,1108,1210,1200,1272,
1273,999,1275,1157,1035,1278,1088,995,1281,1282,1283,1284,1285,
1286,1287,1288,1345,1290,1291,1292,1022,1346,1234,1121,1297,
1307,1299,1300,946,1176,1303,1115,1154,1013,1298,1308,1143,
1310,1318,990,1111,1314,1103,1162,1146,1311,1119,1090,1321,
1322,1323,936,939,940,963,980,994,1005,1023,1057,1117,1126,
1145,1158,1183,1197,1206,1212,1232,1247,1249,1265,1289,1294,
1347,1348,1364,1350,1351,1352,1362,1365,1355,1356,1357,1358,
1359,1360,1361,1353,1363,1349,1354],
\[2,3,4,5,6,7,1,13,14,15,16,17,18,19,20,21,22,23,24,25,
26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,8,9,
10,11,12,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,
82,83,84,85,86,87,88,89,90,91,92,93,47,94,95,96,97,98,99,
100,101,102,103,104,62,105,106,107,108,109,110,111,112,113,
114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,
129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,
144,145,146,147,148,149,150,151,152,153,154,155,48,156,157,
158,159,160,161,162,163,164,165,166,167,60,168,169,170,171,
172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,
187,188,189,43,44,45,46,49,50,51,52,53,54,55,56,57,58,59,
61,63,64,65,277,278,279,280,281,282,283,284,285,286,287,288,
289,290,291,292,293,294,260,295,296,297,298,299,300,301,302,
303,304,305,306,307,308,309,310,311,312,313,314,315,199,316,
317,318,319,320,321,322,323,324,325,326,327,328,329,258,330,
331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,
346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,
361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,
376,377,378,379,380,212,381,382,383,384,385,386,387,388,389,
390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,
405,406,202,407,408,409,410,411,412,413,414,415,206,416,417,
418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,
433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,
448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,
463,464,465,263,466,467,468,469,470,471,472,473,474,475,476,
273,477,478,479,480,481,482,483,484,485,486,487,488,489,490,
491,492,493,276,494,495,496,497,498,499,500,501,253,502,503,
504,505,506,198,507,508,509,510,511,512,513,514,515,516,517,
518,519,520,521,522,523,524,525,265,526,527,528,529,530,531,
532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,
547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,
562,563,564,565,566,567,568,569,570,259,571,572,573,574,575,
576,577,578,216,579,580,581,582,583,584,585,586,228,587,588,
249,589,590,591,592,593,594,595,596,597,598,599,239,600,601,
602,250,603,604,605,211,606,607,608,609,610,611,612,613,614,
615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,
630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,
645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,
660,661,662,663,664,230,665,666,667,668,669,670,671,672,673,
674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,
689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,
704,705,706,707,708,709,245,208,710,711,712,713,714,715,716,
717,718,719,720,721,190,191,192,193,194,195,196,197,200,201,
203,204,205,207,209,210,213,214,215,217,218,219,220,221,222,
223,224,225,226,227,229,231,232,233,234,235,236,237,238,240,
241,242,243,244,246,247,248,251,252,254,255,256,257,261,262,
264,266,267,268,269,270,271,272,274,275,929,930,931,932,933,
934,935,888,898,936,937,921,938,727,939,735,776,940,941,835,
872,942,943,944,945,946,947,948,949,950,782,951,952,953,798,
954,955,793,853,956,957,958,959,960,961,962,963,964,965,966,
967,858,968,881,969,970,971,972,973,756,737,829,928,825,844,
974,975,976,977,978,979,830,980,981,982,983,984,985,986,987,
827,988,989,887,788,990,822,920,819,991,992,993,729,994,995,
845,763,996,760,997,998,999,870,1000,1001,1002,1003,1004,1005,
1006,1007,1008,863,1009,837,1010,839,1011,1012,809,1013,1014,
826,1015,1016,1017,1018,1019,1020,1021,1022,1023,1024,734,1025,
1026,862,728,1027,923,1028,757,808,1029,1030,1031,786,1032,
1033,1034,1035,1036,869,755,1037,747,922,1038,910,753,1039,
1040,1041,1042,1043,1044,1045,866,770,790,739,1046,1047,1048,
1049,1050,1051,883,1052,1053,901,1054,823,1055,1056,1057,1058,
1059,1060,1061,1062,917,1063,1064,748,1065,745,1066,1067,1068,
874,1069,1070,1071,1072,1073,1074,784,1075,820,1076,924,1077,
1078,1079,1080,1081,1082,1083,746,842,1084,764,889,1085,1086,
897,1087,1088,736,732,1089,1090,1091,1092,1093,1094,1095,873,
1096,1097,1098,1099,831,1100,841,1101,1102,1103,894,813,893,
1104,789,1105,1106,1107,907,777,1108,812,1109,762,909,1110,
1111,1112,1113,840,913,1114,1115,1116,1117,1118,1119,895,1120,
1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1132,
1133,871,875,915,759,1134,754,1135,1136,1137,1138,1139,912,
1140,1141,799,1142,1143,740,1144,1145,1146,1147,1148,884,824,
903,1149,1150,1151,1152,1153,1154,758,1155,847,1156,1157,1158,
892,1159,1160,821,1161,1162,1163,1164,1165,1166,1167,900,1168,
1169,1170,1171,1172,1173,1174,1175,792,742,725,1176,1177,1178,
752,1179,1180,848,787,775,730,1181,865,804,723,904,1182,1183,
814,1184,781,1185,1186,1187,803,744,1188,733,882,1189,1190,
855,1191,1192,800,1193,1194,1195,1196,1197,916,1198,1199,1200,
1201,885,879,751,1202,1203,1204,1205,1206,846,1207,828,1208,
1209,1210,1211,1212,778,1213,1214,896,919,724,1215,1216,1217,
877,816,1218,1219,743,1220,1221,906,765,810,1222,1223,1224,
864,1225,1226,854,1227,1228,899,925,1229,860,1230,797,1231,
1232,1233,1234,772,771,1235,1236,1237,750,1238,1239,1240,768,
843,1241,1242,1243,918,1244,1245,1246,1247,806,1248,1249,911,
791,1250,767,1251,1252,1253,867,1254,868,1255,832,1256,890,
1257,1258,1259,1260,1261,1262,1263,1264,1265,1266,878,876,926,
774,1267,1268,1269,851,1270,1271,1272,1273,1274,1275,817,811,
852,1276,1277,722,927,1278,1279,834,1280,1281,1282,1283,1284,
794,1285,1286,1287,796,779,1288,1289,1290,1291,1292,1293,1294,
1295,807,1296,1297,1298,1299,773,1300,1301,780,749,1302,1303,
1304,1305,1306,1307,726,859,1308,1309,818,1310,1311,738,891,
1312,1313,1314,785,802,783,1315,741,836,838,1316,1317,1318,
1319,1320,805,902,1321,1322,880,1323,861,731,761,766,769,795,
801,815,833,849,850,856,857,886,905,908,914,1333,1347,1348,
1328,1329,1349,1345,1342,1326,1336,1346,1350,1351,1339,1352,
1327,1353,1338,1340,1337,1354,1355,1335,1356,1357,1343,1325,
1330,1331,1341,1358,1324,1334,1359,1360,1361,1362,1363,1364,
1332,1365,1344],
\[1,327,734,617,940,934,1314,740,1154,245,541,1096,504,963,
620,450,1346,1335,419,151,923,995,1284,1022,1192,871,1308,365,
639,1034,917,412,1044,976,498,93,924,299,272,686,41,1301,507,
931,846,1226,198,1019,777,1225,51,1166,707,625,55,1135,136,
155,944,217,420,1261,828,920,107,434,1008,399,439,1287,812,
782,183,340,291,1324,78,77,1362,1303,825,1315,1300,1276,239,
1004,1186,1033,418,460,555,92,36,623,880,1251,164,279,169,
666,989,1028,684,187,443,207,65,576,336,378,163,1263,771,232,
1177,358,1197,1127,878,922,1269,746,165,247,224,1117,127,745,
671,289,193,1107,442,725,648,57,137,319,139,901,946,295,346,
1136,145,784,1355,321,1185,1176,20,751,679,672,58,1211,157,
335,249,647,1109,1115,111,97,123,344,196,848,99,267,941,455,
173,1168,409,798,1039,1049,999,1184,294,843,73,1193,393,913,
104,373,1318,831,643,350,131,202,786,167,965,47,1094,296,
1012,194,558,1063,205,478,106,816,209,613,943,584,1167,1222,
506,685,60,854,523,1149,221,1204,640,125,817,561,357,1248,
424,805,1141,114,1297,494,1183,1002,304,833,85,1334,1058,1207,
638,692,10,1098,124,575,159,531,650,646,1061,254,928,493,
1084,977,1292,1246,712,416,1333,315,764,566,170,1313,1122,788,
1266,39,432,1048,567,1132,850,867,98,1099,429,958,305,589,
990,423,287,731,130,1164,75,915,1323,181,142,200,465,411,38,
885,301,326,912,237,283,1237,781,422,1046,1350,753,972,919,
473,264,1103,1252,1270,138,320,148,433,1352,1150,884,302,2,
809,1095,863,1190,1281,1202,360,158,109,586,945,388,74,372,
1053,1223,166,1279,143,1244,991,1343,192,351,714,489,1341,749,
1014,227,116,1071,334,361,1239,874,633,28,1113,1124,1021,1294,
1110,1265,341,188,1090,525,951,1016,110,841,1228,1356,1250,
876,1035,729,389,537,339,386,775,535,1342,185,914,569,1182,
983,581,68,1361,401,883,472,484,1029,593,501,866,175,882,298,
32,795,742,415,262,1101,89,19,61,903,308,286,229,1296,689,
1220,872,281,1030,431,273,322,66,840,1200,992,511,69,966,441,
133,105,464,978,1298,1359,1112,690,16,1360,736,1059,540,172,
839,457,669,1079,90,480,577,1242,444,297,503,528,700,1206,
930,1348,403,314,1321,475,592,1105,206,1128,461,701,594,877,
404,544,1357,651,1051,353,1337,1072,855,256,234,724,800,556,
35,1134,847,407,612,466,13,875,215,43,860,654,813,438,1116,
1162,791,808,785,656,927,1018,522,755,520,219,827,375,732,
1289,467,956,799,250,1081,1249,959,391,720,387,911,1233,454,
11,1271,599,485,733,1316,1001,796,752,760,1229,1003,981,962,
91,497,624,203,1262,935,226,661,1299,1045,1309,266,275,887,
395,1363,1365,1023,1219,604,248,108,462,1353,706,891,398,797,
982,212,1173,337,1254,938,284,1320,832,476,406,482,971,1006,
1332,838,543,738,1274,1060,1241,574,1319,968,607,778,769,1291,
806,502,210,929,1097,836,4,1089,1224,15,621,622,94,557,54,
1024,869,821,942,711,1231,632,364,1268,723,744,660,243,29,
223,950,900,191,937,824,252,160,135,996,251,487,1189,1214,
509,925,517,898,1257,1329,637,562,1234,710,664,1073,100,667,
845,458,670,129,154,717,1151,1129,1328,952,1278,153,994,1259,
823,961,103,216,40,1140,1076,426,449,1304,244,1338,1345,695,
719,936,957,763,468,481,1230,1078,1302,1351,579,53,1111,790,
663,630,261,987,352,1054,1170,673,970,696,536,864,1102,635,
495,134,1159,1305,1144,385,730,288,526,545,3,890,452,881,600,
830,8,1133,414,1235,636,128,122,804,853,355,907,152,549,311,
1066,521,1020,1174,918,759,550,1025,921,699,265,1277,1194,
1175,802,609,1169,113,1243,773,1085,390,904,49,608,1010,1007,
307,72,820,146,516,195,1312,270,1125,709,514,1232,1142,998,
413,548,582,176,530,496,1153,768,803,747,230,611,1267,515,
328,811,810,71,510,1143,815,208,225,1213,819,783,628,822,682,
645,81,1340,524,63,1009,739,190,591,238,969,1041,616,1165,
598,456,435,379,1172,182,849,668,45,500,168,844,277,932,1013,
748,218,492,856,858,857,993,508,988,1260,330,721,1155,408,
278,1218,627,975,26,428,1273,363,505,383,483,119,1199,95,737,
410,402,325,300,1017,568,1106,1307,735,580,1055,964,1203,1161,
1077,897,657,1069,642,140,1205,421,776,1082,906,750,1181,1037,
910,538,303,186,394,292,1138,31,758,313,64,762,120,21,37,
655,1187,518,255,614,470,44,851,1215,6,560,697,644,588,980,
5,171,629,211,59,338,141,1092,1087,949,641,376,677,1118,1056,
1119,529,698,282,534,1171,683,554,14,893,197,440,1042,606,
834,718,595,312,1086,1011,870,34,258,445,1137,939,553,583,
397,1000,1264,1293,713,861,101,285,348,437,859,680,22,649,
1114,794,179,984,547,236,552,86,1158,596,780,67,829,779,974,
201,852,356,1050,377,886,519,48,756,368,24,572,626,761,1026,
1282,102,405,430,1255,1065,88,30,384,1258,909,1208,177,1227,
835,967,1212,33,564,309,1047,274,178,1015,488,1336,342,715,
892,954,1057,241,453,602,253,1325,204,1064,1032,754,1347,1108,
899,1364,359,491,665,1131,1178,688,896,703,459,1160,532,905,
1216,257,774,973,948,1349,618,374,1091,947,1286,199,329,12,
615,246,280,1238,417,722,316,1288,477,888,132,1068,161,370,
708,448,366,997,162,512,126,953,955,1310,1317,269,1209,367,
789,1126,118,479,675,1327,1074,276,741,499,56,144,979,916,
1240,687,231,793,814,728,1191,1358,1148,1147,220,324,674,1354,
801,9,865,1156,1157,1005,726,1080,895,513,1163,290,837,52,
213,174,770,716,960,842,585,757,767,150,115,1075,1285,1210,
908,396,235,180,149,87,926,1322,652,331,1145,25,184,766,1331,
1196,117,1198,879,436,1311,333,894,222,902,469,242,1038,1123,
1180,156,1043,818,653,933,1083,1306,868,573,427,1221,214,343,
619,50,46,1040,380,551,702,631,792,539,662,743,1236,306,1100,
362,1139,603,463,772,347,1330,260,1247,228,533,382,96,317,
1253,587,1031,1290,658,1036,681,862,62,559,112,985,371,271,
807,634,121,318,542,1295,873,601,1275,84,765,678,345,1283,
332,1027,1280,23,1179,1093,70,1104,527,1256,610,259,986,369,
1272,425,233,446,563,83,42,704,80,691,727,1217,889,27,565,
1120,1201,787,268,7,82,546,1121,189,605,590,474,1188,293,76,
1062,1326,1130,676,659,1245,1195,597,263,240,18,1052,490,693,
1344,826,354,392,349,1339,694,17,1067,471,1088,310,705,323,
578,1152,147,381,486,1146,447,451,400,79,570,1070,571]: Order:=8212119552000>;
end function;

G24 := function()
return
MatrixGroup<6, GF(2, 2) |
DiagonalMatrix(GF(2,2),[W,W^2,W^2,W,W,W^2]) where W:=GF(2,2).1,
Matrix(GF(2,2),6,6,[1,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,
0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0] where W:=GF(2,2).1)
/*order=251596800=2^12*3^3*5^2*7*13*/>;
end function;

S64Identify := function(group:max:=true,Print:=0)
  A := AutS64();
  ims := [A.1, A.2];
  S := sub< A | ims >;
  F, phi := FPGroupStrong(S);

  soc := Socle(group);
  aut := Index(group, soc);
  if Print gt 1 then printf "group is S(6,4):[%o]\n", aut; end if;

  iss, gens := StandardGenerators(soc, "S64");
  if not iss then error "Standard generator error in S(6,4)"; end if;
  a:=gens[1]; b:=gens[2];
  soc := sub< soc | a,b >;
  newgens := [ group | a,b ];
  for g in Generators(group) do
     if not g in sub<group|newgens> then Append(~newgens,g); end if;
  end for;
  group := sub<group|newgens>;

  //we need to find images of generators in standard copy
  homom :=  hom< soc -> A | ims >;
  for i in [3..Ngens(group)] do
    g := group.i;
    conjim := homom(soc.1^g);
    isc, h := IsConjugate(A,A.1,conjim);
    if not isc then error "Conjugation error in Aut(S(6,4))"; end if;
    CG := Centraliser(A,conjim);
    ce := h;
    isc, h := IsConjugate(CG,A.2^ce,homom(soc.2^g));
    if not isc then error "Conjugation error in Aut(S(6,4))"; end if;
    ce := ce*h;
    Append(~ims,ce);
  end for;
  homom :=  hom< group -> A | ims >;
  imhom := Image(homom);

  maximals:= [];
  if not max then 
    return homom, A, maximals, F, phi;
  end if;
    
  //Now for the maximals.  We work down the table in the book
  //These are subgroups of Sp(6,4), so we need a homomorphism
  iss, gens := StandardGenerators(Sp(6,4),"S64":Projective:=true);
  sp := sub< GL(6,4) | gens >;
  sptoA := hom< sp->A | [A.1,A.2] >;

  //C1s
  Append(~maximals, sptoA(PointStabSp(6,4)));
  Append(~maximals, sptoA(IsotropicStabSp(6,4,2)));
  Append(~maximals, sptoA(IsotropicStabSp(6,4,3)));
  Append(~maximals, sptoA(SymplecticStab(6,4,2)));

  //C2s
  Append(~maximals, sptoA(GetWreathProd(6,4,3)));
  
  //C3s
  Append(~maximals, sptoA(GammaSp(6,4,3)));

  //C5
  Append(~maximals, sptoA(SubfieldSp(6,2,2,1))); 

  //C8
  Append(~maximals, sptoA(SOPlus(6,4)));
  isit, form := SymplecticForm(SOMinus(6,4));
  assert isit;
  trans := GL(6,4)!CorrectForm(form,6,4,"symplectic");
  Append(~maximals, sptoA(SOMinus(6,4)^trans));

  //C9
  Append(~maximals, sptoA(G24()));

  return homom, A, maximals, F, phi;
end function;
