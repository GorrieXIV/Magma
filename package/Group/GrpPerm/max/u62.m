freeze;
 
/*
Code for maximal subgroups of almost simple groups with socle U(6,2).
Data mostly from Rob Wilson's Birmingham Atlas.
*/

get_standard_gens_u62 := function(G)
    /* G is a group iso to U(6,2) */
    /* standard gens as defined in B'ham Atlas */
    /* algorithm by Bill Unger, 4/12/2003 */

    P := RandomProcess(G);
    repeat x := Random(P); ord := Order(x); until ord in {10, 18}; // 19 in 90
    a := x^(ord div 2); // a is now in 2A

    repeat y := Random(P); until Order(y) eq 7; // 1 in 42

    /* get a good b */
    repeat
	b := y^Random(P);
	ab := a*b;
    until Order(ab) eq 11 and Order(ab*b) eq 18; // 2 in 33
    return a, b;

end function;

U62Identify := function(group:max:=true,Print:=0)
S := Sym(693);
a :=  S!
\[1, 2, 3, 4, 5, 6, 7, 192, 9, 10, 158, 12, 396, 194, 179, 16, 87, 18, 318, 20, 
79, 230, 313, 216, 136, 113, 240, 124, 128, 163, 156, 201, 255, 215, 444, 214, 
141, 204, 48, 329, 86, 341, 76, 294, 310, 211, 59, 39, 149, 241, 135, 104, 130, 
275, 126, 200, 303, 144, 47, 152, 205, 298, 247, 129, 552, 101, 338, 293, 307, 
290, 94, 119, 140, 447, 234, 43, 85, 459, 21, 375, 246, 514, 245, 106, 77, 41, 
17, 112, 239, 339, 403, 236, 98, 71, 210, 302, 356, 93, 273, 213, 66, 244, 408, 
52, 291, 84, 155, 197, 202, 232, 280, 88, 26, 233, 446, 284, 508, 173, 72, 174, 
397, 181, 395, 28, 306, 55, 305, 29, 64, 53, 203, 187, 368, 394, 51, 25, 153, 
198, 309, 73, 37, 191, 485, 58, 344, 184, 157, 621, 49, 507, 343, 60, 137, 225, 
107, 31, 147, 11, 189, 317, 417, 268, 30, 640, 180, 311, 402, 340, 169, 300, 
353, 352, 118, 120, 342, 281, 449, 506, 15, 165, 122, 370, 243, 146, 188, 304, 
132, 185, 159, 223, 142, 8, 622, 14, 248, 443, 108, 138, 265, 56, 32, 109, 131, 
38, 61, 551, 278, 220, 266, 95, 46, 557, 100, 36, 34, 24, 289, 287, 476, 208, 
367, 505, 190, 299, 154, 257, 410, 249, 393, 22, 322, 110, 114, 75, 286, 92, 
323, 285, 89, 27, 50, 550, 183, 102, 83, 81, 63, 195, 228, 541, 429, 486, 267, 
682, 33, 679, 226, 276, 296, 379, 462, 262, 263, 264, 199, 209, 253, 162, 430, 
292, 384, 409, 99, 448, 54, 258, 478, 207, 477, 111, 176, 481, 337, 116, 238, 
235, 218, 385, 217, 70, 105, 270, 68, 44, 649, 259, 617, 62, 224, 170, 502, 96, 
57, 186, 127, 125, 69, 641, 139, 45, 166, 589, 23, 645, 424, 556, 160, 19, 558, 
372, 371, 231, 237, 354, 357, 326, 345, 347, 40, 421, 454, 348, 389, 369, 423, 
646, 283, 67, 90, 168, 42, 175, 151, 145, 327, 411, 328, 332, 383, 543, 437, 
172, 171, 324, 643, 97, 325, 358, 398, 400, 361, 510, 363, 364, 365, 366, 221, 
133, 334, 182, 321, 320, 377, 374, 80, 555, 373, 686, 260, 559, 381, 564, 349, 
271, 288, 594, 387, 416, 333, 537, 496, 392, 229, 134, 123, 13, 121, 359, 683, 
360, 401, 167, 91, 609, 613, 406, 615, 103, 272, 227, 346, 672, 413, 484, 415, 
388, 161, 563, 480, 420, 330, 436, 335, 315, 460, 426, 427, 428, 251, 269, 565, 
499, 566, 434, 453, 422, 351, 438, 532, 591, 441, 644, 196, 35, 445, 115, 74, 
274, 177, 521, 493, 504, 435, 331, 494, 456, 539, 458, 78, 425, 461, 261, 463, 
464, 465, 466, 467, 468, 525, 470, 471, 472, 473, 474, 475, 219, 279, 277, 479, 
419, 282, 482, 483, 414, 143, 252, 487, 651, 489, 685, 491, 560, 451, 455, 495, 
391, 497, 498, 432, 596, 501, 301, 503, 452, 222, 178, 150, 117, 509, 362, 511, 
512, 513, 82, 662, 516, 517, 592, 519, 520, 450, 587, 523, 524, 469, 526, 527, 
608, 529, 530, 542, 439, 533, 534, 535, 536, 390, 538, 457, 540, 250, 531, 350, 
544, 545, 546, 547, 570, 549, 242, 206, 65, 553, 554, 376, 316, 212, 319, 380, 
492, 602, 562, 418, 382, 431, 433, 567, 568, 569, 548, 571, 572, 573, 574, 575, 
576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 522, 588, 312, 590, 440, 
518, 593, 386, 595, 500, 663, 598, 647, 600, 673, 561, 603, 604, 605, 606, 607, 
528, 404, 610, 611, 631, 405, 614, 407, 616, 297, 618, 619, 620, 148, 193, 623, 
659, 625, 626, 627, 628, 629, 630, 612, 632, 633, 634, 635, 636, 637, 638, 639, 
164, 308, 642, 355, 442, 314, 336, 599, 648, 295, 650, 488, 652, 653, 654, 655, 
656, 657, 658, 624, 660, 661, 515, 597, 664, 665, 666, 667, 668, 669, 670, 671, 
412, 601, 674, 675, 676, 677, 678, 256, 680, 681, 254, 399, 684, 490, 378, 687, 
688, 689, 690, 691, 692, 693 ];

b := S!
\[ 513, 76, 504, 66, 133, 381, 617, 205, 292, 681, 226, 353, 427, 367, 91, 541, 
82, 497, 523, 306, 6, 483, 87, 27, 692, 530, 489, 123, 485, 441, 115, 597, 552, 
73, 178, 484, 294, 600, 167, 357, 590, 12, 258, 88, 580, 325, 589, 351, 560, 
195, 318, 494, 326, 618, 347, 229, 576, 606, 490, 443, 599, 324, 554, 517, 550, 
219, 684, 78, 577, 421, 86, 506, 311, 8, 200, 42, 255, 575, 501, 574, 15, 85, 
663, 342, 26, 20, 555, 442, 143, 548, 333, 365, 52, 132, 647, 393, 152, 339, 
406, 246, 51, 134, 646, 451, 354, 131, 469, 535, 420, 69, 276, 460, 687, 2, 542,
32, 285, 512, 121, 309, 609, 549, 543, 344, 236, 330, 612, 38, 671, 474, 641, 
293, 60, 493, 94, 547, 213, 280, 532, 216, 225, 21, 290, 691, 201, 240, 170, 
586, 74, 128, 675, 679, 30, 677, 686, 384, 273, 391, 114, 386, 120, 177, 503, 
588, 215, 620, 519, 644, 477, 278, 58, 561, 605, 127, 267, 284, 302, 659, 182, 
335, 660, 450, 238, 314, 147, 640, 237, 281, 329, 371, 165, 108, 690, 411, 129, 
409, 634, 564, 598, 435, 369, 629, 274, 610, 315, 356, 249, 578, 90, 424, 615, 
414, 117, 672, 432, 645, 16, 408, 98, 471, 67, 151, 97, 3, 639, 317, 233, 33, 
135, 7, 349, 304, 262, 399, 31, 470, 370, 649, 204, 593, 228, 17, 173, 47, 334, 
149, 498, 29, 113, 352, 468, 683, 271, 355, 57, 502, 389, 79, 499, 208, 429, 75,
546, 50, 654, 104, 446, 164, 538, 196, 467, 667, 652, 585, 495, 180, 551, 248, 
242, 341, 253, 37, 563, 231, 172, 260, 83, 362, 374, 328, 431, 256, 486, 251, 
478, 140, 65, 565, 169, 25, 448, 453, 670, 449, 383, 212, 632, 198, 336, 635, 
545, 257, 183, 203, 100, 676, 481, 571, 187, 402, 533, 631, 403, 595, 466, 591, 
14, 521, 407, 310, 392, 221, 272, 157, 287, 643, 360, 626, 422, 425, 633, 116, 
637, 322, 96, 232, 291, 346, 145, 596, 35, 528, 159, 473, 206, 275, 604, 268, 
138, 436, 161, 189, 520, 63, 573, 316, 218, 54, 176, 105, 657, 437, 300, 558, 
387, 154, 99, 656, 350, 508, 522, 479, 395, 536, 500, 19, 464, 516, 518, 139, 
45, 210, 476, 455, 220, 581, 277, 55, 186, 570, 405, 678, 160, 61, 531, 223, 
622, 439, 664, 40, 348, 301, 359, 594, 109, 616, 193, 312, 579, 270, 372, 624, 
338, 163, 49, 457, 191, 89, 363, 688, 378, 611, 379, 537, 665, 566, 343, 264, 
642, 680, 11, 514, 592, 397, 101, 296, 93, 567, 194, 534, 426, 323, 627, 10, 
418, 283, 103, 607, 669, 179, 254, 112, 419, 619, 184, 650, 582, 36, 557, 390, 
434, 509, 319, 358, 28, 192, 150, 148, 84, 263, 153, 413, 655, 282, 185, 56, 
331, 188, 368, 5, 539, 137, 472, 400, 461, 320, 440, 162, 18, 638, 39, 308, 487,
68, 444, 433, 64, 118, 265, 144, 385, 454, 168, 23, 136, 46, 241, 394, 43, 524, 
584, 166, 452, 458, 92, 211, 297, 252, 125, 279, 332, 529, 505, 462, 345, 337, 
305, 662, 245, 465, 295, 110, 510, 553, 80, 601, 239, 608, 289, 243, 321, 507, 
171, 456, 44, 625, 412, 41, 81, 141, 492, 130, 685, 9, 525, 156, 107, 155, 214, 
602, 430, 438, 653, 673, 630, 666, 235, 62, 53, 22, 222, 488, 199, 428, 540, 
217, 24, 562, 496, 122, 693, 59, 410, 71, 286, 689, 382, 234, 313, 299, 423, 
447, 366, 146, 527, 416, 261, 459, 197, 636, 13, 614, 259, 526, 174, 544, 303, 
587, 190, 142, 361, 668, 556, 4, 124, 480, 247, 648, 230, 224, 623, 250, 482, 
181, 106, 515, 651, 417, 340, 583, 126, 327, 621, 376, 175, 266, 77, 396, 404, 
658, 70, 491, 298, 102, 158, 398, 375, 388, 661, 119, 674, 207, 111, 415, 227, 
95, 559, 288, 682, 202, 572, 373, 34, 48, 628, 568, 1, 244, 377, 613, 380, 209, 
307, 401, 364, 603, 269, 445, 72, 511, 475, 569, 463 ];

c := S!
\[ 1, 3, 5, 7, 2, 10, 12, 14, 16, 18, 21, 4, 24, 26, 28, 20, 31, 6, 34, 9, 37, 
40, 42, 44, 47, 8, 50, 52, 53, 55, 39, 58, 60, 62, 65, 68, 11, 70, 17, 73, 76, 
46, 51, 13, 81, 23, 84, 87, 89, 90, 86, 15, 94, 96, 98, 101, 103, 75, 106, 100, 
109, 19, 112, 36, 115, 118, 121, 64, 123, 125, 128, 131, 22, 133, 32, 135, 137, 
139, 141, 143, 145, 148, 151, 25, 153, 43, 156, 159, 92, 27, 57, 49, 163, 29, 
166, 138, 97, 30, 171, 33, 173, 175, 91, 179, 181, 136, 183, 184, 174, 185, 187,
189, 192, 195, 35, 197, 67, 200, 203, 205, 117, 207, 178, 104, 38, 93, 72, 130, 
214, 71, 127, 217, 219, 222, 41, 59, 223, 54, 227, 230, 158, 233, 229, 234, 45, 
116, 83, 150, 239, 82, 147, 213, 190, 155, 243, 48, 245, 79, 247, 249, 251, 253,
126, 256, 258, 260, 259, 226, 169, 265, 266, 268, 56, 61, 220, 271, 206, 69, 
124, 276, 278, 281, 225, 284, 270, 287, 289, 292, 63, 85, 114, 194, 295, 113, 
191, 274, 146, 275, 238, 66, 144, 120, 305, 290, 202, 308, 291, 244, 273, 311, 
313, 314, 255, 293, 298, 294, 280, 320, 74, 102, 134, 221, 77, 165, 107, 325, 
78, 327, 80, 329, 330, 188, 248, 201, 333, 149, 335, 300, 236, 241, 339, 164, 
154, 342, 343, 344, 88, 142, 345, 348, 347, 350, 352, 193, 152, 242, 357, 224, 
360, 95, 324, 364, 263, 264, 285, 99, 172, 267, 252, 110, 370, 373, 353, 376, 
302, 299, 380, 105, 231, 132, 384, 386, 323, 108, 170, 389, 372, 272, 111, 306, 
122, 232, 129, 396, 254, 400, 355, 318, 180, 199, 405, 198, 408, 218, 119, 204, 
395, 177, 410, 246, 379, 331, 341, 316, 414, 212, 228, 215, 411, 304, 282, 421, 
423, 425, 168, 326, 317, 417, 140, 279, 433, 435, 432, 277, 337, 440, 237, 397, 
240, 257, 211, 208, 157, 310, 160, 450, 161, 453, 455, 269, 349, 162, 209, 460, 
399, 356, 340, 465, 424, 167, 262, 469, 471, 361, 474, 475, 394, 476, 478, 176, 
481, 186, 288, 374, 485, 196, 385, 488, 210, 334, 487, 492, 494, 182, 409, 321, 
387, 362, 499, 422, 502, 392, 375, 505, 506, 216, 508, 315, 297, 402, 463, 296, 
303, 515, 496, 516, 419, 403, 377, 459, 521, 522, 381, 398, 415, 510, 429, 528, 
518, 420, 477, 532, 283, 484, 261, 470, 427, 366, 328, 486, 336, 235, 312, 497, 
541, 439, 383, 544, 537, 431, 406, 539, 448, 552, 553, 444, 368, 555, 551, 558, 
561, 564, 250, 566, 351, 569, 570, 572, 309, 462, 358, 354, 513, 524, 461, 575, 
363, 579, 388, 534, 467, 472, 581, 584, 428, 447, 322, 559, 590, 592, 594, 458, 
483, 359, 393, 543, 413, 597, 489, 601, 491, 504, 602, 437, 605, 301, 607, 498, 
286, 609, 611, 613, 616, 382, 367, 307, 514, 338, 445, 525, 511, 574, 401, 621, 
596, 441, 625, 407, 549, 438, 319, 624, 519, 628, 416, 630, 527, 631, 632, 598, 
451, 390, 479, 426, 580, 536, 436, 637, 548, 540, 332, 493, 430, 520, 529, 546, 
547, 442, 523, 640, 641, 446, 509, 466, 443, 557, 645, 346, 369, 452, 531, 562, 
608, 560, 646, 589, 501, 568, 653, 644, 571, 482, 573, 656, 554, 576, 577, 468, 
578, 595, 634, 636, 583, 365, 585, 586, 659, 661, 454, 533, 565, 615, 660, 371, 
535, 404, 378, 638, 490, 600, 599, 542, 495, 670, 603, 538, 434, 612, 662, 503, 
567, 563, 391, 676, 480, 610, 643, 618, 619, 629, 507, 649, 517, 412, 623, 680, 
627, 464, 642, 655, 418, 545, 588, 473, 635, 681, 606, 530, 639, 679, 449, 620, 
683, 457, 556, 591, 685, 674, 682, 650, 663, 652, 456, 687, 526, 512, 657, 658, 
672, 678, 633, 500, 686, 675, 654, 648, 667, 626, 604, 669, 671, 587, 647, 666, 
688, 692, 693, 593, 550, 668, 582, 622, 617, 677, 673, 651, 665, 664, 689, 690, 
691, 614, 684 ];

d := S!
\[1, 567, 611, 675, 501, 678, 664, 398, 553, 660, 444, 688, 389, 414, 357, 445, 
87, 593, 591, 509, 446, 400, 560, 286, 136, 315, 112, 257, 110, 55, 48, 510, 
291, 646, 158, 129, 552, 570, 156, 296, 121, 564, 338, 499, 477, 452, 106, 31, 
91, 63, 508, 340, 270, 197, 30, 200, 92, 416, 84, 207, 205, 565, 50, 214, 141, 
173, 76, 293, 419, 457, 188, 203, 402, 556, 525, 67, 161, 594, 115, 376, 421, 
150, 372, 59, 417, 397, 17, 240, 103, 189, 49, 57, 93, 185, 199, 116, 97, 98, 
191, 122, 118, 102, 89, 168, 255, 47, 602, 275, 120, 29, 380, 27, 424, 266, 79, 
96, 135, 101, 131, 109, 41, 100, 407, 226, 644, 163, 305, 232, 36, 292, 119, 
478, 645, 622, 117, 25, 347, 146, 481, 167, 65, 273, 274, 388, 322, 138, 186, 
148, 403, 82, 287, 278, 328, 531, 561, 39, 304, 35, 339, 249, 77, 685, 126, 423,
272, 300, 140, 104, 576, 311, 195, 601, 66, 202, 220, 515, 436, 518, 325, 409, 
213, 500, 493, 198, 94, 147, 277, 71, 90, 429, 99, 359, 394, 484, 171, 229, 54, 
184, 95, 56, 362, 174, 72, 548, 61, 537, 60, 342, 233, 265, 504, 476, 181, 64, 
336, 235, 369, 343, 557, 175, 649, 682, 251, 373, 542, 124, 371, 317, 196, 360, 
344, 128, 209, 469, 216, 303, 679, 260, 408, 88, 247, 283, 451, 244, 320, 330, 
241, 353, 160, 332, 223, 486, 647, 505, 105, 323, 28, 288, 329, 238, 261, 554, 
546, 600, 210, 114, 599, 490, 543, 53, 404, 165, 142, 143, 108, 385, 187, 152, 
310, 559, 662, 309, 242, 302, 379, 24, 151, 258, 334, 539, 33, 130, 68, 432, 
367, 40, 383, 431, 377, 166, 597, 284, 236, 157, 127, 442, 480, 439, 282, 279, 
170, 433, 492, 368, 26, 447, 228, 440, 659, 245, 410, 145, 256, 425, 179, 489, 
327, 153, 259, 246, 331, 250, 396, 289, 640, 215, 550, 43, 159, 52, 382, 208, 
218, 231, 345, 522, 137, 541, 617, 430, 643, 673, 248, 460, 437, 356, 15, 461, 
192, 230, 466, 201, 381, 575, 680, 516, 295, 314, 217, 596, 227, 83, 224, 618, 
555, 80, 299, 496, 285, 111, 363, 341, 297, 609, 276, 459, 573, 144, 13, 551, 
686, 586, 443, 193, 615, 333, 86, 8, 494, 22, 598, 73, 149, 271, 488, 475, 123, 
239, 180, 321, 587, 450, 471, 14, 415, 58, 85, 418, 69, 671, 81, 449, 164, 113, 
324, 549, 427, 441, 190, 350, 298, 294, 312, 434, 453, 177, 355, 625, 308, 318, 
428, 306, 393, 11, 16, 21, 316, 485, 422, 412, 243, 46, 435, 454, 683, 538, 70, 
634, 386, 354, 358, 462, 530, 603, 465, 361, 487, 578, 234, 519, 413, 639, 482, 
626, 406, 212, 45, 132, 512, 307, 139, 473, 619, 194, 448, 252, 467, 405, 326, 
268, 491, 313, 183, 399, 628, 378, 607, 690, 44, 182, 5, 663, 616, 211, 254, 
592, 514, 51, 20, 32, 627, 479, 638, 507, 176, 366, 544, 178, 470, 623, 672, 
346, 534, 605, 75, 588, 657, 631, 614, 463, 154, 641, 574, 523, 595, 536, 206, 
456, 290, 547, 348, 225, 269, 517, 676, 263, 540, 204, 426, 337, 390, 37, 9, 
262, 375, 74, 219, 624, 280, 23, 155, 667, 563, 42, 62, 589, 2, 568, 606, 38, 
585, 581, 387, 533, 364, 169, 658, 468, 579, 580, 572, 642, 691, 668, 571, 392, 
411, 526, 566, 656, 19, 506, 18, 78, 535, 370, 301, 401, 267, 264, 172, 107, 
464, 677, 524, 569, 497, 612, 384, 610, 3, 608, 651, 529, 395, 503, 349, 374, 
483, 681, 621, 134, 520, 558, 438, 474, 511, 495, 636, 633, 528, 692, 630, 458, 
650, 629, 653, 513, 472, 335, 532, 582, 351, 125, 133, 34, 253, 674, 221, 635, 
613, 652, 637, 687, 661, 590, 527, 577, 319, 10, 655, 281, 502, 7, 665, 666, 
562, 584, 693, 684, 420, 521, 352, 648, 4, 545, 604, 6, 237, 365, 620, 222, 455,
670, 162, 391, 654, 12, 689, 498, 583, 632, 669 ];

/*
    a,b are standard generators of U(6,2). 
    c,d are outer auts of order 3,2 resp., such that d inverts c.
*/


/***************************************************************************/

  if Print gt 1 then print "Setting up standard group"; end if;
  usimp := sub<S|a,b>;
  usimp`Order := 9196830720;
  F := Group<a,b|a^2, b^7, (a*b)^11,(a,b)^2, (a,b^2)^3,(a,b^3)^3, 
    (a*b^3)^11, (a*b*a*b^2*a*b^3*a*b^-3)^7>;
  phi := hom<F->usimp|a,b>;
  soc := Socle(group);
  aut := Index(group, soc);
  if Print gt 1 then printf "group is U(6,2):[%o]\n", aut; end if;
  if Print gt 1 then print "Getting embedding"; end if;
  ga, gb:= get_standard_gens_u62(soc);
  soc := sub< soc | ga,gb >;
  soc`Order := 9196830720;
  newgens := [ group | ga, gb];
  for g in Generators(group) do
     if not g in sub<group|newgens> then Append(~newgens,g); end if;
  end for;
  group := sub<group|newgens>;
  au62 := sub< S | a, b, c, d>;
  ims := [ au62 | a, b];
  homom :=  hom< soc -> usimp | ims >;
  for i in [Ngens(soc)+1..Ngens(group)] do
      g := group.i;
      CG := au62; ce := Id(au62);
      for j in [1..2] do
        isc, h := IsConjugate(CG,usimp.j^ce,homom(soc.j^g));
        if not isc then error "Conjugation error in Aut(U(6,2))"; end if;
        CG := Centraliser(CG,homom(soc.j^g));
        ce := ce*h;
      end for;
      Append(~ims,ce);
  end for;
  newgens := ims;
  for g in Generators(au62) do
     if not g in sub<au62|ims> then Append(~ims,g); end if;
  end for;
  au62 := sub< S | ims >;
  homom :=  hom< group -> au62 | newgens >;

  maximals:= [];
  if not max then 
    return homom, au62, maximals, F, phi;
  end if;

  if Print gt 1 then print "Constructing maximal subgroups"; end if;
  /* first construct maximals common to all the grps */

  M := sub<usimp|a, b^2*a*b^2>; // U(5,2)
  M`Order := 13685760;
  Append(~maximals, M);

  M := sub<usimp|(a,b), b*a*b^5*a*b^4>; // 2^(1+8):U(4,2)
  M`Order := 13271040;
  Append(~maximals, M);

  M := sub<usimp|(a,b), b*a*b*a*b^4>; // 2^9:L(3,4)
  M`Order := 10321920;
  Append(~maximals, M);

  M := sub<usimp|(a*b^2*a*b^3*a*b^3*a*b^3)^3,
  a*b^3*a*b^3*a*b^2*a*b^3 >; // 2^(4+8):(S3 × A5)
  M`Order := 1474560;
  Append(~maximals, M);

  M := sub<usimp|(a,b),  b*a*b*a*b*a*b^5*a*b^5>; // U(4,2) x S3
  M`Order := 155520;
  Append(~maximals, M);

  M := sub<usimp| a*b^2, 
    ((b^-1*x^-1*b*x)^3*b^-1)^2*b^-1*x*b*x*b^-1*x*b*x^-1*b^-1*x^-1*b*x^-1*b^-1 >
   where x is (a*b*b)^6; // 3^(1+4):(Q8 × Q8):S3
  M`Order := 93312;
  Append(~maximals, M);

  M := sub<usimp|(a,b), a*b*a*b*a*b^5*a*b^3*a*b^2*a*b^4>; // L(3,4):2_1
  M`Order := 40320;
  Append(~maximals, M);

  /* now for the different aut grps */
  if aut le 2 then
    /* maximals of usimp which are usimp-conjugate to their d-conjugate */
    M1 := sub<usimp| a, b*a*b*a*b^2*a*b^2*a*b^3>; // U(4,3):2
    M1`Order := 6531840;
    M2 := sub<usimp| a, b*a*b^4*a*b^3*a*b>; // S(6,2)
    M2`Order := 1451520;
    M3 := sub<usimp| (a, b), a*b*a*b*a*b^2*a*b^3*a*b^5>; // M22
    M3`Order := 443520;
    c2 := c^2;
    if aut eq 1 then
	maximals cat:= [M1, M1^c, M1^c2, M2, M2^c, M2^c2, M3, M3^c, M3^c2];
        return homom, au62, maximals, F, phi;
    else
	/* which conjugates do we want? */
	Im := Image(homom);
	if d in Im then
	    maximals cat:= [M1, M2, M3];
	elif d^c in Im then
	    maximals cat:= [M1^c, M2^c, M3^c];
	else
	    assert d^c2 in Im;
	    maximals cat:= [M1^c2, M2^c2, M3^c2];
	end if;
        return homom, au62, maximals, F, phi;
    end if;
  else
    /* novelties arise here */
    N := sub<usimp | [F|[ 1, 2, 2, 2, 1, -2, -2, -2, -1 ],
      [ 1, -2, -2, -2, 1, 2, 2, 2, -1 ],
      [ -2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, -1, -2, -2, -2, -1, 2, 2, -1, -2 ]
      ] @ phi >; // 3^4:S6
    N`Order := 58320;
    Append(~maximals, N);

    N := sub<usimp | [F|
	[ 2, 1, -2, -2, -2, 1, -2, 1, -2, -2, 1, -2, -2, 1, -2, -2, -1, -2,
	    -2, -1, -2, -2, -1, 2, 2, -1, 2, -1 ],
	[ 1, -2, -2, 1, 2, 2, 1, 2, 2, 1, 2, 1, -2, -2, -2, 1, 2, 2, 2, -1,
	   2, -1, 2, 2, -1, 2, 2, -1, -2, -1, -2, -1 ]] @ phi >;
    N`Order := 1512;
    Append(~maximals, N);
    return homom, au62, maximals, F, phi;
  end if;

end function;
