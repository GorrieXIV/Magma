freeze;

get_standard_gens_om83 := function(G)
// assumes G = O-(8,3), standard gens definition from Birmingham Atlas
// a in 2A, b in 4F, Orders of ab, abb, ababb are 41, 6, 41 resp.

    P := RandomProcess(G);

    // 3 in 26 of finding a 2A
    repeat a := Random(P); ord := Order(a); until ord in {26, 32, 52};
    a := a ^ (ord div 2); // in class 2A

    repeat 
	// This loop is 2076079/42456960 (about 1 in 20) of finding 
	repeat b := Random(P); ord := Order(b); until ord in {4, 8};
	if ord eq 8 then b := b^2; end if; 
	// about 2/3 prob that we've got b in  4F, have to confirm or reject
	count := 0;
	repeat
	    count +:= 1;
	    b := b^Random(P);
	    // if b in 4F then 1024/3321 is prob of next being true
	    // prob is 0 if b not in 4F
	    found4F := Order(a*b) in {40, 41};
	until found4F or count ge 15;
    until found4F;

    // this next is 1024/69741 (1 in 70 ish) of executing the return 
    repeat
	b := b^Random(P);
	x := a*b;
	if Order(x) ne 41 then continue; end if;
	// 2560/9963 to get here
	y := x*b;
	if Order(y) ne 6 then continue; end if;
	// 2048/69741 to get here
	if Order(x*y) eq 41 then return a,b; end if;
    until false;
end function;

distinguish_2_1 := function(G, x)
    P := RandomProcess(G);
    repeat

	ord := Order(Random(P)*x);

	// if not 2_1 then 361/910 or 15833/22386 or to return true
	if ord gt 36 then return false; end if;

	// if 2_1 then 2671/4095 to return true
	if ord in { 14, 18, 26, 28, 30, 36 } then return true; end if;

    until false;
end function;

OMinus8_3Identify := function(group:max:=true,Print:=0)
S := Sym(1066);
a := S!\[ 514, 881, 362, 762, 154, 474, 127, 555, 463, 809, 663, 12, 44, 560, 944, 1013, 
369, 66, 19, 475, 116, 1038, 99, 841, 1048, 155, 558, 806, 80, 386, 132, 820, 
556, 34, 547, 361, 527, 991, 54, 40, 719, 297, 43, 13, 317, 391, 1040, 840, 581, 
604, 333, 483, 725, 39, 469, 504, 931, 789, 59, 886, 879, 821, 1037, 1009, 712, 
18, 67, 357, 936, 985, 168, 399, 973, 797, 75, 273, 192, 614, 79, 29, 144, 665, 
982, 84, 903, 691, 1029, 515, 89, 893, 888, 1006, 256, 744, 955, 1024, 97, 295, 
23, 100, 880, 899, 890, 473, 105, 1018, 107, 742, 709, 963, 198, 1034, 200, 677, 
710, 21, 497, 286, 959, 443, 830, 253, 490, 341, 586, 929, 7, 623, 129, 804, 434,
31, 774, 869, 367, 596, 236, 697, 139, 724, 927, 180, 567, 81, 145, 196, 147, 
816, 379, 794, 283, 152, 798, 5, 26, 619, 962, 503, 506, 588, 910, 162, 435, 948,
500, 640, 532, 71, 212, 996, 405, 172, 643, 763, 859, 727, 387, 178, 580, 142, 
479, 1019, 188, 842, 250, 945, 187, 183, 884, 322, 1030, 77, 701, 688, 1054, 146,
895, 111, 622, 113, 971, 202, 807, 215, 646, 206, 1022, 672, 856, 843, 396, 169, 
708, 272, 204, 969, 471, 824, 219, 228, 917, 687, 436, 978, 999, 576, 439, 220, 
861, 1014, 419, 232, 833, 919, 812, 137, 354, 994, 554, 1025, 531, 242, 930, 695,
855, 355, 247, 716, 898, 185, 372, 960, 122, 595, 737, 93, 328, 647, 683, 811, 
755, 721, 621, 264, 460, 509, 390, 268, 1010, 488, 271, 214, 76, 771, 502, 352, 
395, 1007, 796, 793, 905, 307, 151, 760, 617, 118, 287, 667, 658, 826, 572, 302, 
448, 876, 98, 404, 42, 957, 452, 947, 301, 292, 525, 427, 310, 306, 282, 1032, 
336, 305, 964, 312, 313, 1046, 720, 866, 45, 748, 496, 326, 321, 190, 863, 346, 
1016, 320, 413, 257, 704, 330, 516, 651, 51, 334, 598, 309, 459, 521, 339, 340, 
124, 375, 543, 743, 974, 324, 590, 348, 559, 530, 928, 276, 353, 237, 246, 1003, 
68, 652, 629, 360, 36, 3, 950, 825, 407, 711, 135, 368, 17, 615, 926, 251, 389, 
1027, 342, 684, 786, 378, 149, 380, 1063, 449, 608, 384, 385, 30, 177, 534, 373, 
267, 46, 462, 644, 507, 277, 211, 577, 468, 72, 829, 787, 723, 403, 296, 171, 
800, 365, 730, 784, 539, 984, 739, 327, 414, 415, 633, 878, 432, 231, 908, 813, 
451, 610, 424, 425, 426, 304, 745, 981, 937, 769, 418, 485, 131, 163, 223, 714, 
501, 227, 546, 976, 764, 120, 924, 883, 864, 874, 293, 382, 657, 422, 299, 993, 
454, 648, 779, 836, 458, 337, 265, 747, 392, 9, 817, 956, 818, 467, 398, 55, 953,
217, 472, 104, 6, 20, 1011, 717, 906, 181, 605, 970, 872, 52, 773, 433, 696, 923,
270, 1044, 123, 1064, 492, 785, 528, 495, 319, 117, 612, 1045, 165, 438, 275, 
158, 56, 505, 159, 394, 597, 266, 510, 966, 606, 808, 1, 88, 331, 916, 992, 938, 
902, 338, 625, 523, 631, 303, 1043, 37, 494, 593, 350, 241, 167, 741, 388, 535, 
536, 1066, 791, 410, 941, 541, 882, 343, 582, 772, 440, 35, 756, 549, 553, 802, 
1028, 550, 239, 8, 33, 1020, 27, 349, 14, 997, 562, 563, 592, 838, 659, 143, 649,
998, 951, 892, 291, 732, 656, 754, 226, 397, 578, 650, 179, 49, 544, 831, 638, 
641, 125, 1052, 160, 854, 347, 734, 564, 529, 681, 254, 136, 508, 335, 632, 1015,
850, 636, 676, 50, 480, 512, 607, 383, 767, 423, 995, 498, 1001, 78, 370, 801, 
285, 983, 156, 642, 263, 199, 128, 870, 522, 885, 968, 827, 359, 1021, 524, 599, 
416, 634, 635, 602, 637, 584, 678, 166, 585, 620, 173, 393, 703, 205, 258, 455, 
568, 579, 332, 358, 736, 686, 679, 574, 450, 289, 566, 894, 661, 932, 11, 766, 
82, 706, 288, 750, 669, 837, 671, 208, 851, 674, 828, 603, 114, 639, 655, 680, 
594, 1012, 259, 376, 877, 654, 222, 194, 822, 1008, 86, 780, 778, 795, 244, 486, 
138, 726, 776, 700, 193, 977, 645, 329, 705, 666, 1060, 213, 109, 115, 366, 65, 
740, 437, 715, 248, 477, 731, 41, 315, 262, 722, 402, 140, 53, 698, 176, 1000, 
961, 408, 718, 573, 733, 591, 849, 653, 255, 738, 412, 713, 533, 108, 344, 94, 
428, 1036, 461, 318, 749, 668, 909, 752, 753, 575, 261, 548, 757, 758, 939, 284, 
896, 4, 174, 442, 1057, 664, 609, 921, 431, 815, 274, 545, 484, 133, 775, 699, 
990, 693, 456, 692, 781, 1042, 783, 409, 493, 377, 401, 788, 58, 790, 538, 949, 
280, 150, 694, 279, 74, 153, 799, 406, 616, 551, 803, 130, 1005, 28, 203, 513, 
10, 979, 260, 235, 421, 814, 770, 148, 464, 466, 967, 32, 62, 689, 823, 218, 364,
290, 628, 675, 400, 121, 583, 832, 233, 952, 835, 457, 670, 565, 942, 48, 24, 
184, 210, 844, 986, 853, 907, 1055, 735, 601, 673, 852, 846, 589, 245, 209, 857, 
858, 175, 889, 229, 1041, 323, 446, 988, 316, 867, 868, 134, 624, 1056, 482, 873,
447, 875, 294, 685, 417, 61, 101, 2, 542, 445, 189, 626, 60, 1062, 91, 860, 103, 
913, 571, 90, 660, 197, 761, 1050, 249, 102, 912, 934, 520, 85, 904, 281, 478, 
847, 420, 751, 161, 1051, 900, 891, 943, 915, 517, 221, 918, 234, 1033, 768, 922,
487, 444, 958, 371, 141, 351, 126, 243, 57, 662, 933, 901, 935, 69, 430, 519, 
759, 1031, 540, 839, 914, 15, 186, 946, 300, 164, 792, 363, 570, 834, 470, 954, 
95, 465, 298, 925, 119, 252, 729, 157, 110, 311, 965, 511, 819, 627, 216, 481, 
201, 1047, 73, 345, 975, 441, 702, 224, 810, 1035, 429, 83, 618, 411, 70, 845, 
987, 865, 989, 777, 38, 518, 453, 238, 611, 170, 561, 569, 225, 728, 613, 1061, 
356, 1004, 805, 92, 278, 690, 64, 269, 476, 682, 16, 230, 600, 325, 1017, 106,
182, 557, 630, 207, 1023, 96, 240, 1059, 374, 552, 87, 191, 940, 308, 920, 112, 
980, 746, 63, 22, 1039, 47, 862, 782, 526, 489, 499, 314, 972, 25, 1053, 897, 
911, 587, 1049, 195, 848, 871, 765, 1058, 1026, 707, 1002, 887, 381, 491, 1065, 
537 ];

b := S!\[ 743, 740, 828, 663, 789, 277, 870, 752, 598, 232, 630, 538, 849, 686, 1062, 48,
358, 421, 578, 54, 709, 1011, 472, 1043, 524, 362, 92, 423, 149, 720, 6, 220, 
919, 499, 968, 237, 665, 948, 219, 533, 864, 316, 567, 897, 633, 918, 1003, 530, 
681, 782, 90, 312, 297, 689, 1008, 75, 70, 851, 60, 696, 208, 878, 672, 529, 761,
834, 734, 908, 110, 426, 957, 506, 234, 468, 56, 298, 189, 601, 137, 604, 574, 
569, 40, 118, 324, 63, 526, 313, 794, 167, 1050, 302, 474, 927, 579, 187, 920, 
685, 622, 207, 1033, 416, 28, 894, 648, 546, 890, 933, 22, 784, 824, 410, 165, 
274, 621, 642, 843, 319, 353, 454, 17, 746, 692, 116, 507, 906, 480, 670, 992, 
190, 885, 611, 639, 470, 422, 974, 1057, 514, 953, 796, 185, 355, 991, 94, 179, 
688, 437, 1045, 669, 273, 714, 252, 940, 87, 693, 351, 1018, 876, 638, 303, 583, 
606, 397, 969, 564, 377, 830, 541, 678, 928, 809, 444, 727, 741, 641, 458, 215, 
841, 619, 865, 756, 395, 852, 724, 74, 867, 829, 1040, 367, 728, 443, 214, 986, 
229, 486, 581, 845, 493, 937, 131, 127, 786, 719, 329, 1037, 59, 11, 378, 93, 57,
253, 658, 913, 1065, 477, 471, 779, 984, 702, 925, 209, 747, 279, 718, 801, 82, 
420, 988, 483, 934, 53, 895, 754, 2, 235, 947, 1007, 1048, 1022, 921, 411, 792, 
877, 585, 534, 676, 385, 682, 593, 687, 438, 863, 392, 175, 631, 990, 695, 280, 
154, 950, 568, 188, 511, 406, 683, 290, 725, 465, 965, 263, 667, 866, 415, 463, 
766, 612, 903, 510, 129, 55, 655, 791, 103, 812, 781, 772, 664, 19, 176, 456, 
840, 7, 293, 679, 777, 981, 505, 473, 251, 795, 1052, 723, 68, 227, 151, 769, 
924, 403, 9, 83, 457, 286, 673, 158, 230, 462, 198, 159, 354, 596, 715, 191, 241,
856, 614, 610, 721, 901, 117, 800, 105, 521, 1054, 150, 645, 108, 152, 88, 961, 
748, 871, 294, 39, 774, 344, 907, 114, 773, 448, 556, 156, 281, 119, 84, 155, 
899, 1042, 594, 38, 757, 33, 30, 1015, 76, 245, 624, 368, 77, 396, 599, 1024, 
182, 356, 680, 466, 1031, 388, 528, 1063, 783, 211, 584, 195, 883, 978, 164, 
1064, 722, 825, 750, 41, 381, 153, 735, 942, 551, 382, 479, 536, 417, 738, 243, 
872, 543, 765, 742, 595, 518, 323, 588, 409, 24, 112, 482, 334, 848, 881, 544, 
819, 559, 910, 875, 283, 675, 785, 210, 587, 509, 350, 65, 1041, 983, 270, 128, 
929, 404, 183, 484, 371, 289, 684, 136, 634, 608, 547, 804, 936, 973, 896, 71, 
615, 1009, 177, 666, 703, 464, 348, 440, 265, 636, 399, 775, 347, 266, 320, 276, 
419, 141, 705, 133, 452, 716, 364, 221, 441, 301, 453, 607, 958, 697, 36, 451, 
822, 299, 868, 690, 1013, 296, 217, 66, 393, 14, 512, 729, 287, 272, 144, 318,
939, 430, 701, 200, 508, 575, 231, 21, 346, 256, 1061, 171, 433, 317, 325, 565, 
345, 447, 407, 912, 618, 922, 898, 730, 400, 586, 1012, 259, 332, 61, 659, 884, 
836, 694, 310, 632, 902, 842, 213, 360, 349, 857, 744, 161, 838, 97, 459, 249, 
915, 434, 148, 460, 972, 496, 340, 445, 803, 855, 228, 174, 304, 660, 971, 248, 
706, 989, 900, 582, 711, 945, 573, 140, 35, 292, 226, 520, 306, 111, 32, 811, 
284, 366, 923, 370, 1016, 163, 808, 650, 893, 413, 980, 609, 202, 985, 106, 121, 
640, 268, 315, 737, 566, 525, 793, 557, 242, 326, 708, 535, 807, 1002, 833, 80, 
668, 375, 814, 853, 414, 887, 79, 143, 982, 892, 205, 250, 357, 816, 23, 891, 
428, 435, 555, 100, 255, 365, 999, 322, 558, 790, 677, 498, 134, 517, 1034, 880, 
847, 768, 321, 917, 490, 997, 467, 25, 373, 600, 1055, 262, 713, 197, 1, 282, 
839, 425, 193, 45, 89, 932, 107, 975, 271, 888, 996, 548, 916, 998, 338, 78, 854,
731, 637, 240, 700, 291, 1025, 820, 545, 699, 762, 911, 99, 184, 776, 383, 739, 
238, 142, 328, 333, 206, 201, 18, 475, 342, 180, 343, 267, 592, 846, 13, 967, 
736, 72, 196, 780, 1056, 352, 787, 335, 625, 300, 522, 5, 26, 327, 166, 27, 146, 
455, 605, 178, 760, 691, 224, 837, 398, 960, 186, 979, 726, 309, 363, 494, 73, 
635, 1044, 778, 1026, 314, 431, 1038, 1058, 817, 531, 391, 170, 439, 199, 540, 
50, 12, 590, 1001, 130, 500, 962, 405, 827, 905, 616, 712, 139, 504, 629, 109, 
52, 311, 515, 42, 20, 671, 657, 1032, 43, 764, 181, 341, 941, 560, 1053, 305, 
946, 203, 550, 212, 831, 674, 4, 1000, 970, 576, 49, 386, 620, 1036, 424, 770, 
944, 993, 359, 1017, 1014, 278, 909, 288, 95, 537, 376, 628, 580, 1046, 427, 649,
562, 788, 194, 656, 797, 58, 476, 285, 387, 873, 51, 603, 308, 758, 647, 1004, 
390, 246, 436, 64, 374, 173, 461, 204, 860, 823, 1051, 561, 858, 563, 336, 389, 
147, 513, 802, 429, 938, 859, 102, 755, 844, 91, 104, 337, 751, 501, 552, 67, 
218, 914, 572, 380, 832, 96, 835, 879, 745, 1029, 62, 135, 124, 523, 821, 384, 
16, 502, 1030, 275, 132, 874, 37, 952, 330, 818, 1039, 1005, 379, 759, 527, 651, 
138, 532, 162, 31, 749, 763, 339, 125, 160, 653, 698, 492, 951, 813, 236, 554, 
295, 307, 15, 1066, 418, 169, 81, 710, 646, 577, 977, 497, 8, 815, 995, 34, 495, 
850, 597, 247, 1059, 233, 85, 931, 491, 69, 372, 192, 1028, 1047, 882, 869, 806, 
225, 432, 408, 966, 644, 861, 394, 926, 1035, 732, 1021, 1060, 126, 98, 623, 222,
930, 626, 707, 1006, 799, 570, 643, 369, 539, 976, 120, 442, 1049, 935, 955, 805,
1027, 145, 260, 485, 994, 1020, 767, 602, 113, 503, 519, 223, 589, 704, 269, 29,331, 86, 662, 717, 44, 172, 959, 889, 10, 571, 481, 258, 216, 733, 771, 652, 101,
244, 401, 542, 478, 239, 412, 661, 47, 157, 549, 753, 798, 168, 488, 446, 402, 
886, 613, 489, 487, 254, 450, 949, 115, 964, 862, 654, 122, 963, 1019, 264, 1023,
904, 261, 123, 956, 954, 469, 826, 591, 257, 810, 987, 617, 553, 516, 1010, 627, 
46, 449, 3, 943, 361 ];

c := S!\[ 1, 2, 3, 4, 5, 7, 6, 8, 11, 13, 9, 15, 10, 14, 12, 20, 22, 24, 26, 16, 21, 17, 
23, 18, 33, 19, 27, 37, 39, 41, 43, 45, 25, 48, 50, 52, 28, 55, 29, 40, 30, 60, 
31, 44, 32, 65, 47, 34, 69, 35, 72, 36, 53, 54, 38, 78, 80, 82, 59, 42, 85, 87, 
89, 91, 46, 94, 96, 98, 49, 101, 71, 51, 105, 107, 109, 111, 113, 56, 116, 57, 
119, 58, 122, 124, 61, 127, 62, 130, 63, 110, 64, 135, 93, 66, 139, 67, 97, 68, 
144, 100, 70, 148, 149, 151, 73, 154, 74, 157, 75, 90, 76, 112, 77, 164, 115, 79,
141, 118, 81, 171, 173, 83, 123, 84, 178, 126, 86, 128, 129, 88, 131, 132, 187, 
188, 92, 191, 193, 195, 95, 140, 117, 200, 202, 99, 145, 206, 147, 102, 103, 150,
104, 213, 153, 106, 155, 156, 108, 158, 159, 222, 223, 225, 227, 114, 165, 231, 
167, 198, 235, 170, 120, 205, 121, 208, 242, 176, 245, 125, 248, 180, 251, 253, 
183, 256, 258, 260, 133, 134, 264, 190, 136, 192, 137, 270, 138, 196, 274, 168, 
277, 142, 279, 143, 203, 283, 172, 146, 287, 174, 209, 291, 211, 294, 152, 217, 
215, 298, 214, 218, 302, 304, 306, 160, 161, 310, 162, 226, 163, 228, 315, 271, 
166, 232, 275, 234, 169, 236, 284, 324, 239, 327, 241, 175, 243, 244, 177, 333, 
335, 179, 338, 250, 181, 342, 182, 345, 255, 184, 348, 185, 351, 186, 354, 356, 
358, 189, 361, 266, 359, 268, 365, 194, 230, 369, 273, 197, 233, 374, 199, 278, 
201, 280, 379, 282, 204, 237, 384, 386, 207, 288, 389, 290, 210, 292, 293, 212, 
299, 396, 297, 216, 295, 300, 301, 219, 402, 220, 305, 221, 307, 308, 405, 224, 
407, 312, 410, 412, 229, 366, 416, 418, 319, 421, 423, 322, 426, 238, 325, 417, 
240, 328, 422, 434, 436, 332, 246, 440, 247, 443, 337, 249, 339, 430, 341, 252, 
343, 344, 254, 433, 347, 257, 349, 350, 259, 447, 353, 261, 451, 262, 452, 263, 
267, 466, 265, 362, 363, 471, 269, 316, 475, 477, 272, 370, 481, 483, 485, 276, 
487, 376, 489, 378, 281, 380, 493, 495, 497, 285, 478, 286, 387, 388, 289, 486, 
506, 507, 393, 394, 509, 296, 397, 398, 513, 400, 401, 303, 517, 514, 309, 406, 
311, 408, 521, 313, 523, 314, 526, 414, 529, 317, 326, 318, 419, 510, 320, 329, 
321, 424, 425, 323, 530, 541, 542, 340, 543, 544, 346, 330, 547, 331, 550, 551, 
553, 334, 441, 557, 336, 528, 445, 476, 352, 562, 449, 484, 355, 357, 453, 454, 
455, 496, 559, 561, 570, 564, 572, 503, 575, 464, 578, 360, 467, 581, 469, 470, 
364, 472, 473, 474, 367, 446, 368, 385, 592, 480, 371, 482, 372, 450, 373, 390, 
375, 488, 377, 490, 602, 492, 381, 605, 382, 456, 383, 587, 499, 612, 613, 615, 
462, 504, 619, 391, 392, 623, 395, 420, 627, 629, 399, 404, 515, 633, 403, 635, 
519, 637, 409, 522, 411, 524, 525, 413, 527, 444, 415, 427, 647, 649, 648, 614, 
651, 653, 652, 656, 539, 658, 428, 429, 431, 432, 659, 546, 435, 585, 667, 437, 
438, 671, 439, 554, 674, 556, 442, 677, 457, 628, 458, 448, 681, 460, 683, 668, 
567, 678, 687, 459, 689, 461, 643, 692, 463, 688, 694, 465, 579, 696, 468, 582, 
583, 584, 548, 586, 498, 588, 595, 590, 591, 479, 593, 594, 589, 596, 707, 598, 
599, 600, 601, 491, 603, 714, 494, 716, 607, 608, 720, 610, 723, 500, 501, 534, 
502, 711, 617, 729, 505, 722, 621, 622, 508, 624, 625, 735, 511, 560, 512, 739, 
741, 742, 516, 634, 518, 743, 520, 638, 639, 731, 641, 642, 573, 753, 645, 646, 
531, 533, 532, 746, 535, 537, 536, 756, 763, 538, 766, 540, 545, 660, 661, 662, 
663, 773, 665, 666, 549, 566, 669, 779, 552, 672, 783, 555, 675, 676, 558, 568, 
679, 680, 563, 682, 565, 790, 795, 686, 569, 576, 571, 796, 691, 574, 693, 577, 
765, 580, 697, 698, 699, 700, 805, 702, 703, 808, 762, 811, 597, 708, 709, 806, 
616, 712, 713, 604, 817, 606, 717, 718, 719, 609, 721, 620, 611, 816, 725, 726, 
803, 827, 618, 730, 640, 830, 733, 734, 626, 736, 737, 738, 630, 836, 631, 632, 
636, 841, 745, 650, 843, 748, 846, 750, 849, 847, 644, 754, 755, 654, 757, 758, 
855, 760, 761, 705, 655, 860, 695, 657, 861, 768, 862, 770, 771, 772, 664, 774, 
824, 868, 869, 778, 670, 780, 871, 873, 673, 876, 794, 872, 787, 788, 881, 684, 
791, 882, 886, 785, 685, 690, 797, 892, 894, 895, 801, 802, 727, 897, 701, 710, 
807, 704, 901, 903, 706, 898, 813, 814, 815, 724, 715, 818, 819, 910, 912, 822, 
823, 775, 911, 915, 728, 918, 920, 732, 922, 865, 833, 926, 835, 740, 837, 928, 
839, 840, 744, 930, 747, 844, 845, 749, 752, 848, 751, 850, 851, 887, 853, 854, 
759, 856, 940, 942, 859, 764, 767, 769, 863, 864, 832, 866, 947, 776, 777, 870, 
781, 786, 782, 874, 891, 784, 877, 878, 960, 921, 789, 792, 883, 884, 885, 793, 
852, 966, 889, 890, 875, 798, 968, 799, 800, 896, 804, 812, 899, 971, 809, 902, 
810, 904, 905, 906, 907, 908, 909, 820, 825, 821, 913, 914, 826, 916, 917, 828, 
954, 829, 880, 831, 979, 924, 925, 834, 927, 838, 929, 842, 931, 991, 933, 934, 
935, 936, 937, 938, 939, 857, 994, 858, 943, 944, 945, 946, 867, 948, 981, 950, 
1002, 952, 1004, 919, 955, 956, 1006, 1003, 959, 879, 961, 962, 1009, 1010, 965, 888, 1011, 893, 1013, 970, 900, 972, 973, 974, 993, 976, 977, 996, 923, 980, 949,
1019, 1015, 984, 985, 986, 987, 988, 989, 990, 932, 992, 975, 941, 995, 978, 997,
998, 999, 1000, 1001, 951, 958, 953, 1005, 957, 1033, 1029, 963, 964, 967, 1018, 
969, 1014, 983, 1016, 1017, 1012, 982, 1020, 1021, 1022, 1023, 1024, 1043, 1026, 
1027, 1028, 1008, 1045, 1031, 1032, 1007, 1048, 1035, 1040, 1037, 1051, 1039, 
1036, 1041, 1042, 1025, 1044, 1030, 1046, 1057, 1034, 1049, 1050, 1038, 1052, 
1053, 1059, 1055, 1056, 1047, 1058, 1054, 1060, 1061, 1062, 1063, 1064, 1065, 
1066 ];

d := S!\[2, 3, 4, 5, 6, 8, 9, 10, 12, 1, 14, 16, 17, 18, 19, 21, 23, 25, 27, 28, 29, 30,
31, 32, 34, 35, 36, 38, 40, 42, 44, 46, 47, 49, 51, 53, 54, 56, 57, 58, 59, 61, 
62, 63, 64, 66, 67, 68, 70, 71, 73, 74, 75, 76, 77, 79, 81, 7, 83, 84, 86, 88, 
90, 92, 93, 95, 97, 99, 100, 102, 103, 104, 106, 108, 110, 112, 114, 115, 117, 
118, 120, 121, 123, 125, 126, 128, 129, 131, 132, 133, 134, 136, 137, 138, 140, 
141, 142, 143, 145, 146, 147, 11, 150, 152, 153, 155, 156, 158, 159, 160, 161, 
162, 163, 165, 166, 167, 168, 169, 170, 172, 174, 175, 176, 177, 179, 180, 181, 
182, 183, 184, 185, 186, 13, 189, 190, 192, 194, 196, 197, 198, 199, 201, 203, 
204, 205, 207, 208, 209, 210, 211, 212, 214, 215, 216, 217, 218, 219, 220, 221, 
15, 224, 226, 228, 229, 230, 232, 233, 234, 236, 237, 238, 239, 240, 241, 243, 
244, 246, 247, 249, 250, 252, 254, 255, 257, 259, 261, 262, 263, 265, 266, 267, 
268, 269, 271, 272, 273, 275, 276, 278, 89, 280, 281, 282, 284, 285, 286, 288, 
289, 290, 292, 293, 295, 296, 72, 297, 299, 300, 301, 303, 305, 307, 308, 309, 
148, 311, 312, 313, 314, 316, 317, 318, 319, 320, 20, 321, 322, 323, 325, 326, 
328, 329, 330, 173, 331, 332, 334, 336, 337, 339, 340, 341, 343, 344, 22, 346, 
347, 349, 350, 352, 353, 355, 357, 359, 360, 362, 270, 363, 364, 366, 367, 368, 
370, 371, 372, 373, 24, 375, 376, 377, 378, 380, 381, 382, 383, 385, 387, 50, 
388, 390, 391, 392, 248, 393, 394, 395, 52, 397, 398, 399, 26, 400, 401, 306, 
403, 213, 157, 404, 151, 206, 406, 408, 409, 411, 413, 414, 415, 417, 419, 420, 
422, 424, 425, 427, 428, 429, 430, 431, 432, 433, 435, 437, 438, 439, 441, 442, 
444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 122, 
459, 460, 111, 461, 462, 463, 464, 465, 467, 468, 469, 470, 472, 473, 474, 476, 
478, 479, 480, 482, 484, 486, 149, 488, 356, 490, 33, 491, 492, 494, 496, 498, 
499, 500, 501, 502, 503, 504, 505, 354, 333, 287, 508, 302, 510, 511, 512, 514, 
515, 222, 516, 154, 518, 471, 519, 520, 187, 37, 522, 524, 525, 527, 528, 530, 
531, 532, 533, 534, 506, 535, 536, 537, 538, 327, 539, 540, 87, 345, 39, 80, 351,
545, 546, 548, 549, 41, 552, 554, 555, 556, 529, 558, 559, 560, 561, 481, 544, 
563, 564, 493, 565, 566, 324, 567, 568, 526, 569, 43, 571, 573, 574, 576, 577, 
579, 274, 580, 582, 583, 584, 585, 45, 586, 587, 588, 589, 590, 591, 593, 594, 
60, 595, 596, 597, 598, 599, 107, 600, 517, 601, 603, 202, 604, 606, 607, 608, 
609, 610, 611, 48, 614, 616, 617, 618, 620, 621, 622, 624, 625, 626, 628, 489, 
630, 631, 632, 109, 634, 402, 636, 260, 638, 639, 640, 641, 642, 643, 483, 644, 
645, 646, 648, 55, 615, 650, 652, 654, 655, 436, 657, 659, 660, 661, 662, 663, 
664, 386, 665, 666, 668, 669, 670, 672, 673, 405, 675, 475, 676, 678, 679, 374, 
680, 681, 384, 682, 684, 685, 416, 686, 688, 627, 690, 691, 200, 96, 693, 225, 
283, 407, 695, 697, 418, 649, 698, 699, 291, 700, 701, 124, 702, 703, 65, 127, 
704, 705, 706, 113, 708, 709, 710, 711, 712, 116, 713, 592, 715, 717, 718, 719, 
721, 722, 724, 725, 629, 726, 727, 728, 69, 730, 551, 731, 78, 732, 256, 733, 
734, 736, 542, 737, 738, 740, 304, 487, 743, 744, 745, 746, 747, 748, 749, 750, 
751, 752, 696, 754, 755, 756, 757, 623, 758, 759, 760, 761, 762, 602, 764, 765, 
767, 768, 769, 770, 771, 772, 85, 82, 774, 775, 776, 777, 778, 780, 781, 782, 
784, 785, 786, 787, 788, 789, 714, 790, 791, 792, 793, 794, 171, 796, 797, 798, 
799, 578, 277, 800, 310, 801, 802, 130, 803, 91, 804, 677, 806, 135, 807, 809, 
810, 94, 812, 813, 557, 814, 815, 816, 817, 818, 819, 820, 98, 671, 358, 821, 
822, 823, 824, 251, 825, 667, 826, 223, 828, 829, 101, 831, 832, 550, 389, 833, 
105, 834, 835, 837, 838, 839, 840, 842, 843, 844, 845, 651, 847, 848, 850, 851, 
674, 852, 853, 854, 509, 707, 692, 856, 857, 858, 859, 827, 855, 656, 637, 495, 
119, 739, 863, 864, 865, 866, 867, 434, 235, 647, 315, 870, 872, 874, 875, 877, 
873, 878, 879, 880, 882, 883, 884, 885, 887, 888, 889, 890, 891, 893, 694, 231, 
862, 896, 897, 898, 830, 881, 899, 900, 902, 904, 905, 906, 907, 139, 572, 908, 
687, 178, 909, 911, 913, 914, 144, 808, 410, 916, 917, 919, 742, 921, 923, 924, 
925, 613, 927, 836, 741, 926, 735, 929, 841, 298, 543, 575, 931, 932, 612, 933, 
860, 934, 935, 936, 937, 164, 938, 939, 941, 943, 915, 944, 945, 946, 947, 948, 
547, 795, 949, 950, 951, 952, 953, 658, 954, 955, 956, 957, 958, 959, 961, 962, 
193, 963, 964, 965, 966, 967, 523, 920, 773, 968, 379, 849, 940, 969, 846, 188, 
970, 191, 720, 972, 811, 973, 689, 195, 894, 361, 466, 974, 605, 975, 976, 338, 
477, 977, 978, 979, 876, 980, 981, 253, 982, 983, 984, 985, 986, 987, 988, 521, 
989, 990, 426, 723, 683, 227, 886, 779, 992, 993, 928, 258, 995, 996, 997, 998, 
633, 999, 1000, 635, 242, 1001, 1003, 1002, 766, 1005, 245, 942, 423, 1007, 1008,
342, 485, 365, 1010, 912, 930, 960, 412, 1012, 1014, 264, 910, 895, 1015, 279, 
1016, 1017, 1018, 1019, 581, 971, 1020, 1009, 1021, 991, 294, 1022, 513, 994, 
1023, 1024, 1025, 335, 871, 541, 1026, 1027, 1013, 1011, 903, 570, 1028, 1029, 
729, 1030, 1031, 1032, 1034, 1035, 1036, 1037, 1038, 348, 1006, 1039, 369, 1040, 
922, 1041, 1042, 869, 716, 396, 861, 562, 507, 421, 1044, 868, 619, 763, 1046, 
653, 1047, 1049, 440, 1050, 443, 1052, 1053, 1054, 497, 1004, 1055, 1051, 1056, 
753, 1058, 805, 553, 1048, 783, 892, 901, 918, 1060, 1061, 1059, 1062, 1063, 
1057, 1064, 1045, 1065, 1033, 1066, 1043 ];

    om83 := sub<S|a,b>;
    om83`Order := 10151968619520;
    F, phi := FPGroupStrong(om83);
    soc := Socle(group);
    aut := Index(group, soc);
    if Print gt 1 then printf "group is O-(8,3):[%o]\n", aut; end if;
    ga, gb:= get_standard_gens_om83(soc);
    soc := sub< soc | ga,gb >;
    soc`Order := 10151968619520;
    newgens := [ group | ga, gb];
    for g in Generators(group) do
       if not g in sub<group|newgens> then Append(~newgens,g); end if;
    end for;
    group := sub<group|newgens>;
    autom83 := sub< S | a, b, c, d >;
    ims := [ autom83 | a, b ];
    homom :=  hom< soc -> om83 | ims >;
    for i in [Ngens(soc)+1..Ngens(group)] do
        g := group.i;
        CG := autom83; ce := Id(autom83);
        for j in [1..2] do
            isc, h := IsConjugate(CG,om83.j^ce,homom(soc.j^g));
            if not isc then error "Conjugation error in Aut(O-(8,3))"; end if;
            CG := Centraliser(CG,homom(soc.j^g));
            ce := ce*h;
        end for;
        Append(~ims,ce);
    end for;
    newgens := ims;
    autom83 := sub<autom83|ims>;
    if aut eq 2 then
	dummy := exists(x){x:x in ims|x notin om83};
	assert dummy;
    end if;
    for g in [c, d] do
        if not g in autom83 then 
	    Append(~ims,g); 
	    autom83 := sub<S|ims>;
	end if;
    end for;
    homom :=  hom< group -> autom83 | newgens >;

    maximals:= [];
    if not max then 
        return homom, autom83, maximals, F, phi;
    end if;
    
    if aut eq 2 then
	simple_flag := distinguish_2_1(om83, x);
    else
	simple_flag := aut eq 1;
    end if;






    // 3^6:2U(4,3).2
    M := sub<om83| 
	    a, 
	    b * a * b * a * b^-1 * a * b^-1,
	    (b^-1 * a * b^-1 * a * b^-1 * a * b *a * b)^2 >;
    M`Order := 9523422720;
    Append(~maximals, M); 

    if simple_flag then
	// O(7,3):2 twice
	M := sub<om83| 
		a * b^2 * a * b^-1 * a * b * a * b^2 * a, 
		b * a * b^-1 * a * b * a * b * a * b^-1 * a * b^2 * a * b^2 >;
	M`Order := 9170703360;
	Append(~maximals, M); 
	Append(~maximals, M^d); 
    else
	// 2U(4,3).[4]
	M := sub<om83|
	    b^-1 * a * b * a * b^-1 * a * b^-1 * a * b * a * b^2 * a * b^2 * 
		a * b * a * b * a * b * a * b^-1 * a * b, 
	    a * b * a * b^2 * a * b * a * b * a * b * a * b^-1 * a * b^-1 * a * 
		b^2 * a * b * a * b * a * b * a * b * a * b^-1 * a >;
	M`Order := 26127360;
	Append(~maximals, M); 
    end if;

    // 3^(3+6):(L(3,3)x2^2)
    M := sub<om83|
	a * b^-1 * a * b * a * b^2 * a * b^2 * a * b * a * b * a, 
	a * b^2 * a * b^-1 * a * b^2 * a * b^-1 * a * b * a * b * a * b * a * b>;
    M`Order := 442158912;
    Append(~maximals, M); 

    // 3^(1+8):(2S4xA6)
    M := sub<om83|
	b * a * b^2 * a * b * a * b * a * b * a * b^-1 * a * b^-1 * a * b^-1 * 
	    a * b^-1 * a * b^-1 * a * b^-1, 
	b^2 * a * b^2 * a * b^-1 * a * b * a * b^2 * a * b^2 * a * b * a * 
	    b * a * b, 
	a * b * a * b * a * b^-1 * a * b * a * b^2 * a * b^2 * a * b * a * b * 
	    a * b^2 * a * b^2 * a >;
    M`Order := 340122240;
    Append(~maximals, M);

    // (4 x L(4,3)):2
    M := sub<om83|
	a * b^-1 * a * b * a, 
	a * b * a * b^-1 * a * b^-1 * a * b * a * b * a * b^-1 * a * 
	    b^-1 * a * b * a * b^2 >;
    M`Order := 48522240;
    Append(~maximals, M);

    if simple_flag then
	// S4 x U(4,2):2 twice
	M := sub<om83|
	    (a * b * a * b^-1 * a * b^2 * a * b^-1 * a * b^-1 * a * b^-1 * 
		a * b * a * b * a * b^-2 * a * b * a * b^-1 * a)^2, 
	    a * b^2 * a * b * a * b^-1 * a * b^2 * a * b^-1 * a * b * a * b^-1 * 
		a * b^-1 * a * b * a * b^-1 * a * b^-2 * a, 
	    (a * b * a * b^2 * a * b^2 * a * b * a * b * a * b^-1 * a * b^-1 * 
		a * b^-1 * a * b^-2 * a * b^-2 * a * b^-1 * a)^2, 
	    a * b^-1 * a * b * a * b^-1 * a * b^-1 * a * b * a * b * a * b * a * 
		b^-1 * a * b^-1 * a * b * a * b^-1 * a * b^-1 * a * b^-2 * 
		a * b^-1 * a >;
	M`Order := 1244160;
	Append(~maximals, M);
	Append(~maximals, M^d);
    end if;

    // L(2,81):2
    M := sub<om83|
	b^-1 * a * b^2 * a * b^-1 * a * b^2 * a * b^-1 * a * b * a * b^2 * a * 
	    b * a * b^-2 * a * b, 
	a * b^-1 * a * b^2 * a * b * a * b * a * b^2 * a * b^2 * a * b * a * 
	    b^-1 * a * b^2 * a * b * a, 
	a * b * a * b * a * b^2 * a * b^-1 * a * b * a * b * a * b^-1 * a * 
	    b^-1 * a * b * a * b^2 * a * b^-1 * a * b^-1 * a, 
	a * b * a * b^-1 * a * b^2 * a * b^-1 * a * b^2 * a * b^-1 * a * b * 
	    a * b^-1 * a * b^-1 * a * b * a * b^2 * a * b * a * b^-1 * a >;
    M`Order := 531360;
    Append(~maximals, M);

    // (A6x2(A4xA4).2).2
    M := sub<om83|
	a * b * a * b * a * b^-1 * a * b^2 * a * b * a * b^2 * a * b^2 * 
	    a * b^-1 * a * b^2 * a * b * a * b^-1 * a * b^-1 * a, 
	b * a * b * a * b * a * b^-1 * a * b^2 * a * b^-1 * a * b * a * b * 
	    a * b^-1 * a * b^-1 * a * b * a * b^-2 * a * b * a * b^-1 * a * 
	    b^-1 * a * b^-1, 
	b * a * b^-1 * a * b * a * b * a * b^-1 * a * b * a * b * a * b^-1 * 
	    a * b^2 * a * b * a * b * a * b * a * b^-1 * a * b^-1 * a * b^-1 * 
	    a * b^-1 * a * b^-1 * a * b^-1 * a * b^-1 >;
    M`Order := 414720;
    Append(~maximals, M);

    return homom, autom83, maximals, F, phi;
end function;
