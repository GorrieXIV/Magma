<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Hilbert Series and Graded  Rings</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text1391.htm">[Next]</A><A  HREF = "text1389.htm">[Prev]</A> <A  HREF = "text1391.htm">[Right]</A> <A  HREF = "text1389.htm">[Left]</A> <A  HREF = "text1388.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "15555">Hilbert Series and Graded  Rings</A></H3>

<P>
<P>
<P>
The theory of Hilbert series is standard so it is only briefly
touched on here.  See Matsumura <A  HREF = "text1387.htm#bib_matsumura">[Mat89]</A> Section 13
for more details (or other any standard textbook on algebra such as
Zariski--Samuel or Eisenbud.)



<H5>Subsections</H5>
<UL>
<LI> <A  HREF = "text1390.htm#15556">Hilbert Series and Hilbert Polynomials</A>
<LI> <A  HREF = "text1390.htm#15559">Interpreting the Hilbert Numerator</A>
</UL>
<H4><A NAME = "15556">Hilbert Series and Hilbert Polynomials</A></H4>

<P>
<P>
<P>
Let R = direct-sum R<sub>n</sub>, the sum taken over n&ge;0, be a
finitely-generated graded k-algebra with R<sub>0</sub>=k and grading
given by n.
The <I>Hilbert polynomial</I> of R is the numerical polynomial
p(t) such that dim R<sub>n</sub> = p(n) for all n sufficiently large.
The <I>Hilbert series</I> of R is the power series
<P>
P(R) = &sum;<sub>n&ge;0</sub> (dim R<sub>n</sub>) t<sup>n</sup>.
<P>
For example, let C&sub;PP<sup>3</sup> be the twisted cubic defined by
the three equations
<P>
xz = y<sup>2</sup>,   xt = yz,   yt = z<sup>2</sup>
<P>
and let
<P>
R = ( (k[x, y, z, t]) /(xz - y<sup>2</sup>, xt - yz, yt - z<sup>2</sup>) )
<P>
be the homogeneous polynomial ring of C.  Then one computes that
<P>
P(R) = 1 + 4t + 7t<sup>2</sup> + 10t<sup>3</sup> + ... as follows.  Certainly R<sub>0</sub>=k, and there are no equations of degree 1
so R<sub>1</sub> is the 4-dimensional vector space spanned by x, y, z, t.
Now R<sub>2</sub> is spanned by the 10 quadrics x<sup>2</sup>, xy, ..., t<sup>2</sup>, but these
are related  by the three equations, so dim R<sub>2</sub> = 10 - 3 = 7.
And so on.  If you are systematic about it, you will discover quickly
that the dimension of R<sub>n</sub> is 3n + 1 for n&ge;1. This can be proved 
by induction.  So the Hilbert polynomial of R is p(t)=3t + 1,
which determines every coefficient of the Hilbert series P(R) 
except the constant term.
<P>
Consider a bigger example: let C=C<sub>10</sub>&sub;PP(1, 1, 5) be a
hyperelliptic curve of genus 4 and degree 2 given by an equation
<P>
y<sup>2</sup> = f<sub>10</sub>(x<sub>1</sub>, x<sub>2</sub>)
<P>
in coordinates x<sub>1</sub>, x<sub>2</sub>, y on wps PP(1, 1, 5) where f<sub>10</sub> is
some general polynomial of degree 10.  Again one calculates the
Hilbert polynomial as p(t)=2t - 3 and Hilbert series as
<P>
P(t) = 1 + 2t + 3t<sup>2</sup> + 4t<sup>3</sup> + 5t<sup>4</sup> + 7t<sup>5</sup> + 9t<sup>6</sup> + ... .
<P>
This power series can also be described as a rational function
<P>
P(t) = ((1 - t<sup>10</sup>)/((1 - t)<sup>2</sup>(1 - t<sup>5</sup>)))
<P>
from which one can formulate a rule of thumb for relating this
expression to the description of the curve as
C<sub>10</sub>&sub;PP(1, 1, 5) (or see the answer in Section <A  HREF = "text1400.htm#15721">Making New Databases</A>
or <A  HREF = "text1387.htm#bib_kinosaki00">[Rei00]</A>, Section 3.2).
<P>
Now there are other curves in wps that have the same Hilbert
polynomial p as this example, but which have a different Hilbert
series.  To find one, consider modifying early terms of the
series
<P>
	P(t) = 1 + t + 2t<sup>2</sup> + 4t<sup>3</sup> + 5t<sup>4</sup> + 7t<sup>5</sup> + 9t<sup>6</sup> + ... and attempt to build the curve B in some wps.  The coefficient
of the term t (which is 1 in this case) implies that there is
one linear coordinate x.  Then the 2t<sup>2</sup> demands one degree 2
coordinate y so that the 2-dimensional space of degree 2 homogeneous
functions is spanned by x<sup>2</sup>, y.  In degree 3, x, y generate only
a 2-dimensional space &lt; x<sup>3</sup>, xy &gt;, but the graded piece
in degree 3 is 4-dimensional, according to the term 4t<sup>3</sup>, so
there must be two more generators z<sub>1</sub>, z<sub>2</sub>.  In degree 4 we see
x<sup>4</sup>, x<sup>2</sup>y, y<sup>2</sup>, xz<sub>1</sub>, xz<sub>2</sub> which is just right if we assume that these
are linearly independent (which we do).  Similarly in degree 5 we hit
the right number on the nose.  But in degree 6 we see 11 monomials:
<P>
x<sup>6</sup>, x<sup>4</sup>y, x<sup>2</sup>y<sup>2</sup>, y<sup>3</sup>, x<sup>3</sup>z<sub>1</sub>, xyz<sub>1</sub>, x<sup>3</sup>z<sub>2</sub>, xyz<sub>2</sub>, z<sub>1</sub><sup>2</sup>,
z<sub>1</sub>z<sub>2</sub>, z<sub>2</sub><sup>2</sup>.
<P>
These lie in a 9-dimensional vector space (9 being the coefficient
of t<sup>6</sup> in P(t)) so there must be two relations between them.
We could carry on in this vein, but in fact we have done enough
now: it is an exercise in wps to show that the curve
<P>
B = B<sub>6, 6</sub> &sub;PP(1, 2, 3, 3)
<P>
defined by two general polynomials of degree 6 has genus 4 and
degree 2 just as in the first example.  We will work this 
example in Magma in the next subsection.
<P>
Thus the Hilbert polynomial determines the coefficients of high
powers of t in the Hilbert series.  So in this case, and more
generally for the subcanonical curves of Section <A  HREF = "text1393.htm#15638">Subcanonical Curves</A>,
to determine a Hilbert series P one must produce both the
Hilbert polynomial p and a sequence V of the early coefficients
that are not determined by p.
<P>
There is one extra twist that can happen:  it is possible that
there is not a single Hilbert polynomial p that determines the
higher coefficients, but a sequence of polynomials
p<sub>0</sub>, ..., p<sub>r - 1</sub> so that the nth coefficient is given by
p<sub>i</sub>(n) where i is the residue of n modulo r.  It is easy
to generate examples of this using the intrinsics described below.
This phenomenon occurs naturally when the RR data includes
quotient singularities or fractional divisors, since these tend
to make periodic corrections to an otherwise well-determined
Hilbert polynomial, and one could rephrase this as above by
saying that there is a sequence of Hilbert polynomials.
In practice, this is a small distraction that is completely
bound up in the main creation intrinsics.


<H5><A NAME = "15557">HilbertFunction(p,V) : RngUPolElt, SeqEnum -&gt; UserProgram</A></H5>
<H5>HilbertFunction(Q,V) : SeqEnum, SeqEnum -&gt; UserProgram</H5>
<BLOCKQUOTE>
The Hilbert function determined by a univariate polynomial p
(the Hilbert polynomial), or a sequence Q of univariate
polynomials, and a sequence of initial values V.  The returned
object is a function whose domain is the integers.
</BLOCKQUOTE>
<H5><A NAME = "15558">HilbertSeries(p,V) : RngUPolElt, SeqEnum -&gt; FldFunRatUElt</A></H5>
<H5>HilbertSeries(Q,V) : SeqEnum, SeqEnum -&gt; FldFunRatUElt</H5>
<BLOCKQUOTE>
The Hilbert series determined by a univariate polynomial p
(the Hilbert polynomial), or a sequence Q of univariate
polynomials, and a sequence of initial values V.
The returned object is a rational function in one variable.
</BLOCKQUOTE>
<H4><A NAME = "15559">Interpreting the Hilbert Numerator</A></H4>

<P>
<P>
<P>
The Hilbert series of a variety X&sub;(P)(w<sub>0</sub>, ..., w<sub>N</sub>)
defined by equations of degrees d<sub>1</sub>, ..., d<sub>r</sub> has the form
<P>
P(t) = ((1 - t<sup>d<sub>1</sub></sup> - t<sup>d<sub>2</sub></sup> - ... - t<sup>d<sub>r</sub></sup> + t<sup>e</sup> &#8723; ... &#8723; t<sup>k</sup>)
	/((1 - t<sup>w<sub>0</sub></sup>) ... (1 - t<sup>w<sub>N</sub></sup>))).
<P>
We refer to the numerator of this expression as the <I>Hilbert
numerator with respect to the weights w<sub>0</sub>, ..., w<sub>N</sub></I>,
or simply <I>Hilbert numerator</I> if the weights are clear.
<P>
The aim is to apply a converse statement: if we can manipulate
the Hilbert series of a polarised variety into such a form,
we guess that it is embedded in (P)(w<sub>0</sub>, ..., w<sub>N</sub>)
by equations of degrees given by low degree terms with
negative coefficients (where the absolute value of the
coefficient determines the number of equations of that degree).
<P>
This can be taken further:  the syzygies, and indeed a free
resolution of the ideal of X, are also encoded weakly in
the weights and the Hilbert numerator.  For more details
see <A  HREF = "text1387.htm#bib_kinosaki00">[Rei00]</A>, Section 3, or <A  HREF = "text1387.htm#bib_ABR">[ABR02]</A>, Section 4.


<H5><A NAME = "15560">HilbertSeriesMultipliedByMinimalDenominator(p,V) : RngUPolElt, SeqEnum -&gt; RngUPolElt, SeqEnum</A></H5>
<H5>HilbertSeriesMultipliedByMinimalDenominator(Q,V) : SeqEnum, SeqEnum -&gt; RngUPolElt, SeqEnum</H5>
<BLOCKQUOTE>
Let h be the Hilbert series determined by a univariate
polynomial p, or a sequence Q of univariate polynomials, and a
sequence of initial values V.  This function produces a rational
expression g(t)/&Pi;(1 - t<sup>d</sup>) for h, returning the numerator g 
as first value and a sequence containing the factors 1 - t<sup>d</sup> of the 
denominator as second value.
</BLOCKQUOTE>
<H5><A NAME = "15561">HilbertNumerator(g, D) : FldFunRatUElt, SeqEnum -&gt; FldFunRatUElt</A></H5>
<BLOCKQUOTE>
The product g x &Pi;(1 - t<sup>d</sup>) taken over all integers d&isin;D,
assuming the result is a polynomial.  This function is typically 
used when g is a Hilbert series and D is a proposed collection 
of weights for a variety realising this series.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "15562">Example <TT>GrdRng_gr-genus4curve (H123E1)</TT></A></H3>
We reproduce the example described in the introduction
to this Section <A  HREF = "text1390.htm#15555">Hilbert Series and Graded  Rings</A>.
<P>
<P>
<PRE>
&gt; T&lt;t&gt; := PolynomialRing(Rationals());
&gt; p := 2*t - 3;
&gt; V := [ 1, 2, 3, 4 ];                          
&gt; h_fun := HilbertFunction(p,V);
&gt; [ h_fun(n) : n in [0..7]];        
[ 1, 2, 3, 4, 5, 7, 9, 11 ]
&gt; h := HilbertSeries(p,V);
&gt; h;
(t^5 + 1)/(t^2 - 2*t + 1)
</PRE>
The Hilbert series will be the Hilbert series of a polarised curve C
(since the degree of the Hilbert polynomial---the order of growth
of the coefficients of the Hilbert series---is one).  It is already
expressed as a rational function, so we apply a power series ring 
coercion to see the dimensions of the graded pieces---we could 
increase the precision if required.
<P>
<P>
<PRE>
&gt; S&lt;s&gt; := PowerSeriesRing(Rationals(),8);
&gt; S ! h;                                  
1 + 2*s + 3*s^2 + 4*s^3 + 5*s^4 + 7*s^5 + 9*s^6 + 11*s^7 + O(s^8)
</PRE>
The rule of thumb for interpreting Hilbert series as varieties defined
by homogeneous polynomials in wps requires one to write the Hilbert
series in the form P/Q for polynomials P, Q, where Q is a product
of terms 1 - t<sup>a</sup> (corresponding to the coordinates of weight a).
The next line computes the Hilbert series together with the minimal
such expression.
<P>
<P>
<PRE>
&gt; HilbertSeriesMultipliedByMinimalDenominator(p,V);
t^5 + 1
[ -t + 1, -t + 1 ]
</PRE>
One could interpret this return value as a Noether normalisation
of the graded ring of C.
Instead, we try some values for a new weight a hoping to stumble
on the weights of a wps in which C embeds.  We start with a=4,
then try a=5.
<P>
<P>
<PRE>
&gt; HilbertNumerator(h,[1,1,4]);
-t^9 + t^5 - t^4 + 1
&gt; HilbertNumerator(h,[1,1,5]);
-t^10 + 1
</PRE>
The first answer made little sense.  Having included a generator 
in degree 4 it demanded an equation of the same degree.  That is
certainly possible, but assuming the equation involves only the
weight 1 variables, it would factorise and the result would
not be a variety.  However, the final answer is just what we hope
for: it suggests that C is realised by a degree 10 curve
in PP(1, 1, 5), which makes perfect sense and is what we expected.
<P>
Now consider the modified Hilbert series of the second example
of Section <A  HREF = "text1390.htm#15555">Hilbert Series and Graded  Rings</A> in which we changed the early
coefficients from V=[1, 2, 3, 4] to [1, 1, 2, 4], but kept the
Hilbert polynomial p.
<P>
<P>
<PRE>
&gt; h1 := HilbertSeries(p,[1,1,2,4]);
&gt; S ! h1;
1 + s + 2*s^2 + 4*s^3 + 5*s^4 + 7*s^5 + 9*s^6 + 11*s^7 + O(s^8)
&gt; HilbertNumerator(h1,[1,1,5]);
-t^10 + t^9 - t^8 - t^7 + t^6 - t^4 + t^3 + t^2 - t + 1
</PRE>
This implies that there is an equation in degree 1.  Such an
equation immediately eliminates one of the two degree 1
coordinates which would be daft, so we eliminate this
redundancy right at the beginning by trying instead
<P>
<P>
<PRE>
&gt; HilbertNumerator(h1,[1,5]);     
t^9 + t^7 + 2*t^6 + t^5 + t^4 + 2*t^3 + t^2 + 1
</PRE>
In short, this suggests a new variable in degree 2 and two
new variables in degree 3: this could be done methodically 
by considering one generator at a time.
<P>
<P>
<PRE>
&gt; HilbertNumerator(h1,[1,2,3,3,5]);     
-t^17 + t^12 + 2*t^11 - 2*t^6 - t^5 + 1
</PRE>
Now examining this Hilbert numerator, we see that the first equation 
is in degree 5.  But there is a variable of degree 5.  Although that
is not a problem, we could try to remove the degree 5 variable,
as we would, in practice, if we knew that it appeared linearly
in the equation.
<P>
<P>
<PRE>
&gt; HilbertNumerator(h1,[1,2,3,3]);
t^12 - 2*t^6 + 1
</PRE>
Finally, this suggests B<sub>6, 6</sub>&sub;PP(1, 2, 3, 3), and again it
is an easy exercise in wps to confirm that such a curve really does 
exist with the predicted properties.
<HR>
<H5><A NAME = "15563">FindFirstGenerators(g) : FldFunRatUElt -&gt; SeqEnum</A></H5>
<BLOCKQUOTE>
This intrinsic function returns a sequence containing the results
of a first attempt to deduce plausible weights of generators for 
the variety with Hilbert series g.  The method used proceeds by
advancing through the coefficients of g, in order of increasing 
degree, adding generators of that degree for each positive coefficient.  
The algorithm stops when it first finds a negative coefficient.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "15564">Example <TT>GrdRng_gr-grfirstgens (H123E2)</TT></A></H3>
We first make a Hilbert series which has initial terms 1 + 2t + 3t<sup>2</sup> + 4t<sup>3</sup>.
<P>
<P>
<PRE>
&gt; T&lt;t&gt; := PolynomialRing(Rationals());
&gt; p := 2*t - 3;
&gt; V := [ 1, 2, 3, 4 ];
&gt; h := HilbertSeries(p,V);
&gt; h;
(t^5 + 1)/(t^2 - 2*t + 1)
&gt; S&lt;s&gt; := PowerSeriesRing(Rationals(),4);
&gt; S ! h;
1 + 2*s + 3*s^2 + 4*s^3 + O(s^4)
</PRE>
This h is, in fact, the Hilbert series of a graded ring
generated by three elements in degrees 1,1,5.
<P>
<P>
<PRE>
&gt; FindFirstGenerators(h);
[ 1, 1, 5 ]
</PRE>
There is no guarantee that this intrinsic will always find
suitable weights, but it does return a subset of the weights
that must occur for any variety that realises the given
Hilbert series.
<HR>
<H5><A NAME = "15565">ApparentCodimension(f) : RngUPolElt -&gt; RngIntElt</A></H5>
<H5>ApparentEquationDegrees(f) : RngUPolElt -&gt; RngIntElt</H5>
<H5>ApparentSyzygyDegrees(f) : RngUPolElt -&gt; RngIntElt</H5>
<BLOCKQUOTE>
If f=f(t) is a polynomial of the form
<P>
f = 1 - &sum;<sub>i=1</sub><sup>N<sub>0</sub></sup> a<sub>0, i</sub> t<sup>i</sup> + &sum;<sub>k=N<sub>0</sub> + 1</sub><sup>N<sub>1</sub></sup> a<sub>1, i</sub> t<sup>i</sup>
      - ... + ( - 1)<sup>k - 1</sup> &sum;_(i=N<sub>k - 2</sub> + 1)<sup>N<sub>k - 1</sub></sup> a<sub>k - 1, i</sub> t<sup>i</sup> 
      + ( - 1)<sup>k</sup> t<sup>N<sub>k</sub></sup>
<P>
then the apparent codimension is k, the apparent equation degrees
are those i for which a<sub>0, i</sub> is nonzero (with a<sub>0, i</sub> equations
having that degree i) and the apparent syzygy degrees are those i for
which a<sub>1, i</sub> is nonzero.
</BLOCKQUOTE>
<PRE></PRE> <A  HREF = "text1391.htm">[Next]</A><A  HREF = "text1389.htm">[Prev]</A> <A  HREF = "text1391.htm">[Right]</A> <A  HREF = "text1389.htm">[Left]</A> <A  HREF = "text1388.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>