<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Elimination</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text1221.htm">[Next]</A><A  HREF = "text1219.htm">[Prev]</A> <A  HREF = "text1221.htm">[Right]</A> <A  HREF = "text1219.htm">[Left]</A> <A  HREF = "text1214.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "13592">Elimination</A></H3>

<P>
<P>
Elimination theory plays an important role when working with ideals
of multivariate polynomial rings.  Magma provides an assortment of
functions to perform various kinds of elimination easily. Elimination
of variables is accomplished by computing a Gr&ouml;bner basis with
respect to a suitable elimination order (for more information about
elimination orders, see Section <A  HREF = "text1205.htm#13440">Representation and Monomial  Orders</A> as well
as comments in the function descriptions below).
<P>
All of the functions in this section may be applied to ideals over general
Euclidean rings, not just over fields.



<H5>Subsections</H5>
<UL>
<LI> <A  HREF = "text1220.htm#13593">Construction of Elimination Ideals</A>
<LI> <A  HREF = "text1220.htm#13597">Univariate Elimination Ideal Generators</A>
<LI> <A  HREF = "text1220.htm#13602">Relation Ideals</A>
</UL>
<H4><A NAME = "13593">Construction of Elimination Ideals</A></H4>



<H5><A NAME = "13594">EliminationIdeal(I, k: parameters) : RngMPol, RngIntElt -&gt; RngMPol</A></H5>
<BLOCKQUOTE>
Given an ideal I of a polynomial ring P of rank n with
P = R[x<sub>1</sub>, ..., x<sub>n</sub>], together with an
integer k with 0 &le;k &le;n, return the k-th elimination ideal
I<sub>k</sub> of I, which is defined to be I &cap;R[x<sub>k + 1</sub>, ..., x<sub>n</sub>].
Thus I<sub>k</sub> consists of all polynomials of I which have the first k
variables eliminated.  If the elimination ideals I<sub>k</sub> are to be computed
for several different k, it is recommended first that a Gr&ouml;bner basis
with respect to lexicographical order for I first be computed as then
the elimination ideals can be determined trivially.  If I does not
have a Gr&ouml;bner basis stored with respect to lexicographical order, then
a Gr&ouml;bner basis computation will be necessary each time an elimination
ideal is desired.
<P>
If k=n, then I &cap;R is returned, which, if R is a field,
is always the full ring P or the empty ideal, according to
whether I is the full polynomial ring or not.
But if R is not a field, then this intersection will
yield the ideal generated by the normalized smallest element of R which
is in I (according to the Euclidean norm), which could be neither 0 nor 1.
<P>
The parameters are as for the <A  HREF = "text1207.htm#GB:Groebner">Groebner</A> procedure.
Note that setting <TT>Al := "Direct"</TT> occasionally produces much better
performance since the relevant elimination order may yield a better
Gr&ouml;bner basis than the default method of going via the <TT>grevlex</TT>
order.
</BLOCKQUOTE>
<H5><A NAME = "13595">EliminationIdeal(I, S) : RngMPol, { RngIntElt } -&gt; RngMPol</A></H5>
<H5>EliminationIdeal(I, S) : RngMPol, { RngMPolElt } -&gt; RngMPol</H5>
<BLOCKQUOTE>
Given an ideal I of a polynomial ring P of rank n with
P = R[x<sub>1</sub>, ..., x<sub>n</sub>], together with a set S describing
a subset U of the variables { x<sub>1</sub>, ... x<sub>n</sub> },
return the elimination ideal I<sub>U</sub> of I, which is defined to be
I &cap;R[U].
Thus I<sub>U</sub> consists of all polynomials of I which contain variables
only found in U.  U can be specified in two ways: either as a set
S of integers in the range 1 ... n such the integer i corresponds
to the i-th variable x<sub>i</sub>, or as a set S of variables lying in P.
S may be the empty set, in which case this is equivalent to
<TT>EliminationIdeal(I, n)</TT>; see above.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "13596">Example <TT>Ideal_QuadraticOrderElim (H112E5)</TT></A></H3>
This example continues the example above which computed a
Gr&ouml;bner basis over a ring which was not even a PIR.
<P>
<P>
<P>
As before, R = Z[Sqrt( - 5)] and I is the ideal of R[x, y] generated
by f<sub>1</sub> = 2xy + Sqrt( - 5)y and f<sub>2</sub> = (1 + Sqrt( - 5))x<sup>2</sup> - xy.
As before, we compute over Z, introduce a new variable S and
include (S<sup>2</sup> + 5) in I, so we can effectively work over R.
<P>
<P>
<PRE>
&gt; P&lt;x, y, S&gt; := PolynomialRing(IntegerRing(), 3);
&gt; f1 := 2*x*y + S*y;          
&gt; f2 := (1 + S)*x^2 - x*y;
&gt; I := ideal&lt;P | f1, f2, S^2 + 5&gt;;
&gt; GroebnerBasis(I);
[
    x^2*S + x^2 + 5*y^3 + 13*y*S - 25*y,
    6*x^2 + 5*y^2 + 3*y*S - 10*y,
    x*y + 5*y^3 + 13*y*S - 25*y,
    y^2*S + 5*y^2 - 15*y,
    10*y^2 + 5*y*S - 25*y,
    S^2 + 5
]
</PRE>
In <A  HREF = "text1213.htm#bib_AdamsLoustaunau">[AL94, Ex. 4.3.8]</A>, the elimination ideal
E<sub>y</sub> = I &cap;(Z[Sqrt( - 5))[y] is shown to be generated by
f<sub>5</sub> = (5 + Sqrt( - 5))y<sup>2</sup> - 15y and
f<sub>7</sub> = - 2Sqrt( - 5)y<sup>2</sup> + 5(1 + Sqrt( - 5))y.
We can compute E<sub>y</sub> in Magma easily using <TT>EliminationIdeal</TT>.
We must be careful to include S in the second argument (the set of variables
which we want), since S should be considered a `constant' (member of R)
in this context.
<P>
<P>
<PRE>
&gt; Ey := EliminationIdeal(I, {y, S});
&gt; GroebnerBasis(Ey);
[
    y^2*S + 5*y^2 - 15*y,
    10*y^2 + 5*y*S - 25*y,
    S^2 + 5
]
</PRE>
Obviously, the polynomials yielded are simply the last 3
polynomials of the full Gr&ouml;bner basis given above.  We check also
that the ideal generated by f<sub>5</sub> and f<sub>7</sub> over R is the same as
that given by Magma.
<P>
<P>
<PRE>
&gt; f_5 := y^2*S + 5*y^2 - 15*y;
&gt; f_7 := -2*y^2*S + 5*y*S + 5*y;
&gt; E := ideal&lt;P | f_5, f_7, S^2 + 5&gt;;
&gt; E eq Ey;
true
</PRE>
Finally, we also compute E<sub>x</sub> = I &cap;(Z[Sqrt( - 5))[x], which requires
more effort this time, since it cannot be read off the Gr&ouml;bner basis.
<P>
<P>
<PRE>
&gt; Ex := EliminationIdeal(I, {x, S});
&gt; GroebnerBasis(Ex);                          
[
    2*x^3*S + 2*x^3 + x^2*S - 5*x^2,
    12*x^3 + 6*x^2*S,
    S^2 + 5
]
</PRE>
From this, we see that E<sub>x</sub> is generated by
(2 + 2Sqrt( - 5))x<sup>3</sup> + ( - 5 + Sqrt( - 5))x<sup>2</sup> and
12x<sup>3</sup> + 6Sqrt( - 5)x<sup>2</sup>.
<HR>
<H4><A NAME = "13597">Univariate Elimination Ideal Generators</A></H4>



<H5><A NAME = "13598">UnivariateEliminationIdealGenerator(I, i) : RngMPol, RngIntElt -&gt; RngMPolElt</A></H5>
<BLOCKQUOTE>
Given a zero-dimensional ideal I of a polynomial ring P of rank n
with P = K[x<sub>1</sub>, ..., x<sub>n</sub>], together with an
integer i with 1 &le;i &le;n, return the unique monic generator
of the univariate elimination ideal I &cap;K[x<sub>i</sub>].
</BLOCKQUOTE>
<H5><A NAME = "13599">UnivariateEliminationIdealGenerators(I) : RngMPol -&gt; [ RngMPolElt ]</A></H5>
<BLOCKQUOTE>
Given a zero-dimensional ideal I of a polynomial ring P of rank n
with P = K[x<sub>1</sub>, ..., x<sub>n</sub>], return the sequence of length n whose
i-th element is the unique monic generator
of the univariate elimination ideal I &cap;K[x<sub>i</sub>].
</BLOCKQUOTE>
<HR>
<H3><A NAME = "13600">Example <TT>Ideal_EliminationIdeal (H112E6)</TT></A></H3>
We construct an ideal I (derived from Neural networks theory) of the
polynomial ring Q[x, y, z], and then find various elimination ideals of I.
<P>
<P>
<PRE>
&gt; P&lt;x, y, z&gt; := PolynomialRing(RationalField(), 3);
&gt; I := ideal&lt;P |
&gt;     1 - x + x*y^2 - x*z^2,
&gt;     1 - y + y*x^2 + y*z^2,
&gt;     1 - z - z*x^2 + z*y^2 &gt;;
&gt; UnivariateEliminationIdealGenerator(I, 1);
x^21 - x^20 - 2*x^19 + 4*x^18 - 5/2*x^17 - 5/2*x^16 + 4*x^15 - 15/2*x^14 + 
    129/16*x^13 + 11/16*x^12 - 103/8*x^11 + 131/8*x^10 - 49/16*x^9 -
    171/16*x^8 + 12*x^7 - 3*x^6 - 29/8*x^5 + 15/4*x^4 - 17/16*x^3 - 5/16*x^2
    + 5/16*x - 1/16
&gt; UnivariateEliminationIdealGenerator(I, 2);     
y^14 - y^13 - 13/2*y^12 + 8*y^11 + 53/4*y^10 - 97/4*y^9 - 45/8*y^8 + 33*y^7 - 
    25/2*y^6 - 18*y^5 + 107/8*y^4 + 5/8*y^3 - 27/8*y^2 + 9/8*y - 1/8
&gt; E :=  EliminationIdeal(I, {y, z});
&gt; E;
Ideal of Polynomial ring of rank 3 over Rational Field
Order: Lexicographical
Variables: x, y, z
Basis:
[
    z^21 - z^20 - 2*z^19 + 4*z^18 - 5/2*z^17 - 5/2*z^16 + 4*z^15 - 15/2*z^14 + 
        129/16*z^13 + 11/16*z^12 - 103/8*z^11 + 131/8*z^10 - 49/16*z^9 - 
        171/16*z^8 + 12*z^7 - 3*z^6 - 29/8*z^5 + 15/4*z^4 - 17/16*z^3 - 5/16*z^2
        + 5/16*z - 1/16,
    y + 141944208/7806653*z^20 - 42803108/7806653*z^19 - 290535348/7806653*z^18 
        + 309392460/7806653*z^17 - 164881460/7806653*z^16 - 
        331099258/7806653*z^15 + 203830442/7806653*z^14 - 894960798/7806653*z^13
        + 622205873/7806653*z^12 + 1352184655/31226612*z^11 - 
        4746138097/31226612*z^10 + 5122044359/31226612*z^9 + 
        991547639/31226612*z^8 - 830598655/7806653*z^7 + 1472712995/15613306*z^6
        - 59983627/15613306*z^5 - 486698319/15613306*z^4 + 174173263/7806653*z^3
        - 30672252/7806653*z^2 - 735083/664396*z + 30093391/31226612
]
</PRE>
<HR>
<H3><A NAME = "13601">Example <TT>Ideal_ZRadical (H112E7)</TT></A></H3>
We write a simple function ZRadical to compute the radical of a zero
dimensional ideal defined over a field using the univariate elimination
ideal generators.
See <A  HREF = "text1213.htm#bib_BeckerWeispfenning">[BW93, p. 345]</A>.
<P>
<P>
<PRE>
&gt; function ZRadical(I)
&gt;     // Find radical of zero dimensional ideal I
&gt;     P := Generic(I);
&gt;     n := Rank(P);
&gt;     G := UnivariateEliminationIdealGenerators(I);
&gt;     N := ;
&gt; 
&gt;     for i := 1 to n do
&gt;         // Set FF to square-free part of the i-th univariate
&gt;         // elimination ideal generator
&gt;         F := G[i];
&gt;         FF := F;
&gt;         while true do
&gt;             D := GCD(FF, Derivative(FF, 1, i));
&gt;             if D eq 1 then
&gt;                 break;
&gt;             end if;
&gt;             FF := FF div D;
&gt;         end while;
&gt;         // Include FF in N if FF is a proper divisor of F
&gt;         if FF ne F then
&gt;             Include(~N, FF);
&gt;         end if;
&gt;     end for;
&gt; 
&gt;     // Return the sum of I and N
&gt;     if #N eq 0 then
&gt;       return I;
&gt;     else
&gt;       return ideal&lt;P | I, N&gt;;
&gt;     end if;
&gt; end function;
</PRE>
We now apply ZRadical to an ideal of Q[x, y, z].
<P>
<P>
<PRE>
&gt; P&lt;x, y, z&gt; := PolynomialRing(RationalField(), 3);
&gt; I := ideal&lt;P | (x+1)^3*y^4, x*(y-z)^2+1, z^3-z^2&gt;;
&gt; R := ZRadical(I);     
&gt; Groebner(I);
&gt; Groebner(R);
&gt; I;
Ideal of Polynomial ring of rank 3 over Rational Field
Order: Lexicographical
Variables: x, y, z
Inhomogeneous, Dimension 0, Non-radical
Groebner basis:
[
    x - 4*y^9 + 21*y^8 - 32*y^7 + 7*y^6 + 432*y^5*z^2 - 546*y^5*z + 120*y^5 - 
        137*y^4*z^2 + 288*y^4*z - 146*y^4 - 956*y^3*z^2 + 1088*y^3*z - 128*y^3 +
        393*y^2*z^2 - 576*y^2*z + 186*y^2 + 498*y*z^2 - 540*y*z + 44*y - 220*z^2
        + 288*z - 67,
    y^10 - 6*y^9 + 12*y^8 - 8*y^7 + 288*y^5*z^2 - 348*y^5*z + 60*y^5 - 
        110*y^4*z^2 + 192*y^4*z - 82*y^4 - 624*y^3*z^2 + 696*y^3*z - 72*y^3 + 
        273*y^2*z^2 - 384*y^2*z + 111*y^2 + 322*y*z^2 - 348*y*z + 26*y - 150*z^2
        + 192*z - 42,
    y^6*z - y^6 - 6*y^5*z^2 + 6*y^5*z - 3*y^4*z + 3*y^4 + 12*y^3*z^2 - 12*y^3*z 
        + 3*y^2*z - 3*y^2 - 6*y*z^2 + 6*y*z - z + 1,
    z^3 - z^2

&gt; R;
Ideal of Polynomial ring of rank 3 over Rational Field
Order: Lexicographical
Variables: x, y, z
Inhomogeneous, Dimension 0, Radical
Groebner basis:
[
    x + 1,
    y^2 - 2*y*z + z - 1,
    z^2 - z
]
&gt; I subset R;
true
&gt; R subset I;
false
&gt; IsInRadical(x + 1, I);
true
</PRE>
<HR>
<H4><A NAME = "13602">Relation Ideals</A></H4>



<H5><A NAME = "13603"></A><A NAME = "dpoly_ideal:RelationIdeal">RelationIdeal</A>(Q) : [ RngMPol ] -&gt; RngMPol</H5>
<H5>RelationIdeal(Q, T) : [ RngMPol ], RngMPol -&gt; RngMPol</H5>
<BLOCKQUOTE>
Given a sequence Q of k polynomials of a polynomial ring P
over a ring S (not necessarily a field),
return the relation ideal U of Q which is an ideal of the polynomial
ring of rank k over S containing all algebraic relations between the
elements of Q.  That is, U consists of all polynomials
r &isin;S[y<sub>1</sub>, ..., y<sub>k</sub>] such that r(Q[1], ..., Q[k]) = 0.
If U is desired to be an ideal of a particular polynomial ring T
of rank k (to obtain predetermined names of variables, for example),
then T may be passed as a second argument.
<P>
The computation is the same as that for the image of an affine polynomial
map, which this basically is, thinking of the polynomials in Q as
giving a map from n-dimensional affine space (n = rank of
P) to k-dimensional affine space. k new variables y<sub>i</sub> and relations
y<sub>i</sub> - Q[i] are added and then the original variables x<sub>i</sub> of P are
eliminated in the usual way.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "13604">Example <TT>Ideal_RelationIdeal (H112E8)</TT></A></H3>
We construct an ideal I of the polynomial ring GF(2)[x, y, z], and
discover that the ideal is the full polynomial ring.  Suppose we then
wish to write 1&isin;I as an (algebraic) expression in terms of the original
generators.  We use <TT>RelationIdeal</TT> to find that expression.
<P>
<P>
<PRE>
&gt; P&lt;x, y, z&gt; := PolynomialRing(GF(2), 3, "grevlex");
&gt; S := [(x + y + z)^2, (x^2 + y^2 + z^2)^3 + x + y + z + 1];
&gt; I := ideal&lt;P | S&gt;;
&gt; Groebner(I);
&gt; I;
Ideal of Polynomial ring of rank 3 over GF(2)
Graded Reverse Lexicographical Order
Variables: x, y, z
Groebner basis:
[
    1
]
&gt; Q&lt;a, b&gt; := PolynomialRing(GF(2), 2);
&gt; U := RelationIdeal(S, Q);
&gt; U;
Ideal of Polynomial ring of rank 2 over GF(2)
Order: Lexicographical
Variables: a, b
Inhomogeneous, Dimension &gt;0
Basis:
[
    a^6 + a + b^2 + 1
]
</PRE>
Finally, we check the algebraic expression, evaluating it at the
original polynomials:
<P>
<P>
<PRE>
&gt; S[1]^6 + S[1] + S[2]^2;    
1
</PRE>
<HR>
<PRE></PRE> <A  HREF = "text1221.htm">[Next]</A><A  HREF = "text1219.htm">[Prev]</A> <A  HREF = "text1221.htm">[Right]</A> <A  HREF = "text1219.htm">[Left]</A> <A  HREF = "text1214.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>