<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>The Geometry of Toric Varieties</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text1412.htm">[Next]</A><A  HREF = "text1410.htm">[Prev]</A> <A  HREF = "text1412.htm">[Right]</A> <A  HREF = "text1410.htm">[Left]</A> <A  HREF = "text1403.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "15972">The Geometry of Toric Varieties</A></H3>




<H5>Subsections</H5>
<UL>
<LI> <A  HREF = "text1411.htm#15973">Resolution of Singularities and Linear Systems</A>
<LI> <A  HREF = "text1411.htm#15979">Mori Theory of Toric Varieties</A>
<LI> <A  HREF = "text1411.htm#15996">Decomposition of Toric Morphisms</A>
</UL>
<H4><A NAME = "15973">Resolution of Singularities and Linear Systems</A></H4>



<H5><A NAME = "15974">Resolution(X) : TorVar -&gt; TorVar,TorMap</A></H5>
<BLOCKQUOTE>
A resolution of singularities of the toric variety X
together with the natural morphism from the resolution to X.
The resolution is not necessarily minimal.
</BLOCKQUOTE>
<H5><A NAME = "15975">QFactorialisation(X) : TorVar -&gt; TorVar, TorMap</A></H5>
<BLOCKQUOTE>
A Q-factorialisation of X together with the natural morphism.
</BLOCKQUOTE>
<H5><A NAME = "15976">Terminalisation(X) : TorVar -&gt; TorVar, TorMap</A></H5>
<BLOCKQUOTE>
A Q-factorial terminal blowup of the toric variety X and the natural morphism.
</BLOCKQUOTE>
<H5><A NAME = "15977">Canonicalisation(X) : TorVar -&gt; TorVar, TorMap</A></H5>
<BLOCKQUOTE>
A Q-factorial canonical blowup of the toric variety X and the natural morphism.
</BLOCKQUOTE>
<H5><A NAME = "15978">ResolveLinearSystem(D) : DivTorElt -&gt; TorVar</A></H5>
<BLOCKQUOTE>
The toric variety Y whose fan lives in the same lattice as the fan of
the toric variety X on which the divisor D is defined,
such that Y resolves the map given by the linear system of D.
</BLOCKQUOTE>
<H4><A NAME = "15979">Mori Theory of Toric Varieties</A></H4>



<H5><A NAME = "15980">MoriCone(X) : TorVar -&gt; TorCon</A></H5>
<BLOCKQUOTE>
The Mori Cone of toric variety X (as an abstract cone), that is,
the cone generated by numerical classes of torus invariant
curves on X.
</BLOCKQUOTE>
<H5><A NAME = "15981">NefCone(X) : TorVar -&gt; TorCon</A></H5>
<BLOCKQUOTE>
The nef Cone of toric variety X (as an abstract cone).
</BLOCKQUOTE>
<H5><A NAME = "15982">ExtremalRays(X) : TorVar -&gt; SeqEnum</A></H5>
<H5>ExtremalRayContractions(X) : TorVar,RngIntElt -&gt; SeqEnum</H5>
<BLOCKQUOTE>
The images of extremal contractions of rays in the nef-cone of
the toric variety X.
</BLOCKQUOTE>
<H5><A NAME = "15983">ExtremalRayContraction(X,i) : TorVar,RngIntElt -&gt; TorVar,TorMap</A></H5>
<BLOCKQUOTE>
The toric variety that is the image of the ith extremal contraction
of the toric variety X; the contraction morphism is returned
as a second value.
</BLOCKQUOTE>
<H5><A NAME = "15984">ExtremalRayContractionDivisor(X,i) : TorVar,RngIntElt -&gt; DivTorElt</A></H5>
<BLOCKQUOTE>
The toric divisor that gives the ith extremal contraction of
the toric variety X (that is, the divisor is the pullback
of an ample divisor on the image).
</BLOCKQUOTE>
<H5><A NAME = "15985">TypeOfContraction(X,i) : TorVar,RngIntElt -&gt; MonStgElt</A></H5>
<H5>TypesOfContractions(X) : TorVar -&gt; MonStgElt</H5>
<BLOCKQUOTE>
A string describing the ith extremal contraction of
the toric variety X (or all together in a sequence if i
is not specified).
</BLOCKQUOTE>
<H5><A NAME = "15986">IsDivisorialContraction(X,i) : TorVar,RngIntElt -&gt; BoolElt</A></H5>
<BLOCKQUOTE>
True iff the contraction of the ith extremal ray of the toric variety X is a divisorial contraction.
</BLOCKQUOTE>
<H5><A NAME = "15987">IsMoriFibreSpace(X,i) : TorVar,RngIntElt -&gt; BoolElt</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if and only if the ith extremal ray of the toric variety X
gives an extremal contraction to a variety of lower dimension than X.
</BLOCKQUOTE>
<H5><A NAME = "15988">IsFlipping(X,i) : TorVar,RngIntElt -&gt; BoolElt</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if and only if the ith extremal ray of the toric variety X
gives a small contraction of X; in this case the intrinsic
<TT>Flip(X,i)</TT> provides the flipped toric variety.
</BLOCKQUOTE>
<H5><A NAME = "15989">Flip(X,i) : TorVar,RngIntElt -&gt; TorVar</A></H5>
<BLOCKQUOTE>
The flipped variety of the ith extremal contraction of the toric
variety X, assuming that this extremal contraction is of flipping type.
</BLOCKQUOTE>
<H5><A NAME = "15990">Flip(D) : DivTorElt -&gt; TorVar</A></H5>
<BLOCKQUOTE>
The (generalised) flip of the morphism given by the Q-Cartier divisor,
assuming that this morphism is small.
</BLOCKQUOTE>
<H5><A NAME = "15991">WeightsOfFlip(X,i) : TorVar,RngIntElt -&gt; SeqEnum</A></H5>
<BLOCKQUOTE>
The weights of a G<sub>m</sub> action whose variation would give the
flip of the ith extremal contraction of the toric variety X,
assuming that this extremal contraction is of flipping type.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "15992">Example <TT>Toric_toric-flipwts-example (H124E20)</TT></A></H3>
<P>
<P>
<PRE>
&gt; F0 := FanOfWPS([1,1,1,1]);
&gt; L3 := Ambient(F0);
&gt; F := Blowup(F0,L3 ! [2,-5,3]);
&gt; X := ToricVariety(Rationals(),F);
&gt; ExtremalRays(X);
[
    (0, -1),
    (1, 56)
]
&gt; TypeOfContraction(X,1);
divisorial (K.C&lt;0)
&gt; TypeOfContraction(X,2);
flip
&gt; WeightsOfFlip(X,2);
[
    [ 3, 2, -5, -1 ]
]
</PRE>
<HR>
<H3><A NAME = "15993">Example <TT>Toric_toric-weights-of-flip-example (H124E21)</TT></A></H3>
We build a (nonsingular) variety X that is the projectivisation of
the direct sum of line bundles (O)(0, 0, 0, 1, 1, 1, 1, 2) on
the projective line P<sup>1</sup>.
<P>
<P>
<PRE>
&gt; X&lt;[x]&gt; := RationalScroll(Rationals(),1,[0,0,0,1,1,1,1,2]);
&gt; X;
Toric variety of dimension 8
Variables: x[1], x[2], x[3], x[4], x[5], x[6], x[7], x[8], x[9], x[10]
The components of the irrelevant ideal are:
    (x[10], x[9], x[8], x[7], x[6], x[5], x[4], x[3]), (x[2], x[1])
The 2 gradings are:
    1,  1,  0,  0,  0, -1, -1, -1, -1, -2,
    0,  0,  1,  1,  1,  1,  1,  1,  1,  1
</PRE>
We compute its nef cone simply to initiate all its
Mori theoretic data.
<P>
<P>
<PRE>
&gt; _ := NefCone(X);
</PRE>
We can consider various extreme rays of the Mori cone of X.
(Our choice of parameters mean we consider rays [C] for
which DC&le;0, where D is the zero divisor: that is, we
consider all rays.)
<P>
<P>
<PRE>
&gt; IsFlipping(X,1: divisor:=ZeroDivisor(X), inequality:="weak");
false
&gt; IsFlipping(X,2: divisor:=ZeroDivisor(X), inequality:="weak");
true
</PRE>
One of the rays corresponds to the fibration of X onto P<sup>1</sup>.
The other is a ray of (anti-)flipping type.
We can make the antiflip.
<P>
<P>
<PRE>
&gt; Y&lt;[y]&gt; := Flip(X,2: divisor:=ZeroDivisor(X), inequality:="weak");
&gt; Y;
Toric variety of dimension 8
Variables: y[1], y[2], y[3], y[4], y[5], y[6], y[7], y[8], y[9], y[10]
The components of the irrelevant ideal are:
    (y[10], y[9], y[8], y[7], y[6]), (y[5], y[4], y[3], y[2], y[1])
The 2 gradings are:
    0, 0, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 2, 2, 2, 1, 1, 1, 1, 0
&gt; IsNonsingular(Y);
false
&gt; IsTerminal(Y);
true
</PRE>
This antiflip can be regarded as coming from a change in the
linearisation of a geometric invariant theory quotient: from
a linearisation like (1, 1) (between variables 2 and 3 in the
given order) to one like (2, 3) (between variables 5 and 6).
To understand the antiflip better, sometimes it helps
to consider its weights (the relation between vertices on
the star of the flipping locus, or, in geometric invariant
theory terms, the weights of the local G<sub>m</sub> action that
determine the flip).
<P>
<P>
<PRE>
&gt; WeightsOfFlip(X,2: divisor:=ZeroDivisor(X), inequality:="weak");
[
    [ 1, 1, 0, 0, 0, -1, -1, -1, -1, -2 ],
    [ 0, 0, 1, 1, 1, 1, 1, 1, 1, 1 ]
]
</PRE>
Here we see that a P<sup>1</sup> has been antiflipped in favour of a
weighted P<sup>4</sup>(1, 1, 1, 1, 2), which is the source of the singularity on Y.
<HR>
<H5><A NAME = "15994">MMP(X) : TorVar -&gt; SeqEnum,SeqEnum</A></H5>

<PRE>    type: MonStgElt                     Default: "terminal"</PRE>
<BLOCKQUOTE>
A sequence of toric varieties that are all the varieties
visited by making any sequence of extremal contractions
from the toric variety X (and, if necessary, making the
corresponding flip). A second sequence records the
maps, in each case first by a sequence of the indices of
the domain and codomain, and second by a string that describes
the map.
<P>
The parameter <TT>type</TT> indicates which extremal rays
are considered. It can be <TT>terminal</TT>, <TT>canonical</TT>
or <TT>all</TT>. In each case, only toric varieties having
these singularities will be allowed as images of the maps.
(In particular, if the default value <TT>terminal</TT> is chosen,
then only true K<sub>X</sub>-negative extremal contractions will
be followed.)
</BLOCKQUOTE>
<HR>
<H3><A NAME = "15995">Example <TT>Toric_toric-mmp-example1 (H124E22)</TT></A></H3>
First make a toric variety X, in this case some blowup of P<sup>3</sup>.
<P>
<P>
<PRE>
&gt; F := FanOfWPS([1,1,1,1]);
&gt; G := Blowup(F, Ambient(F) ! [1,-1,1]);
&gt; X := ToricVariety(Rationals(),G);
</PRE>
We compute all minimal model programs from X. There are two
outputs: first a sequence containing those toric varieties
encountered during these processes, and second a sequence
containing all the maps encountered.
<P>
<P>
<PRE>
&gt; models,mmp := MMP(X);
&gt; #models;
3
&gt; mmp;
[ [*
    [ 1, 2 ],
    divisorial (K.C&lt;0)
*], [*
    [ 2, 3 ],
    map to point
*] ]
</PRE>
In this case there are three varieties. We could check that
they are: (1) X itself, (2) P<sup>3</sup>, and (3) a point.
We also see two maps: the first, labelled [1, 2], is
the contraction of X back down to P<sup>3</sup>, and the
second is the extremal contraction of P<sup>3</sup> to a point.
<P>
The intrinsic call <TT>MMP(X)</TT> has a parameter, and the
default is to search only for true absolute minimal model programs:
those which proceed only by contracting extremal rays that are
negative against the canonical class (and flipping them if
necessary).
To allow contractions of other extremal rays (and the possibility
of requiring antiflips), we can set the parameter to
<TT>type:="all"</TT>.
<P>
<P>
<PRE>
&gt; models,mmp := MMP(X : type:="all");
&gt; models;
[
    Toric variety of dimension 3
    Variables: $.1, $.2, $.3, $.4, $.5
    The components of the irrelevant ideal are:
        ($.5, $.4), ($.3, $.2, $.1)
    The 2 gradings are:
        1, 0, 0, 2, 1,
        1, 1, 1, 1, 0,
    Toric variety of dimension 3
    Variables: $.1, $.2, $.3, $.4
    The irrelevant ideal is:
        ($.4, $.3, $.2, $.1)
    The grading is:
        1, 1, 1, 1,
    Toric variety of dimension 3
    Variables: $.1, $.2, $.3, $.4, $.5
    The components of the irrelevant ideal are:
        ($.3, $.2), ($.5, $.4, $.1)
    The 2 gradings are:
        1, 0, 0, 2, 1,
        1, 1, 1, 1, 0,
    Toric variety of dimension 0,
    Toric variety of dimension 1
    Variables: $.1, $.2
    The irrelevant ideal is:
        ($.2, $.1)
    The grading is:
        1, 1
]
&gt; mmp;
[ [*
    [ 1, 2 ],
    divisorial (K.C&lt;0)
*], [*
    [ 1, 3 ],
    flop
*], [*
    [ 2, 4 ],
    map to point
*], [*
    [ 3, 1 ],
    flop
*], [*
    [ 3, 5 ],
    fibration (K.C&lt;0)
*] ]
</PRE>
Now we also see a flop from X to a new toric variety Y
(model number 3), and then Y admits Mori fibration to P<sup>1</sup>
(which we could check is model number 5).
<HR>
<H4><A NAME = "15996">Decomposition of Toric Morphisms</A></H4>

<P>
<P>
The title of this section is that of a well-known paper of Reid <A  HREF = "text1402.htm#bib_MR717617">[Rei83]</A>.
It applies Mori theory to toric varieties relatively over a base
to compute a relative minimal model and the relative canonical
model of a toric variety.
Rather than wrap this up in intrinsics, we show how to apply
the various components of this package to realise Reid's result.


<HR>
<H3><A NAME = "15997">Example <TT>Toric_toric-decomposition-example (H124E23)</TT></A></H3>
We will compute a relative minimal model and a relative canonical
model of the weighted projective space P<sup>3</sup>(1, 2, 5, 6), a 3-fold
that does not have canonical (nor terminal) singularities.
<P>
<P>
<PRE>
&gt; A := ProjectiveSpace(Rationals(),[1,2,5,6]);
&gt; IsCanonical(A);
false
</PRE>
We find the relative models by running a minimal model program
on a resolution of A relative to A itself (that is, we
only allow morphisms V -&gt; W if they factor the
given morphism V -&gt; A).
So we start by constructing a resolution.
<P>
<P>
<PRE>
&gt; V0,f0 := Resolution(A);
&gt; V0;
Toric variety of dimension 3
Variables: $.1, $.2, $.3, $.4, $.5, $.6, $.7, $.8, $.9, $.10, $.11, $.12
The irrelevant ideal is:
   [... omitted... ]
The 9 gradings are:
    0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0,
    0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0,
    0, 0, 1, 2, 0, 0, 0, 1, 0, 0, 0, 0,
    0, 0, 2, 3, 0, 0, 0, 0, 0, 1, 0, 0,
    0, 1, 2, 3, 0, 0, 1, 0, 0, 0, 0, 0,
    0, 1, 3, 3, 0, 0, 0, 0, 0, 0, 0, 1,
    0, 1, 3, 4, 1, 0, 0, 0, 0, 0, 0, 0,
    0, 1, 4, 5, 0, 1, 0, 0, 0, 0, 0, 0,
    1, 2, 5, 6, 0, 0, 0, 0, 0, 0, 0, 0
</PRE>
We see that the resolution made 8=9 - 1 blowups.
To compute everything, we would keep track of the morphisms
(as we have started with f<sub>0</sub> above); for brevity, we forego that.
<P>
We build a function which detects which of the extremal contractions
from a given V (starting with V<sub>0</sub>) that factor V -&gt; A.
This code also reports whether the contraction is divisorial
or of flipping type so that we can make the next step accordingly.
<P>
<P>
<PRE>
&gt; raysOverA := func&lt; W |
&gt;     [ &lt;i,TypeOfContraction(W,i)&gt; :
&gt;              i in [1..#ExtremalRays(W)] |
&gt;     IsRegular(ToricVarietyMap(ExtremalRayContraction(W,i),A)) ] &gt;;
</PRE>
And so we look for extremal rays over A that we can contract.
<P>
<P>
<PRE>
&gt; raysOverA(V0);
[ &lt;1, "divisorial (K.C&lt;0)"&gt;, &lt;2, "divisorial (K.C&lt;0)"&gt;,
&lt;3, "divisorial (K.C&lt;0)"&gt; ]
</PRE>
In other words, the extremal rays 1, 2 and 3 all determine
extremal divisorial contractions. (If we were writing a faster routine,
we would probably stop as soon as we'd found that ray 1 worked.)
We can pick any of these: we choose ray 1 and repeat the process.
<P>
<P>
<PRE>
&gt; V1 := ExtremalRayContraction(V0,1);
&gt; raysOverA(V1);
[ &lt;1, "divisorial (K.C&lt;0)"&gt;, &lt;2, "divisorial (K.C&lt;0)"&gt;, &lt;4, "divisorial
(K.C&lt;0)"&gt; ]
</PRE>
This time rays 1, 2, and 4 work; again these lead to divisorial
contractions. We follow ray 1.
<P>
<P>
<PRE>
&gt; V2 := ExtremalRayContraction(V1,1);
&gt; raysOverA(V2);
[ &lt;2, "divisorial (K.C&lt;0)"&gt;, &lt;3, "divisorial (K.C&lt;0)"&gt; ]
&gt; V3 := ExtremalRayContraction(V2,2);
&gt; raysOverA(V3);
[ &lt;2, "divisorial (K.C&lt;0)"&gt; ]
&gt; V4 := ExtremalRayContraction(V3,2);
&gt; raysOverA(V4);
[ &lt;2, "divisorial (K.C&lt;0)"&gt; ]
&gt; V5&lt;[w]&gt; := ExtremalRayContraction(V4,2);
&gt; assert #raysOverA(V5) eq 0;
</PRE>
There are no extremal rays over A to contract.
We have reached a relatively minimal model, V<sub>5</sub>; we check
its singularities, although there is no need.
<P>
<P>
<PRE>
&gt; V5;
Toric variety of dimension 3
Variables: w[1], w[2], w[3], w[4], w[5], w[6]
The components of the irrelevant ideal are:
    (w[6], w[5]), (w[6], w[3]), (w[5], w[4], w[2]), (w[3], w[1]), (w[4], w[2],
        w[1])
The 3 gradings are:
    0, 0, 1, 1, 0, 1,
    0, 1, 2, 3, 1, 0,
    1, 2, 5, 6, 0, 0
&gt; IsTerminal(V5);
true
</PRE>
To continue on to a relatively canonical model we must consider
rays that are trivial against the canonical class, not negative
as we have so far. We need to modify the relative rays function;
we simply weaken the inequality used when evaluating against
the canonical class.
<P>
<P>
<PRE>
&gt; weakraysOverA := func&lt; W |
&gt;     [ &lt;i,TypeOfContraction(W,i : inequality:="weak")&gt; :
&gt;                  i in [1..#ExtremalRays(W:inequality:="weak")] |
&gt;  IsRegular(ToricVarietyMap(ExtremalRayContraction(W,i:inequality:="weak"),A))]&gt;;
</PRE>
And so we continue.
<P>
<P>
<PRE>
&gt; weakraysOverA(V5);
[ &lt;2, "divisorial (K.C=0)"&gt; ]
&gt; V6&lt;[u]&gt; := ExtremalRayContraction(V5,2 : inequality:="weak");
&gt; assert #weakraysOverA(V6) eq 0;
</PRE>
After one canonically-trivial divisorial contraction there
are no rays left to contract.
We have reached the relative canonical model.
<P>
<P>
<PRE>
&gt; V6;
Toric variety of dimension 3
Variables: u[1], u[2], u[3], u[4], u[5]
The components of the irrelevant ideal are:
    (u[5], u[3]), (u[4], u[2], u[1])
The 2 gradings are:
    0, 0, 1, 1, 1,
    1, 2, 5, 6, 0
&gt; IsTerminal(V6);
false
&gt; IsCanonical(V6);
true
</PRE>
Of course, in this toric setting, it would have been simpler
to find the single short vector in the fan of A that was
causing all the trouble and blow that up.
<HR>
<PRE></PRE> <A  HREF = "text1412.htm">[Next]</A><A  HREF = "text1410.htm">[Prev]</A> <A  HREF = "text1412.htm">[Right]</A> <A  HREF = "text1410.htm">[Left]</A> <A  HREF = "text1403.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>