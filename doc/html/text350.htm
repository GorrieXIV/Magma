<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Class Groups</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text351.htm">[Next]</A><A  HREF = "text349.htm">[Prev]</A> <A  HREF = "text351.htm">[Right]</A> <A  HREF = "text349.htm">[Left]</A> <A  HREF = "text344.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "3346">Class Groups</A></H3>

<P>
<P>
In Magma, the class group of binary quadratic forms of discriminant D 
is defined by the equivalence relation 
<TT>IsEquivalent(f1, f2 : Narrow := false)</TT> for forms <TT>f1, f2</TT>.  
It is the same as the ideal class group (<TT>PicardGroup</TT>) of the 
quadratic order of discriminant D.  The class group of binary forms 
for D &gt; 0 is usually defined using standard ("narrow") equivalence 
of forms, which agrees with the narrow ideal class group of the order.
For D &lt; 0, there is no difference.  For D &gt; 0, the two class groups 
differ if and only if all units in the quadratic order have norm 1.
When they are different, each class is the union of two narrow classes:
forms &lt; a, b, c &gt; and &lt; - a, b, - c &gt; are 
equivalent but not narrowly equivalent.


<H5><A NAME = "3347">ClassNumber(Q: parameters) : QuadBin -&gt; RngIntElt</A></H5>
<H5>ClassNumber(D: parameters) : RngIntElt -&gt; RngIntElt</H5>

<PRE>    Al: MonStgElt                       Default: "Automatic"</PRE>

<PRE>    FactorBasisBound: FldReElt          Default: 0.1</PRE>

<PRE>    ProofBound: FldReElt                Default: 6</PRE>

<PRE>    ExtraRelations: RngIntElt           Default: 1</PRE>
<BLOCKQUOTE>
This returns the class number of binary quadratic forms Q of discriminant D.  
<P>
The parameter <TT>Al</TT> may be supplied to select the method used to 
calculate the class number.  The possible values are <TT>"ReducedForms"</TT> 
(enumerating all reduced forms), <TT>"Shanks"</TT> (using a Shanks-based
algorithm in the class group), <TT>"Sieve"</TT> or <TT>"NoSieve"</TT>. 
The default is to use reduced form 
enumeration for small discriminants, the Shanks algorithm for the middle 
range, a class group index-calculus for large discriminants and the sieve method
described in <A  HREF = "text343.htm#bib_jacobson">[Jac99]</A> for very large discriminants.
<P>
The parameters <TT>FactorBasis-Bound</TT>, <TT>ProofBound</TT> and 
<TT>ExtraRelations</TT> are relevant only for the index calculus algorithm.
They are described (below) under <A  HREF = "text350.htm#QuadBin:ClassGroup">ClassGroup</A>.
</BLOCKQUOTE>
<H5><A NAME = "3348"></A><A NAME = "QuadBin:ClassGroup">ClassGroup</A>(Q: parameters) : QuadBin -&gt; GrpAb, Map</H5>

<PRE>    Al: MonStgElt                       Default: "Automatic"</PRE>

<PRE>    FactorBasisBound: FldReElt          Default: 0.1</PRE>

<PRE>    ProofBound: FldReElt                Default: 6</PRE>

<PRE>    ExtraRelations: RngIntElt           Default: 1</PRE>
<BLOCKQUOTE>
This computes the class group of binary quadratic forms of discriminant D. 
The function returns the class group as an abelian group, together with
a map from the group to quadratic forms.  
<P>
<B>Important:</B> the class group is defined using non-strict equivalence
(see the introduction to this subsection).
<P>
Depending on the size of D, either a Shanks-based method is used
(<A  HREF = "text343.htm#bib_teske_prho">[Tes98]</A>, <A  HREF = "text343.htm#bib_teske_bsgs">[BJT97]</A>), an index calculus variant
(<A  HREF = "text343.htm#bib_cohdiol">[CDO93]</A>, <A  HREF = "text343.htm#bib_hafnerMcCurley">[HM89]</A>, <A  HREF = "text343.htm#bib_cohen1">[Coh93]</A>) or a sieving method 
(<A  HREF = "text343.htm#bib_jacobson">[Jac99]</A>). 
If the parameter <TT>Al</TT> is set to <TT>"Sieve"</TT> or D is larger 
than 10<sup>20</sup>, then the sieving method is used.
The results are only proven under GRH.  If the parameter <TT>Al</TT> 
is set to <TT>"NoSieve"</TT> then the sieving method will not be used.
<P>
The parameters
<TT>FactorBasisBound</TT>, <TT>ProofBound</TT> and <TT>ExtraRelations</TT>
apply to the index calculus method only.
This method performs two steps.  In the first step a factor basis
containing prime forms of norm &lt; B<sub>1</sub> is built.  Next, one looks
for generators for the full lattice of relations between the forms
in the factor basis. The determinant of this lattice will be
the class number and the Smith-form of the relation matrix gives the
structure of the class group.  Once the matrix is of full rank, the 
algorithm will look for <TT>ExtraRelations</TT> more relations to 
potentially decrease the discriminant.
In the second step, for all prime forms of norm &lt; B<sub>2</sub> it is verified
that they are in the class group generated by the forms of the first step.
The bounds are chosen to be B<sub>1</sub> :=  <TT>FactorBasisBound</TT>.log<sup>2</sup> |D| and B<sub>2</sub> := <TT>ProofBound</TT>.log<sup>2</sup> |D|, so the 
result is correct under the assumption of GRH.
The final result is then checked against the Euler product over the first 
30000 primes. If the quotient becomes too large, a warning is issued. 
In this case one should increase the <TT>ExtraRelations</TT> parameter.
</BLOCKQUOTE>
<H5><A NAME = "3349">ClassGroupStructure(Q: parameters) : QuadBin -&gt; [ RngIntElt ]</A></H5>
<BLOCKQUOTE>
The structure of the class group of the binary quadratic forms Q
of discriminant D returned as a sequence of integers giving the 
abelian invariants.
<P>
The parameters are the same as for <TT>ClassGroup</TT>.
</BLOCKQUOTE>
<H5><A NAME = "3350">AmbiguousForms(Q) : QuadBin -&gt; SeqEnum</A></H5>
<BLOCKQUOTE>
Enumerates the ambiguous forms of negative discriminant D, where D 
is the discriminant of the magma of binary quadratic forms Q.
</BLOCKQUOTE>
<H5><A NAME = "3351">TwoTorsionSubgroup(Q) : QuadBin -&gt; GrpAb, Map</A></H5>
<BLOCKQUOTE>
The subgroup of 2--torsion elements of in the class group of Q.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "3352">Example <TT>QuadBin_Forms (H34E1)</TT></A></H3>
We give an example of some computations in the class group of
a magma of quadratic forms. Elements in the class group are not really
represented by single reduced forms but by cycles of equivalent
reduced forms. 
<P>
<P>
<PRE>
&gt; Q&lt;z&gt; := QuadraticField(7537543);                        // arbitrary choice
&gt; Q := QuadraticForms(Discriminant(Q));
&gt; C, m := ClassGroup(Q);
&gt; C;
Abelian Group isomorphic to Z/2 + Z/76
Defined on 2 generators
Relations:
    76*C.1 = 0
    2*C.2 = 0
&gt;                                    // get the generators as quadratic forms:
&gt; f := m(C.1);
&gt; g := m(C.2);
&gt; h := g^2;
&gt; g, h;
&lt;-1038,4894,1493&gt; &lt;-887,4340,3189&gt;
&gt; c := [];                     // create the cycle of forms equivalent to g^2:
&gt; repeat 
&gt;     h := ReductionStep(h);
&gt;     Append(~c, h);
&gt; until h eq g^2;
&gt; P := Parent(g);
&gt; Identity(P) in c;
true                 // this proves that the second class has order dividing 2
&gt; for d in Divisors(76) do
&gt;     c := [];
&gt;     h := f^d;
&gt;     repeat h := ReductionStep(h); Append(~c, h);
&gt;     until h eq f^d;
&gt;     d, Identity(P) in c, #c;
&gt; end for;
1 false 16
2 false 14
4 false 12                           // the cycle lengths vary
19 false 18
38 false 16
76 true 14                           // so the true order of this class is 76
</PRE>
<HR>
<PRE></PRE> <A  HREF = "text351.htm">[Next]</A><A  HREF = "text349.htm">[Prev]</A> <A  HREF = "text351.htm">[Right]</A> <A  HREF = "text349.htm">[Left]</A> <A  HREF = "text344.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>