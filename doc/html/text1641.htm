<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Arithmetic of Abelian  Varieties</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text1642.htm">[Next]</A><A  HREF = "text1640.htm">[Prev]</A> <A  HREF = "text1642.htm">[Right]</A> <A  HREF = "text1640.htm">[Left]</A> <A  HREF = "text1635.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "18321">Arithmetic of Abelian  Varieties</A></H3>




<H5>Subsections</H5>
<UL>
<LI> <A  HREF = "text1641.htm#18322">Direct Sum</A>
<LI> <A  HREF = "text1641.htm#18327">Sum in an Ambient Variety</A>
<LI> <A  HREF = "text1641.htm#18333">Intersections</A>
<LI> <A  HREF = "text1641.htm#18339">Quotients</A>
</UL>
<H4><A NAME = "18322">Direct Sum</A></H4>

<P>
<P>
<P>
One can take arbitrary finite direct sums of modular abelian varieties.
We do not write <TT>A+B</TT> for the direct sum, since it is already used for
the sum of A and B inside a common ambient abelian variety, and this 
sum need not be direct, unless A&cap;B = 0.


<H5><A NAME = "18323">DirectSum(A, B) : ModAbVar, ModAbVar -&gt;  ModAbVar, List, List</A></H5>
<H5>DirectProduct(A, B) : ModAbVar, ModAbVar -&gt;  ModAbVar, List, List</H5>
<H5>A * B : ModAbVar, ModAbVar -&gt;  ModAbVar, List, List</H5>
<BLOCKQUOTE>
The direct sum D of abelian varieties 
A and B, together with the embedding maps 
from A into D and B into D, respectively, and the projection maps 
from D onto A and B, respectively.  
It is not possible to take the direct sum of abelian
varieties with different signs.
</BLOCKQUOTE>
<H5><A NAME = "18324">DirectSum(X) : [ModAbVar] -&gt;  ModAbVar, List, List</A></H5>
<H5>DirectProduct(X) : [ModAbVar] -&gt;  ModAbVar, List, List</H5>
<BLOCKQUOTE>
The direct sum D of the sequence X of modular abelian varieties, 
together with a list containing the embedding maps from each modular abelian 
variety of X into D and a list containing the projection maps from D 
onto each modular abelian variety in X.  
It is not possible to take the direct sum of abelian
varieties with different signs.
</BLOCKQUOTE>
<H5><A NAME = "18325">A ^ n : ModAbVar, RngIntElt -&gt;  ModAbVar</A></H5>
<BLOCKQUOTE>
The direct sum of n copies of the abelian variety 
A. If n=0, the zero subvariety of 
A. If n is negative, the ( - n)-th power of the dual of A.  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18326">Example <TT>ModAbVar_direct-sum (H142E79)</TT></A></H3>
Using the product operator we can take the direct product
of any two modular abelian varieties, even ones of different
weights or levels.  We first illustrate taking the product
of two abelian subvarieties of J<sub>0</sub>(65), then taking the
product of one of the subvarieties of J<sub>0</sub>(65) with
the weight 4 motive J<sub>1</sub>(11, 4).
<P>
<P>
<PRE>
&gt; J := JZero(65); 
&gt; D := Decomposition(J); D;
[
    Modular abelian variety 65A of dimension 1, level 5*13 and 
    conductor 5*13 over Q,
    Modular abelian variety 65B of dimension 2, level 5*13 and 
    conductor 5^2*13^2 over Q,
    Modular abelian variety 65C of dimension 2, level 5*13 and 
    conductor 5^2*13^2 over Q
]
&gt; A := D[1];
&gt; B := D[2];
&gt; A*B; 
Modular abelian variety 65A x 65B of dimension 3 and level 5*13 
over Q
Homomorphism from 65A to 65A x 65B given on integral homology by:
[1 0 0 0 0 0]
[0 1 0 0 0 0]
Homomorphism from 65B to 65A x 65B given on integral homology by:
[0 0 1 0 0 0]
[0 0 0 1 0 0]
[0 0 0 0 1 0]
[0 0 0 0 0 1]
Homomorphism from 65A x 65B to 65A (not printing 6x2 matrix)
Homomorphism from 65A x 65B to 65B (not printing 6x4 matrix)
&gt; M := JZero(11,4);M;
Modular motive JZero(11,4) of dimension 2 and level 11 over Q
&gt; P := A*M; P;
Modular motive 65A x JZero(11,4) of dimension 3 and level 5*11*13 over Q
</PRE>
The product also returns inclusions of each factor into the
product and projection from the product onto each factor.
<P>
<P>
<PRE>
&gt; C,f,g := A*B; 
&gt; f;
[*
Homomorphism from 65A to 65A x 65B given on integral homology by:
[1 0 0 0 0 0]
[0 1 0 0 0 0],
Homomorphism from 65B to 65A x 65B given on integral homology by:
[0 0 1 0 0 0]
[0 0 0 1 0 0]
[0 0 0 0 1 0]
[0 0 0 0 0 1]
*]
</PRE>
<P>
Here we compare direct sums of abelian varieties to the sum of
of abelian varieties in a common ambient abelian variety.
Thus if A is as above, then
<P>
<P>
<PRE>
&gt; Dimension(A);
1
&gt; Dimension(A*A);
2
&gt; Dimension(A+A);
1
</PRE>
<P>
If you take a direct sum of abelian varieties that are defined over
different base rings, then Magma will first attempt to
express them over a common over-ring.
<P>
<P>
<PRE>
&gt; A := JZero(11);
&gt; B := BaseExtend(JZero(14),CyclotomicField(3));
&gt; C := A*B; C;
Modular abelian variety JZero(11) x JZero(14) of dimension 2 and level 
2*7*11 over Q(zeta_3)
</PRE>
The above would not work if <TT>CyclotomicField(3)</TT>
were replaced by <TT>GF(3)</TT>, since the base ring Q 
of A is not contained in <TT>GF(3)</TT>.
<HR>
<H4><A NAME = "18327">Sum in an Ambient Variety</A></H4>

<P>
<P>
<P>
The sum <TT>A+B</TT> is the sum of A and B inside a common ambient
abelian variety. This sum need not be direct, unless the intersection
of A and B is 0.
<P>


<H5><A NAME = "18328">A + B : ModAbVar, ModAbVar -&gt;   ModAbVar</A></H5>
<BLOCKQUOTE>
The sum of the images of the abelian varieties
A and B in a common ambient abelian 
variety.  
</BLOCKQUOTE>
<H5><A NAME = "18329">SumOf(X) : [ModAbVar] -&gt;   ModAbVar</A></H5>
<BLOCKQUOTE>
The sum of the modular abelian varieties in the sequence X.  
</BLOCKQUOTE>
<H5><A NAME = "18330">SumOfImages(phi, psi) : MapModAbVar, MapModAbVar -&gt;  ModAbVar, MapModAbVar, List</A></H5>
<BLOCKQUOTE>
The sum D of the images of the morphisms &phi;  and &psi;  of abelian varieties in 
their common codomain, a morphism from D into their common codomain, and 
a list containing a morphism from the domain of each of &phi;  and 
&psi;  to D. If the codomains are not the same, then the homomorphisms are 
replaced by homomorphisms into an appropriate direct sum of codomains.  
</BLOCKQUOTE>
<H5><A NAME = "18331">SumOfMorphismImages(X) : List -&gt;  ModAbVar, MapModAbVar, List</A></H5>
<BLOCKQUOTE>
The sum D of the images of the morphisms of abelian varieties 
in the list X 
in their common codomain, a morphism 
from D into their common codomain, and a list containing a morphism from 
the domain of each morphism in X to D. If not all codomains of the 
elements of X are the same, then the homomorphisms are replaced by 
homomorphisms into an appropriate direct sum of codomains.  
</BLOCKQUOTE>
<H5><A NAME = "18332"></A><A NAME = "fce">FindCommonEmbeddings</A>(X) : [ModAbVar] -&gt;  BoolElt, List</H5>
<BLOCKQUOTE>
Return <TT>true</TT> and a list of embeddings into a common abelian variety, if one
can be found using <A  HREF = "text1637.htm#ModAbVar:embed">Embeddings</A><TT>(A)</TT> for all abelian varieties
A in the sequence X. 
</BLOCKQUOTE>
<H4><A NAME = "18333">Intersections</A></H4>

<P>
<P>
<P>
<P>
<P>
Two abelian varieties cannot, by themselves, by intersected without
choosing an embedding of both varieties in a common ambient abelian
variety. The algorithm for computing an intersection is to compute the
kernel of a certain homomorphism.
<P>
Intersections are computed in Magma by finding a homomorphism whose
kernel is isomorphic to the intersection.  For example, if f:A to C and
g:B to C are injective homomorphisms, then the intersection of
their images is isomorphic to the kernel of f - g.
<P>
As mentioned above, kernels of morphisms of abelian varieties are
frequently not themselves abelian varieties.  Instead a kernel is an
extension of an abelian variety by a finite group of components.
Likewise, intersections of abelian varieties are often not abelian
varieties.
<P>
The intersection commands also take a sequence of abelian varieties
or list of morphisms in order to facilitate computation of n-fold
intersections, for any positive integer n.  


<H5><A NAME = "18334">A meet B : ModAbVar, ModAbVar -&gt;  ModAbVarSubGrp, ModAbVar, MapModAbVar</A></H5>
<H5>Intersection(X) : [ModAbVar] -&gt;  ModAbVarSubGrp, ModAbVar, MapModAbVar</H5>
<BLOCKQUOTE>
Given abelian varieties A and B or a sequence X of abelian varieties,
compute a finite lift G of the component group of the intersection, the 
<I>connected</I> component of the intersection C, 
and a map from the abelian variety 
that contains C to the abelian variety that contains 
G. The relevant intersection is C + G. The elements of X are 
replaced by their images via their modular embedding map. All the elements of 
X must be embedded in the same abelian variety.  
</BLOCKQUOTE>
<H5><A NAME = "18335">IntersectionOfImages(X) : List -&gt;   ModAbVarSubGrp, ModAbVar, MapModAbVar</A></H5>
<BLOCKQUOTE>
Given a sequence X of morphisms from abelian varieties into a common abelian variety,
compute a finite lift G of the component group of the intersection, the 
<I>connected</I> component C of the intersection, and a map from the abelian variety 
that contains C to the abelian variety that contains 
G. 
The morphisms in X do not have to be injective.  
</BLOCKQUOTE>
<H5><A NAME = "18336">ComponentGroupOfIntersection(A, B) : ModAbVar, ModAbVar -&gt;  ModAbVarSubGrp</A></H5>
<H5>ComponentGroupOfIntersection(X) : [ModAbVar] -&gt;  ModAbVarSubGrp</H5>
<BLOCKQUOTE>
Given abelian varieties A and B or a sequence X of abelian varieties
compute the group 
of components of the intersection of A and B or the varieties in X.
(For more details, see the discussion of kernels in Section <A  HREF = "text1639.htm#18182">Kernels</A>).
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18337">Example <TT>ModAbVar_Arithabvar-Intersections (H142E80)</TT></A></H3>
The intersection of the three simple newform abelian subvarieties of
J<sub>0</sub>(65) is a group isomorphic to Z/2Z. 
<P>
<P>
<PRE>
&gt; D := Decomposition(JZero(65));
&gt; G := ComponentGroupOfIntersection(D); G;
Finitely generated subgroup of abelian variety with 
invariants [ 2 ]
&gt; FieldOfDefinition(G);
Rational Field
</PRE>
The quotient of D[1] by this subgroup of order 2
is an elliptic curve over Q isogenous to D[1],
but not isomorphic to D[1].
<P>
<P>
<PRE>
&gt; B  := D[1]/G; B;
Modular abelian variety of dimension 1 and level 5*13 over Q
&gt; IsIsomorphic(D[1],B);
false
</PRE>
<P>
Next we compute some non-finite intersections.
<P>
<P>
<PRE>
&gt; A := D[1] + D[2];
&gt; B := D[1] + D[3];
&gt; A meet B;
Finitely generated subgroup of abelian variety with invariants [ 2, 2, 2 ]
Modular abelian variety of dimension 1 and level 5*13 over Q
Homomorphism from modular abelian variety of dimension 1 to 
modular abelian variety of dimension 6 given on integral homology
by:
[ 1 -1  0  0  0  0  1 -1  0  0  0 -1]
[ 0  0  1 -1  1 -1  0  0  1 -1  1  0]
Homomorphism from modular abelian variety of dimension 6 to 
JZero(65) (not printing 12x10 matrix)
</PRE>
We can also intersect images of morphisms. 
<P>
<P>
<PRE>
&gt; f := ModularEmbedding(A);
&gt; g := ModularEmbedding(B);
&gt; _, C := IntersectionOfImages([* f, g *]);
&gt; C eq D[1];
true
</PRE>
<HR>
<H3><A NAME = "18338">Example <TT>ModAbVar_Arithabvar-Intersections2 (H142E81)</TT></A></H3>
The following example illustrates failure of multiplicity
one for J<sub>0</sub>(p) for a prime number p.  This is the first
such example known, and it was discovered by Lloyd Kilford
using Magma <A  HREF = "text1634.htm#bib_MR2003j-11046">[Kil02]</A>.  
There are two elliptic curve factors A and B inside
J<sub>0</sub>(431).  The eigenforms associated to A and B
are congruent modulo 2, but the intersection of A
and B is trivial.
<P>
<P>
<PRE>
&gt; J := JZero(431);
&gt; IsPrime(431);
true
&gt; A := Decomposition(J)[1];
&gt; B := Decomposition(J)[2];
&gt; G, C := A meet B;
&gt; G;
{ 0 }: finitely generated subgroup of abelian variety with 
invariants []
&gt; C;
Modular abelian variety ZERO of dimension 0 and level 431 over Q
&gt; Newform(A) - Newform(B);
-2*q^3 + 4*q^5 + 2*q^6 - 4*q^7 + O(q^8)
</PRE>
<HR>
<H4><A NAME = "18339">Quotients</A></H4>

<P>
<P>
<P>
If B is an abelian subvariety of A (or some natural image of B
lies in A), then the quotient A/B is an abelian variety.  Also,
the cokernel of a homomorphism of abelian varieties is an abelian variety.


<H5><A NAME = "18340">A / B : ModAbVar, ModAbVar -&gt;  ModAbVar, MapModAbVar</A></H5>
<BLOCKQUOTE>
The quotient of the abelian variety A by a natural image B' of 
the abelian variety B. Here 
B' is the image of B under the modular embedding composed with the 
modular parameterization to A.  
</BLOCKQUOTE>
<H5><A NAME = "18341">Cokernel(phi) : MapModAbVar -&gt;  ModAbVar, MapModAbVar</A></H5>
<BLOCKQUOTE>
The cokernel of the morphism &phi; of abelian varieties 
and a morphism from the codomain of &phi; 
to the cokernel.  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18342">Example <TT>ModAbVar_Arithabvar-Quotients (H142E82)</TT></A></H3>
<P>
We compute a 2-dimensional quotient of the 3-dimensional abelian
variety J<sub>0</sub>(33) using the Hecke operator T<sub>2</sub>.
<P>
<P>
<PRE>
&gt; J := JZero(33);
&gt; T := HeckeOperator(J,2);
&gt; Factorization(CharacteristicPolynomial(T));
[
    &lt;x - 1, 2&gt;,
    &lt;x + 2, 4&gt;
]
&gt; C := ConnectedKernel(T-1);
&gt; B,psi := J/C;
&gt; B;
Modular abelian variety of dimension 2 and level 3*11 over Q
</PRE>
<HR>
<PRE></PRE> <A  HREF = "text1642.htm">[Next]</A><A  HREF = "text1640.htm">[Prev]</A> <A  HREF = "text1642.htm">[Right]</A> <A  HREF = "text1640.htm">[Left]</A> <A  HREF = "text1635.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>