<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Building Blocks</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text1644.htm">[Next]</A><A  HREF = "text1642.htm">[Prev]</A> <A  HREF = "text1644.htm">[Right]</A> <A  HREF = "text1642.htm">[Left]</A> <A  HREF = "text1635.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "18357">Building Blocks</A></H3>

<P>
<P>
<P>
The abelian variety  A<sub>f</sub>/Q associated to a newform f 
is isogenous over Qbar to a power (B<sub>f</sub>)<sup>r</sup> of some simple variety B<sub>f</sub>,
which is called a "building block".
This section is concerned with computations related to the field of definition of B<sub>f</sub>,
and its endomorphism algebra.
<P>
The functions in this section take spaces of modular symbols, and <I>must have sign +1</I>.
For instance, the modular symbols of level N, weight 2 and sign +1 
are obtained from <TT>ModularSymbols(N,2,1)</TT>. (These spaces have the same
dimension as the corresponding spaces of modular forms.)
Furthermore, the space of symbols
is expected to be <I>cuspidal, new and irreducible over Q</I> (in other words,
the corresponding space of cusp forms is spanned by a single Galois orbit of newforms).
<P>
<I>Acknowledgement:</I> This section was contributed by Jordi Quer. For more
details of the theory, and some tables, see <A  HREF = "text1634.htm#bib_quer-building-blocks">[Que09]</A>.



<H5>Subsections</H5>
<UL>
<LI> <A  HREF = "text1643.htm#18358">Background and Notation</A>
</UL>
<H4><A NAME = "18358">Background and Notation</A></H4>

<P>
<P>
Let f=&sum;<sub>n=1</sub>^&infin;a<sub>n</sub> q<sup>n</sup>&isin;S<sub>2</sub><sup>new</sup>(N, &epsilon;)
be a newform of weight 2, level N and Nebentypus &epsilon;. Let
E be the number field generated by the coefficients a<sub>n</sub>, and let 
F be the field generated by the numbers &mu;<sub>p</sub> := (a<sub>p</sub><sup>2</sup>/&epsilon;(p)) for primes p
not dividing N.
<P>
The abelian variety A<sub>f</sub>/Q attached to f 
(that is, associated to the space spanned by f and its conjugates)
is a variety of dimension equal to the degree [E:Q] with endomorphism algebra 
End<sub>Q</sub>(A<sub>f</sub>) tensor Q isomorphic to E. 
<P>
The variety A<sub>f</sub> has complex multiplication if there is a
nontrivial character &chi; (necessarily of order 2)
such that a<sub>p</sub>=&chi;(p) a<sub>p</sub> for all p not dividing N,
and in this case the variety B<sub>f</sub> is an elliptic curve with complex multiplication
by the quadratic field fixed by the kernel of &chi;.
<P>
We assume for the rest of this section that A<sub>f</sub> has no complex multiplication.
Then, the field F is totally real, and E/F is an abelian extension. 
E is totally real when &epsilon; is trivial, and
otherwise E is a CM field.
The endomorphism algebra End(B<sub>f</sub>) tensor Q is a division algebra with centre F.
It is either equal to F, and then dim(B<sub>f</sub>)=[F:Q]
and r=[E:F], or otherwise is a quaternion algebra over F,
and then dim(B<sub>f</sub>)=2[F:Q] and r=[E:F]/2.
<P>
For every element s&isin;G<sub>F</sub> there exists a unique primitive Dirichlet character &chi;<sub>s</sub>,
which only depends on the action of s on the field E, such that
a<sub>p</sub><sup>s</sup> =&chi;<sub>s</sub>(p) a<sub>p</sub> for all p not dividing N.
The characters &chi;<sub>s</sub> are called the <I>inner twists</I> of the form f.
<P>
Let F<sub>&delta;</sub>  be the extension of F generated by the
square roots of the elements &mu;<sub>p</sub>&isin;F (for p not dividing N).
Note that E F<sub>&delta;</sub>=E(Sqrt(&epsilon;)), the
field obtained by adjoining square roots of the character values, 
which is either E or a quadratic extension of E.
We may associate to each s &isin;Gal(F<sub>&delta;</sub>/F) a primitive quadratic Dirichlet character
&psi;<sub>s</sub>, defined by Sqrt(&mu;<sub>p</sub>)<sup>s</sup>=&psi;<sub>s</sub>(p) Sqrt(&mu;<sub>p</sub>) (for p not dividing N).
These are called the <I>quadratic degree characters</I> of the form f. 
They are related with the inner twists of f by the identity
&chi;<sub>s</sub>(p)=&psi;<sub>s</sub>(p)Sqrt(&epsilon;(p))<sup>s</sup>/Sqrt(&epsilon;(p)) .
<P>
Let K<sub>P</sub>/Q be the field
fixed by the kernel of the homomorphism &delta; : G<sub>Q</sub> to  F<sup> * </sup>/F<sup> * 2</sup> 
that sends Frob<sub>p</sub> to &mu;<sub>p</sub> for all p not dividing N with a<sub>p</sub> nonzero. 
(This is enough to determine the homomorphism, because the primes with a<sub>p</sub>=0 have density zero).
This homomorphism is returned by <TT>DegreeMap</TT> (the syntax uses the notation below).
<P>
The Galois group Gal(K<sub>P</sub>/Q) is abelian of exponent 2; 
choose a basis &sigma;<sub>1</sub>, ..., &sigma;<sub>r</sub>.
Let &psi;<sub>1</sub>, ..., &psi;<sub>r</sub> be the basis of 
Hom(Gal(K<sub>P</sub>/Q), Z/2) dual to the basis {&sigma;<sub>i</sub>}, 
and consider the &psi;<sub>i</sub>'s as characters on G<sub>Q</sub>.
Also let t<sub>i</sub> be a quadratic discriminant such that Q(Sqrt(t<sub>i</sub>)) &sub;K<sub>P</sub> 
is the field fixed by the kernel of &psi;<sub>i</sub>.
<P>
Denote by &gamma;<sub>&epsilon;</sub> the element of Br(Q)[2]
given by the two-cocycle sending &sigma;, &tau; to 
Sqrt(&epsilon;(&sigma;)) Sqrt(&epsilon;(&tau;))
    (Sqrt(&epsilon;(&sigma;&tau;)))<sup> - 1</sup>.
Then the class in Br(F)[2] of the endomorphism algebra
End<sup>0</sup>(B<sub>f</sub>) is the restriction to F of 
&gamma;<sub>&epsilon;</sub> &prod;(t<sub>i</sub>, &delta;(&sigma;<sub>i</sub>)).
This is computed by <TT>BrauerClass</TT>.
<P>
In general the smallest fields of definition up to isogeny for B<sub>f</sub> are quadratic extensions of K<sub>P</sub>.
It is sometimes possible to "descend" B<sub>f</sub> (up to isogeny) to the field K<sub>P</sub>.
The obstruction  to this descent lies in Br(K<sub>P</sub>)[2],
and is given by the restriction of &gamma;<sub>&epsilon;</sub> to K<sub>P</sub>.
This is computed by <TT>ObstructionDescentBuildingBlock</TT>.


<H5><A NAME = "18359">BoundedFSubspace(epsilon, k, degrees) : GrpDrchElt, RngIntElt, [RngIntElt] -&gt; [ ModSym ]</A></H5>
<BLOCKQUOTE>
A sequence containing the irreducible subspaces of the modular symbols of weight k and Nebentypus character 
&epsilon; corresponding to
non-CM newforms for which the degree [F:Q] of the centre of the endomorphism algebra 
(of the associated abelian variety) is in the sequence degrees.
</BLOCKQUOTE>
<H5><A NAME = "18360">HasCM(M : parameters) : ModSym -&gt; BoolElt, RngIntElt</A></H5>
<H5>IsCM(M : parameters) : ModSym -&gt; BoolElt, RngIntElt</H5>

<PRE>    Proof: BoolElt                      Default: <TT>false</TT></PRE>
<BLOCKQUOTE>
Return <TT>true</TT> if and only if the modular abelian variety attached to the given space of modular symbols 
has complex multiplication. When the level is larger than 100, an unproved bound
is used in the computation, unless <TT>Proof</TT> is set to <TT>true</TT>.
</BLOCKQUOTE>
<H5><A NAME = "18361">InnerTwists(A : parameters) : ModAbVar -&gt; [ GrpDrchElt ]</A></H5>
<H5>InnerTwists(M : parameters) : ModSym -&gt; [ GrpDrchElt ]</H5>

<PRE>    Proof: BoolElt                      Default: <TT>false</TT></PRE>
<BLOCKQUOTE>
The inner twists of the newform f = &sum;a<sub>n</sub> q<sup>n</sup> corresponding
to the given space of modular symbols, or to the given modular abelian variety. 
This should be irreducible over Q, and f should not have CM,
and only spaces of modular symbols with sign +1 are accepted.
<P>
The inner twists are Dirichlet characters satisfying
&chi;<sub>s</sub>(p) = a<sub>p</sub><sup>s</sup>/a<sub>p</sub> (for primes p not dividing the level), 
where s is in the absolute Galois group of Q.
<P>
<I>Warning:</I> when the level is larger than 100, a non-rigorous bound
is used in the computation, unless <TT>Proof</TT> is set to <TT>true</TT>. 
Even in that case, the returned twists are only checked to be
inner twists up to precision 10<sup> - 5</sup>.
</BLOCKQUOTE>
<H5><A NAME = "18362">DegreeMap(M : parameters) : ModSym -&gt; [ Tup ], Fld</A></H5>

<PRE>    Proof: BoolElt                      Default: <TT>false</TT></PRE>
<BLOCKQUOTE>
The homomorphism &delta; : G<sub>Q</sub> to  F<sup> * </sup>/F<sup> * 2</sup> (as defined in the introduction),
attached to the given space M of modular symbols (which should be new, irreducible over Q,
and have sign +1). 
The second object returned is F.
The first object returned is a sequence of tuples &lt;t<sub>i</sub>, f<sub>i</sub>&gt;, where t<sub>i</sub> &isin;Q are quadratic 
discriminants and f<sub>i</sub> &isin;F. The t<sub>i</sub> determine a basis &sigma;<sub>i</sub> of Gal(K<sub>P</sub>/Q) 
as in the introduction, and &delta; is the map sending &sigma;<sub>i</sub> to f<sub>i</sub>.
</BLOCKQUOTE>
<H5><A NAME = "18363">BrauerClass(M) : ModSym -&gt; SeqEnum</A></H5>
<BLOCKQUOTE>
Given a space of modular symbols M corresponding to a newform f,
this function computes the Brauer class of the endomorphism algebra of the 
associated abelian variety A<sub>f</sub> (or motive M<sub>f</sub>).
The endomorphism algebra is either a number field F (in which case 
an empty sequence is returned), or a quaternion algebra 
over a number field F. The corresponding class in the Brauer group Br(F)[2] 
is specified by returning the sequence of places of F that ramify in the
quaternion algebra.
<P>
The given space M should be irreducible over Q,
and have sign +1, and f should not have CM. 
</BLOCKQUOTE>
<H5><A NAME = "18364">ObstructionDescentBuildingBlock(M) : ModSym -&gt; SeqEnum</A></H5>
<BLOCKQUOTE>
Given a space of modular symbols M corresponding to a newform f,
this function computes the obstruction to "descending" the 
building block B<sub>f</sub> to the field K<sub>P</sub> (for definitions, see the introduction).
The obstruction to the existence of a building block over K<sub>P</sub> 
isogenous to B<sub>f</sub> is an element of the Brauer group Br(K<sub>P</sub>)[2].
(More precisely, for any field L there exists such a building block over L
if and only if L is an extension of K<sub>P</sub> over which this Brauer element splits.)
The Brauer class is specified by returning the sequence of places of K<sub>P</sub> where
the class is not locally trivial.
<P>
The given space M should be irreducible over Q,
and have sign +1, and f should not have CM. 
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18365">Example <TT>ModAbVar_Complements-Complements (H142E87)</TT></A></H3>
<P>
The lowest level where a nontrivial obstruction occurs is
28, with a character of order 6. We find that the space of 
modular symbols (with sign 1) for this character has dimension 2 
over the field of character values. 
<P>
<P>
<PRE>
&gt; Chi28 := FullDirichletGroup(28);
&gt; chi := Chi28.1*Chi28.2;
&gt; Chi28;
Group of Dirichlet characters of modulus 28 
   over Cyclotomic Field of order 6 and degree 2
&gt; Order(Chi28), Order(chi);
12 6
&gt;  M28chi := CuspidalSubspace( ModularSymbols(chi, 2, 1));
&gt; M28chi;
Modular symbols space of level 28, weight 2, character $.1*$.2, and dimension
2 over Cyclotomic Field of order 6 and degree 2
&gt; qEigenform(M28chi);
q + (1/3*(-zeta_6 - 1)*a - zeta_6)*q^2 + a*q^3 + 1/3*(4*zeta_6 - 2)*a*q^4 + 
    (zeta_6 - 2)*q^5 + (-zeta_6*a + (2*zeta_6 - 1))*q^6 + 1/3*(-zeta_6 - 4)*a*q^7 
    + O(q^8)
&gt; Parent(Coefficients(qEigenform(M28chi))[2]);
Univariate Quotient Polynomial Algebra in a 
   over Cyclotomic Field of order 6 and degree 2 
   with modulus a^2 + 3*zeta_6
</PRE>
So the q-eigenform is defined over a quadratic extension of Q(&zeta;<sub>6</sub>),
In fact, this extension is Q(&zeta;<sub>6</sub>, i).
Since the space <TT>M28chi</TT> has dimension 2 over Q(&zeta;<sub>6</sub>), 
it is irreducible over Q(&zeta;<sub>6</sub>). 
The corresponding abelian variety over Q therefore has dimension 4.
<P>
<P>
<PRE>
&gt; A := ModularAbelianVariety(M28chi);
&gt; A;
Modular abelian variety of dimension 4 and level 2^2*7 over Q with sign 1
&gt; delta, F := DegreeMap(M28chi);
&gt; F;
Rational Field
</PRE>
This means that A is isogenous to B<sup>2</sup> for some abelian variety B
over Qbar of dimension 2, and that the endomorphism algebra of B is a
quaternion algebra over F = Q.
<P>
<P>
<PRE>
&gt; BrauerClass(M28chi);
[ 2, 3 ]
</PRE>
This means the endomorphism algebra of B is the quaternion
algebra over Q ramified only at 2 and 3.
Now we determine the possible fields of definition of B.
<P>
<P>
<PRE>
&gt; delta;  // This came from DegreeMap, above.
[ &lt;-7, 3&gt; ]
</PRE>
In particular, this tells us that K<sub>P</sub> = Q(Sqrt( - 7)).
<P>
<P>
<PRE>
&gt; ObstructionDescentBuildingBlock(M28chi);
[ Place at Prime Ideal
Two element generators:
    [2, 0]
    [0, 1], 
Place at Prime Ideal
Two element generators:
    [2, 0]
    [3, 1] ]
&gt; Universe($1);  // What are these places elements of?
Set of Places of Number Field with defining polynomial x^2 + 7 
over the Rational Field
</PRE>
The obstruction is given as a list of places of Q(Sqrt( - 7)).
Recall that B can be defined over any extension
of K<sub>P</sub> for which the obstruction is trivial. In this case,
any extension of Q(Sqrt( - 7)) which splits the quaternion algebra 
over  Q(Sqrt( - 7)) ramified at the two primes above 2.
<HR>
<PRE></PRE> <A  HREF = "text1644.htm">[Next]</A><A  HREF = "text1642.htm">[Prev]</A> <A  HREF = "text1644.htm">[Right]</A> <A  HREF = "text1642.htm">[Left]</A> <A  HREF = "text1635.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>