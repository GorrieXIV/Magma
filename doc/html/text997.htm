<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Units and Unit Groups</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text981.htm">[Next]</A><A  HREF = "text996.htm">[Prev]</A> <A  HREF = "text981.htm">[Right]</A> <A  HREF = "text996.htm">[Left]</A> <A  HREF = "text982.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "11288">Units and Unit Groups</A></H3>

<P>
<P>
Let S be a definite quaternion order over Z, F<sub>q</sub>[X] with q odd,
or a number ring. In the first two cases, the unit group of S is finite
and can be read off any reduced Gram matrix of S. If the base ring of
S is some number ring R, then an explicit description of the finite
quotient S<sup> * </sup>/R<sup> * </sup> is given in <A  HREF = "text981.htm#bib_Vigneras76">[Vig76]</A>. 


<H5><A NAME = "11289">NormOneGroup(S) : AlgAssVOrd -&gt; GrpPerm, Map</A></H5>
<H5>NormOneGroup(S) : AlgQuatOrd -&gt; GrpAb, Map</H5>

<PRE>    ModScalars: BoolElt                 Default: <TT>false</TT></PRE>
<BLOCKQUOTE>
Returns a group G isomorphic to the group S<sub>1</sub> of elements in
S with reduced norm 1 (unless <TT>ModScalars</TT> is set, 
in which case G is isomorphic to S<sub>1</sub> modulo {&#8723; 1}).
<P>
The second object returned is a map from G to S expressing the isomorphism.
</BLOCKQUOTE>
<H5><A NAME = "11290">Units(S) : AlgQuatOrd -&gt; SeqEnum</A></H5>
<H5>Units(S) : AlgAssVOrd -&gt; SeqEnum</H5>
<BLOCKQUOTE>
This intrinsic computes the set of units S<sup> * </sup> for the definite order S.
When the base ring of S is Z or F<sub>q</sub>[X], the returned sequence contains
all units of S; when the base field is a number field, the returned sequence
contains representatives modulo the unit group of the base ring
(since the unit group is infinite in general).
</BLOCKQUOTE>
<H5><A NAME = "11291">MultiplicativeGroup(S) : AlgQuatOrd[RngInt] -&gt; GrpPerm, Map</A></H5>
<H5>UnitGroup(S) : AlgQuatOrd[RngInt] -&gt; GrpPerm, Map</H5>
<H5>MultiplicativeGroup(S) : AlgQuatOrd[RngUPol] -&gt; GrpAb, Map</H5>
<H5>UnitGroup(S) : AlgQuatOrd[RngUPol] -&gt; GrpAb, Map</H5>
<H5>MultiplicativeGroup(S) : AlgAssVOrd[RngOrd] -&gt; GrpPerm, Map</H5>
<H5>UnitGroup(S) : AlgAssVOrd[RngOrd] -&gt; GrpPerm, Map</H5>
<BLOCKQUOTE>
This intrinsic computes the unit group S<sup> * </sup> of the definite quaternion 
order S.  The function returns an abstract group G, and a map from 
G to S.  When the base ring of S is Z or F<sub>q</sub>[X], G represents 
the full group of units of S; when the base field is a number field, G 
represents the unit group of S modulo the unit group of the base ring
(since the unit group is infinite in general).
</BLOCKQUOTE>
<HR>
<H3><A NAME = "11292">Example <TT>AlgQuat_Unit_Group (H91E27)</TT></A></H3>
The following example illustrates the unit group computation for an 
order in a definite quaternion algebra over Q.
<P>
<P>
<PRE>
&gt; A := QuaternionAlgebra&lt; RationalField() | -1, -1 &gt;;
&gt; S1 := MaximalOrder(A);    
&gt; S2 := QuaternionOrder(A,2);
&gt; G1, h1 := UnitGroup(S1);
&gt; #G1;
24
&gt; [ A | h1(g) : g in G1 ]; 
[ 1, -1, -j, -k, i, -1/2 + 1/2*i - 1/2*j - 1/2*k, 1/2 + 1/2*i - 1/2*j + 1/2*k, 
-1/2 - 1/2*i - 1/2*j + 1/2*k, -1/2 + 1/2*i + 1/2*j + 1/2*k, 1/2 - 1/2*i - 1/2*j 
- 1/2*k, 1/2 + 1/2*i + 1/2*j - 1/2*k, 1/2 - 1/2*i + 1/2*j + 1/2*k, -1/2 - 1/2*i 
+ 1/2*j - 1/2*k, 1/2 - 1/2*i + 1/2*j - 1/2*k, -1/2 + 1/2*i + 1/2*j - 1/2*k, 1/2 
+ 1/2*i - 1/2*j - 1/2*k, -1/2 - 1/2*i - 1/2*j - 1/2*k, 1/2 + 1/2*i + 1/2*j + 
1/2*k, -1/2 - 1/2*i + 1/2*j + 1/2*k, -1/2 + 1/2*i - 1/2*j + 1/2*k, 1/2 - 1/2*i -
1/2*j + 1/2*k, k, -i, j ]
&gt; G2, h2 := UnitGroup(S2);
&gt; #G2;
8
&gt; [ A | h2(g) : g in G2 ];
[ 1, -1, -j, j, k, -k, -i, i ]
</PRE>
The unit groups of orders in indefinite quaternion algebras A are 
infinite arithmetic groups, which are twisted analogues of the groups 
SL<sub>2</sub>(Z) and their families of subgroups.  These are studied in 
relation to their actions on the upper half complex plane, via an 
embedding in GL<sub>2</sub>(R) provided by some isomorphism A tensor R isomorphic to M<sub>2</sub>(R).
<HR>
<H3><A NAME = "11293">Example <TT>AlgQuat_Unit_Group_NumberRing (H91E28)</TT></A></H3>
Now we exhibit unit group computations over a number ring.
<P>
<P>
<PRE>
&gt; P&lt;x&gt; := PolynomialRing(Rationals());
&gt; F := NumberField(x^3-3*x-1);
&gt; Z_F := MaximalOrder(F);
&gt; Foo := InfinitePlaces(F);
</PRE>
We use <TT>SetSeed</TT> since the following line makes random choices.
<P>
<P>
<PRE>
&gt; SetSeed(1); 
&gt; A := QuaternionAlgebra(ideal&lt;Z_F | 2&gt;, Foo);
&gt; IsDefinite(A);
true
&gt; O := MaximalOrder(A);
&gt; U, h := UnitGroup(O);
&gt; U;
Permutation group U acting on a set of cardinality 12
Order = 12 = 2^2 * 3
    Id(U)
    (1, 2, 4)(3, 6, 7)(5, 9, 10)(8, 12, 11)
    (1, 3)(2, 5)(4, 8)(6, 11)(7, 9)(10, 12)
&gt; #Units(O);
12
</PRE>
<PRE></PRE> <A  HREF = "text981.htm">[Next]</A><A  HREF = "text996.htm">[Prev]</A> <A  HREF = "text981.htm">[Right]</A> <A  HREF = "text996.htm">[Left]</A> <A  HREF = "text982.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>