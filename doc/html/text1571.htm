<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Introduction</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text1572.htm">[Next]</A><A  HREF = "text1570.htm">[Prev]</A> <A  HREF = "text1572.htm">[Right]</A> [____] <A  HREF = "text1570.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "17592">Introduction</A></H3>




<H5>Subsections</H5>
<UL>
<LI> <A  HREF = "text1571.htm#17593">Modular Forms</A>
<LI> <A  HREF = "text1571.htm#17594">About the Package</A>
<LI> <A  HREF = "text1571.htm#17595">Categories</A>
<LI> <A  HREF = "text1571.htm#17596">Verbose Output</A>
<LI> <A  HREF = "text1571.htm#17598">An Illustrative Overview</A>
</UL>
<H4><A NAME = "17593">Modular Forms</A></H4>

<P>
<P>
This theoretically-oriented section serves as a guide to the rest of
the chapter.  We recall the definition of modular forms, then
briefly discuss q-expansions, Hecke operators, eigenforms,
congruences, and modular symbols.
<P>
Fix positive integers N and k, let
Hh denote the complex upper half plane.  
Denote by M<sub>k</sub>(&Gamma;<sub>1</sub>(N)) the space of modular forms on
&Gamma;<sub>1</sub>(N) of weight k.  This is the complex vector space of
holomorphic functions
f : H -&gt; C such that
f((az + b)/(cz + d)) = (cz + d)^k*f(z)
for all [a b, c d] &isin;&Gamma;<sub>1</sub>(N),
and
f(z) is holomorphic at each "cusp" in P<sup>1</sup>(Q)=Q&cup;{&infin;} 
(see, e.g., <A  HREF = "text1569.htm#bib_diamond-im">[DI95]</A> for a more precise definition.)
<P>
A  <I>Dirichlet character</I> is a homomorphism
&epsilon;:(Z/NZ)<sup> * </sup> -&gt; C<sup> * </sup> 
of abelian groups.  Dirichlet characters are of interest because
they decompose M<sub>k</sub>(&Gamma;<sub>1</sub>(N)) into more manageable chunks.
If V is any complex vector space equipped with an
action &rho;:(Z/NZ)<sup> * </sup> -&gt; Aut(V) 
and &epsilon; is a Dirichlet character, we set 
V(&epsilon;) = { x &isin;V : &rho;(a) x = &epsilon;(a)x  all  
   a &isin;(Z/NZ)<sup> * </sup>}.
The space M<sub>k</sub>(&Gamma;<sub>1</sub>(N)) is equipped with an action
of (Z/NZ)<sup> * </sup> by the diamond-bracket 
operators &lt; d &gt;, which are defined as follows.
Given /line(d)&isin;(Z/NZ)<sup> * </sup>, choose a matrix [a b, c d]  &isin;&Gamma;_0(N) such that
d mod  N = /line{d}. Then 
 &lt; d &gt; f(z) = 
      (cz + d)<sup> - k</sup> f((az + b)/(cz + d)).
We call M_k(&Gamma;_1(N))(&epsilon;) the space of modular forms 
of weight k, level N, and character &epsilon;.  
This is the complex vector space of holomorphic functions 
f : H - &gt; C such that f((az + b)/(cz + d)) = &epsilon;(a) (cz + d)<sup>k</sup> f(z)
for all [a b, c d]
&isin;&Gamma;<sub>0</sub>(N),
and which is holomorphic at the cusps.   
We let M_k([&epsilon;]) denote the direct sum of the spaces
M_k(&Gamma;_1(N))(&epsilon;) (as &epsilon; varies over the
Gal(Qbar/Q)-conjugates) of &epsilon;.
It is unnecessary to specify the level because it is
built into &epsilon;.
<P>
To summarize, for any integer k and positive integer N, there is
a finite - dimensional C-vector space M_k(&Gamma;_1(N)).
Moreover, 
  M<sub>k</sub>(&Gamma;<sub>1</sub>(N))  = 
  bigoplus_(hbox(all &epsilon;}) M<sub>k</sub>(&Gamma;<sub>1</sub>(N))(&epsilon;) 
 =  bigoplus_(hbox(Gal(Qbar/Q)-class reps. &epsilon;}) M<sub>k</sub>([&epsilon;]).
In Section ref(sec - creation), we describe how to 
create the spaces M_k(&Gamma;_1(N)) and M_k([&epsilon;]) in Magma,
for any k&ge;1, N&ge;1, and character &epsilon;.
<P>
Let f be a modular form, and observe that
since [a b, c d]  &isin;&Gamma;<sub>1</sub>(N), 
we have f(z)=f(z + 1).  If we set q = (exp)(2&pi; i z),
there is a <I>q-expansion</I> representation for f:
  f = a<sub>0</sub> + a<sub>1</sub> q + a<sub>2</sub> q<sup>2</sup> + a<sub>3</sub> q<sup>3</sup> + a<sub>4</sub>q<sup>4</sup> + ... .
The a<sub>n</sub> are called the <I>Fourier coefficients</I> of f.
Magma contains an algorithm for computing a
basis of q-expansions for any space of modular forms of
weight k&ge;2 (see Section <A  HREF = "text1626.htm#17978">Basis</A>). 
<P>
Fix a positive integer N and let M be a sum of spaces M<sub>k</sub>(N, &epsilon;).
Let q(- exp) : M -&gt; C[[q]] denote the map that
associates to a modular form f its q-expansion.
One can prove that there is a basis
f<sub>1</sub>, ..., f<sub>d</sub> of M that maps to a basis
for the free Z-module q(- exp)(M) &cap;Z[[q]].
See Section <A  HREF = "text1574.htm#17628">q-Expansions</A> for how to compute
such a basis in Magma.  
Let M<sub>Z</sub> be the Z-module spanned by f<sub>1</sub>, ..., f<sub>d</sub>.
For any ring R, we define 
the <I>space of modular forms over R</I> to be 
M<sub>R</sub> = M<sub>Z</sub> tensor <sub>Z</sub> R.  Thus M<sub>R</sub> is
a free R-module of rank d with basis the images of 
f<sub>1</sub>, ..., f<sub>d</sub> in M<sub>Z</sub> tensor <sub>Z</sub> R.
The computation of M<sub>R</sub> is discussed in 
Section <A  HREF = "text1572.htm#17613">Base Extension</A>.
<P>
Any space M of modular forms is equipped with an action of a
commutative ring Tt=Z[ ... T<sub>n</sub> ... ] of Hecke operators.  
The computation of Hecke operators T<sub>n</sub> and their 
characteristic polynomials is described in
Section <A  HREF = "text1649.htm#18494">Hecke and Atkin-Lehner Operators</A>. 
<P>
An <I>eigenform</I> is a simultaneous eigenvector for every element of
the Hecke algebra Tt.  A <I>newform</I> is an eigenform that doesn't
come from a space of lower level and is normalized so that the
coefficient of q is 1.  Section <A  HREF = "text1583.htm#17694">Newforms</A> describes how
to find newforms.  Computation of the mod p reductions and
p-adic and complex embeddings of a newform
is described in Section <A  HREF = "text1584.htm#17704">Reductions and Embeddings</A>.
<P>
Computation of congruences is discussed in
Section <A  HREF = "text1585.htm#17709">Congruences</A>.
<P>
Modular symbols are closely related to modular forms.  See
Section <A  HREF = "text1589.htm#17725">Modular Symbols</A> for the connection
between the two.


<H4><A NAME = "17594">About the Package</A></H4>

<P>
<P>
The modular forms package is in many ways an interface to the 
modular symbols machinery (Section <A  HREF = "text1589.htm#17725">Modular Symbols</A>).
It also contains additional functionality (such as Eisenstein 
series), and features that are implemented independently 
(such as Hecke operators). 
In some situations however, it is better to work with modular 
symbols directly.  In particular, spaces of modular forms
are required to be Galois-stable over the rationals, while
spaces of modular symbols are not.  Moreover some features, 
such as Hecke operators of certain spaces, are unavailable
for a given space of modular forms but can be obtained using 
the corresponding modular symbols.
<P>
In Magma version 2.14  modular forms of weight one, and of
half-integral weight, were added.  Most of the existing functions
now also work for these weights, however some are not implemented 
(for instance <TT>Newforms</TT>).  Further functionality for 
half-integral weight will be added in future releases (including
Hecke operators).  


<H4><A NAME = "17595">Categories</A></H4>

<P>
<P>
In Magma, spaces of modular forms belong to the category <TT>ModFrm</TT>, and
the elements of spaces of modular forms belong to <TT>ModFrmElt</TT>.


<H4><A NAME = "17596">Verbose Output</A></H4>

<P>
<P>
To set the verbosity level use
the command <TT>SetVerbose("ModularForms",n)</TT>, where <TT>n</TT> is 0
(silent), 1 (verbose), or 2 (very verbose).  
The default verbose level is 0.


<HR>
<H3><A NAME = "17597">Example <TT>ModFrm_Basics (H138E1)</TT></A></H3>
In this example, we illustrate categories and verbosity for modular forms.
<P>
<P>
<PRE>
&gt; M := ModularForms(11,2); M;
Space of modular forms on Gamma_0(11) of weight 2 and dimension 2 over
Integer Ring.
&gt; Type(M);
ModFrm
&gt; B := Basis(M); B;
[
    1 + 12*q^2 + 12*q^3 + 12*q^4 + 12*q^5 + 24*q^6 + 24*q^7 + O(q^8),
    q - 2*q^2 - q^3 + 2*q^4 + q^5 + 2*q^6 - 2*q^7 + O(q^8)
]
&gt; Type(B[1]);
ModFrmElt
</PRE>
<P>
Using <TT>SetVerbose</TT>, we get some information about what
is happening during computations.
<P>
<P>
<PRE>
&gt; SetVerbose("ModularForms",2);
&gt; M := ModularForms(30,4);
&gt; EisensteinSubspace(M);
ModularForms: Computing eisenstein subspace.
ModularForms: Computing dimension.
Space of modular forms on Gamma_0(30) of weight 4 and dimension 8 over
Integer Ring.
&gt; SetVerbose("ModularForms",0);   // turn off verbose mode
</PRE>
<HR>
<H4><A NAME = "17598">An Illustrative Overview</A></H4>

<P>
<P>
In this section, we give a longer example that serves as an overview
of the modular forms package.  It illustrates computations of modular
forms of level 1, and illustrates the exceptional case of Serre's
conjecture with a level 13 example.


<HR>
<H3><A NAME = "17599">Example <TT>ModFrm_Overview (H138E2)</TT></A></H3>
First, we compute the two-dimensional space of modular 
forms of weight 12 and level 1 over Z.
<P>
<P>
<PRE>
&gt; M := ModularForms(Gamma0(1),12); M;
Space of modular forms on Gamma_0(1) of weight 12 and dimension 2 over
Integer Ring.
</PRE>
The default output precision is 8:
<P>
<P>
<PRE>
&gt; Basis(M);  
[
    1 + 196560*q^2 + 16773120*q^3 + 398034000*q^4 + 4629381120*q^5 + 
    34417656000*q^6 + 187489935360*q^7 + O(q^8),
    q - 24*q^2 + 252*q^3 - 1472*q^4 + 4830*q^5 - 6048*q^6 - 16744*q^7 
    + O(q^8)
]
&gt; [PowerSeries(f,10) : f in Basis(M)];
[
    1 + 196560*q^2 + 16773120*q^3 + 398034000*q^4 + 4629381120*q^5 + 
        34417656000*q^6 + 187489935360*q^7 + 814879774800*q^8 + 
        2975551488000*q^9 + O(q^10),
    q - 24*q^2 + 252*q^3 - 1472*q^4 + 4830*q^5 - 6048*q^6 - 16744*q^7 
        + 84480*q^8 - 113643*q^9 + O(q^10)
]
&gt; f := Basis(M)[1];
&gt; Coefficient(f,2);
196560
</PRE>
The <TT>Newforms</TT> command returns a list of the 
Galois-orbits of newforms.
<P>
<P>
<PRE>
&gt; NumberOfNewformClasses(M);
2
&gt; f := Newform(M,1); f;
q - 24*q^2 + 252*q^3 - 1472*q^4 + 4830*q^5 - 6048*q^6 - 16744*q^7 + 
O(q^8)
</PRE>
We can call the "q" in the q-expansion anything we want and 
also compute forms to higher precision.
<P>
<P>
<PRE>
&gt; Mf&lt;w&gt; := Parent(f); Mf;
Space of modular forms on Gamma_0(1) of weight 12 and dimension 1 over
Rational Field.
&gt; f + O(w^12);    
w - 24*w^2 + 252*w^3 - 1472*w^4 + 4830*w^5 - 6048*w^6 - 16744*w^7 + 
    84480*w^8 - 113643*w^9 - 115920*w^10 + 534612*w^11 + O(w^12)
</PRE>
Typing <TT>f + O(w^12)</TT> is equivalent to typing
<TT>PowerSeries(f,12)</TT>.
The second newform orbit contains an Eisenstein series.
<P>
<P>
<PRE>
&gt; E := Newform(M,2); PowerSeries(E,2);
691/65520 + q + O(q^2)
</PRE>
Next we compute the two conjugate newforms in 
S<sub>2</sub>(&Gamma;<sub>1</sub>(13)):
<P>
<P>
<PRE>
&gt; M := ModularForms(Gamma1(13),2);  
&gt; S := CuspidalSubspace(M); S;
Space of modular forms on Gamma_1(13) of weight 2 and dimension 2 over
Integer Ring.
&gt; NumberOfNewformClasses(S);
1
&gt; f := Newform(S, 1); f;
q + (-a - 1)*q^2 + (2*a - 2)*q^3 + a*q^4 + (-2*a + 1)*q^5 + (-2*a + 
4)*q^6 + O(q^8)
</PRE>
Here a is a root of the polynomial x<sup>2</sup> - x + 1.
<P>
<P>
<PRE>
&gt; Parent(f);
Space of modular forms on Gamma_1(13) of weight 2 and dimension 2 over
Number Field with defining polynomial x^2 - x + 1 over the Rational 
Field.
</PRE>
The Galois-conjugacy class of f has two newforms in it.
<P>
<P>
<PRE>
&gt; Degree(f);
2
&gt; g := Newform(S, 1, 2); g;
q + (-b - 1)*q^2 + (2*b - 2)*q^3 + b*q^4 + (-2*b + 1)*q^5 + (-2*b + 
4)*q^6 + O(q^8)
&gt; BaseRing(Parent(g));
Number Field with defining polynomial x^2 - x + 1 over the Rational 
Field
</PRE>
The parents of f and g are isomorphic (but distinct)
abstract extensions of Q both isomorphic to Q(Sqrt( - 3)).
<P>
<P>
<PRE>
&gt; Parent(f) eq Parent(g);
false
</PRE>
We can also list all of the newforms at once, gathered into
Galois orbits, using the <TT>Newforms</TT> command:
<P>
<P>
<PRE>
&gt; N := Newforms(M);
&gt; #N;
8
&gt; N[3];
[*
1/13*(-7*zeta_6 - 11) + q + (2*zeta_6 + 1)*q^2 + (-3*zeta_6 + 1)*q^3 +
(6*zeta_6 - 3)*q^4 - 4*q^5 + (-7*zeta_6 + 7)*q^6 + (-7*zeta_6 + 8)*q^7
+ O(q^8),
1/13*(7*zeta_6 - 18) + q + (-2*zeta_6 + 3)*q^2 + (3*zeta_6 - 2)*q^3 + 
(-6*zeta_6 + 3)*q^4 - 4*q^5 + 7*zeta_6*q^6 + (7*zeta_6 + 1)*q^7 + 
O(q^8)
*]
</PRE>
The "Nebentypus" or character of f has order 6.
<P>
<P>
<PRE>
&gt; e := DirichletCharacter(f); Parent(e);
Group of Dirichlet characters of modulus 13 over Cyclotomic Field of 
order 6 and degree 2
&gt; Order(e);
6
</PRE>
This shows that there are no cuspidal newforms with Dirichlet
character of order 2.  As we see below,
the mod-3 reduction of f has character
/line(&epsilon;) that takes values in F<sub>3</sub> and has order 2.  
The minimal lift of /line(&epsilon;) to characteristic 0 has
order 2, while there are no newforms of level 13 with character
of order 2.  (This example illustrates the "exceptional case of Serre's
conjecture".)
<P>
<P>
<PRE>
&gt; f3 := Reductions(f,3); f3;
[* [*
q + 2*q^3 + 2*q^4 + O(q^8)
*] *]
&gt; M3&lt;q&gt; := Parent(f3[1][1]);
&gt; f3[1][1]+O(q^15);
q + 2*q^3 + 2*q^4 + q^9 + q^12 + 2*q^13 + O(q^15)
</PRE>
The modular forms package can also be used to quickly
compute dimensions of spaces of modular forms.
<P>
<P>
<PRE>
&gt; M := ModularForms(Gamma0(1),2048);   
&gt; Dimension(M);
171
&gt; M := ModularForms(Gamma1(389),2);   
&gt; Dimension(M);
6499
&gt; Dimension(CuspidalSubspace(M));
6112
</PRE>
Don't try to compute a basis of q-expansions for M!
<P>
<P>
<PRE>
&gt; M := ModularForms(Gamma0(123456789),6);
&gt; Dimension(CuspidalSubspace(M));
68624152
&gt; Dimension(EisensteinSubspace(M));
16
</PRE>
<HR>
<PRE></PRE> <A  HREF = "text1572.htm">[Next]</A><A  HREF = "text1570.htm">[Prev]</A> <A  HREF = "text1572.htm">[Right]</A> [____] <A  HREF = "text1570.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>