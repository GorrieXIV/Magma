<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Endomorphism Algebras and Hom Spaces</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text1641.htm">[Next]</A><A  HREF = "text1639.htm">[Prev]</A> <A  HREF = "text1641.htm">[Right]</A> <A  HREF = "text1639.htm">[Left]</A> <A  HREF = "text1635.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "18257">Endomorphism Algebras and Hom Spaces</A></H3>




<H5>Subsections</H5>
<UL>
<LI> <A  HREF = "text1640.htm#18258">Creation</A>
<LI> <A  HREF = "text1640.htm#18264">Subgroups and Subrings</A>
<LI> <A  HREF = "text1640.htm#18275">Pullback and Pushforward of Hom Spaces</A>
<LI> <A  HREF = "text1640.htm#18280">Arithmetic</A>
<LI> <A  HREF = "text1640.htm#18284">Quotients</A>
<LI> <A  HREF = "text1640.htm#18288">Invariants</A>
<LI> <A  HREF = "text1640.htm#18294">Structural Invariants</A>
<LI> <A  HREF = "text1640.htm#18300">Matrix and Module Structure</A>
<LI> <A  HREF = "text1640.htm#18308">Predicates</A>
<LI> <A  HREF = "text1640.htm#18318">Elements</A>
</UL>
<H4><A NAME = "18258">Creation</A></H4>

<P>
<P>
<P>
Let A and B be modular abelian varieties.  Then one can create the 
finite-rank free abelian group of homomorphisms from A to B or the 
vector space of homomorphisms in the category of abelian varieties up 
to isogeny. It is also possible to create the endomorphism algebra of an
abelian variety. Such creations do non-trivial computations until further
information is requested of the structures, such as rank or basis.
In particular, such creations do not compute Hom(A, B).


<H5><A NAME = "18259">Hom(A, B) : ModAbVar, ModAbVar -&gt;  HomModAbVar</A></H5>
<H5>Hom(A, B, oQ) : ModAbVar, ModAbVar, BoolElt -&gt;  HomModAbVar</H5>
<BLOCKQUOTE>
Return the group of homomorphisms from the abelian variety A to 
the abelian variety B. If the argument oQ is given and is <TT>true</TT>,
return the vector space generated by such homomorphisms.
</BLOCKQUOTE>
<H5><A NAME = "18260">End(A) : ModAbVar -&gt;  HomModAbVar</A></H5>
<H5>End(A, oQ) : ModAbVar, BoolElt -&gt;  HomModAbVar</H5>
<BLOCKQUOTE>
The endomorphism ring of the abelian variety A. If oQ is given and is 
<TT>true</TT>, return the endomorphism algebra.
</BLOCKQUOTE>
<H5><A NAME = "18261">BaseExtend(H, R) : HomModAbVar, Rng -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
The space H tensor R, where H is a group of homomorphisms of a modular
abelian variety and R is the rational numbers or 
integers. When R=Q , this is the space of homomorphisms in the category of 
abelian varieties up to isogeny.  
</BLOCKQUOTE>
<H5><A NAME = "18262">HeckeAlgebra(A) : ModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
The Hecke algebra associated to the abelian variety A, which is a commutative
subring of End(A) generated by Hecke operators. 
For an abelian variety attached 
to modular symbols, this is the algebra induced by Hecke operators 
acting on modular symbols (homology). For a general abelian variety, let 
&pi; :J to A and e:A to J be the modular parameterization and embedding of A. 
Then this is the ring of endomorphisms obtained by pulling back the Hecke 
algebra on J to A using &pi;  and e, i.e., it is e * T * &pi; , where T 
is the Hecke ring of J. For example, since J<sub>1</sub>(N) is represented as 
a quotient of J<sub>0</sub>(N), the Hecke algebra is not what you might expect
but may differ by some finite index.  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18263">Example <TT>ModAbVar_Homspace-Creation (H142E65)</TT></A></H3>
<P>
<P>
<PRE>
&gt; A := JZero(11); B := JZero(33);
&gt; Hom(A,B);
Group of homomorphisms from JZero(11) to JZero(33) 
&gt; Hom(A,B,true);
Group of homomorphisms from JZero(11) to JZero(33) in the category of 
abelian varieties up to isogeny 
&gt; End(A);
Group of homomorphisms from JZero(11) to JZero(11) 
&gt; End(A,true);
Group of homomorphisms from JZero(11) to JZero(11) in the category of 
abelian varieties up to isogeny 
&gt; BaseExtend(Hom(A,B),RationalField());
_Q: Group of homomorphisms from JZero(11) to JZero(33) in the category 
of abelian varieties up to isogeny
&gt; HeckeAlgebra(A);
HeckeAlg(JZero(11)): Group of homomorphisms from JZero(11) to JZero(11)  
</PRE>
<HR>
<H4><A NAME = "18264">Subgroups and Subrings</A></H4>

<P>
<P>
<P>
Subgroups of Hom(A, B)
can also be formed as well as subrings of End(A, B).
Magma provides the computation of saturations of subgroups of Hom(A, B)
where A and B are abelian varieties. 


<H5><A NAME = "18265">Subgroup(X) : [MapModAbVar] -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
The group of homomorphisms from the abelian variety A to the abelian variety 
B generated by the homomorphisms of abelian varieties in the sequence X.  
</BLOCKQUOTE>
<H5><A NAME = "18266">Subgroup(X, oQ : parameters) : [MapModAbVar], BoolElt -&gt;  HomModAbVar</A></H5>

<PRE>    IsBasis: BoolElt                    Default: <TT>false</TT></PRE>
<BLOCKQUOTE>
The group of homomorphisms generated by homomorphisms of abelian varieties 
in the sequence X. If the parameter 
<TT>IsBasis</TT> is <TT>true</TT>, then it is assumed that the elements of 
X are a basis for their span.  
If the argument oQ is <TT>true</TT>,
return the vector space generated by such homomorphisms.
</BLOCKQUOTE>
<H5><A NAME = "18267">Subring(X) : [MapModAbVar] -&gt;  HomModAbVar</A></H5>
<H5>Subring(X, oQ) : [MapModAbVar], BoolElt -&gt;  HomModAbVar</H5>
<BLOCKQUOTE>
The ring of endomorphisms of a modular abelian variety generated by the 
endomorphisms in the sequence X.  It does not need to contain unity.
If the argument oQ is given and is <TT>true</TT>,
return the algebra generated by such endomorphisms.
</BLOCKQUOTE>
<H5><A NAME = "18268">Subring(phi) : MapModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
The ring of endomorphisms generated by the endomorphism &phi; of an abelian
variety. It does not need to contain unity. 
</BLOCKQUOTE>
<H5><A NAME = "18269">Saturation(H) : HomModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
The saturation of the group H of homomorphisms of abelian varieties
in all homomorphisms. Suppose A and B are 
abelian varieties and H is a subgroup of Hom(A, B). Then 
Hom(A, B) is a free Z-module, and the saturation of H in Hom(A, B) is 
a group H' that contains H with finite index such that the quotient 
of <TT>Hom(A,B)</TT> by H' is torsion free.  
</BLOCKQUOTE>
<H5><A NAME = "18270">RingGeneratedBy(H) : HomModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
The ring of endomorphisms generated by the endomorphisms in the group H
of homomorphisms between abelian varieties.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18271">Example <TT>ModAbVar_Homspace-Subgroups__and_Subrings (H142E66)</TT></A></H3>
In this example we use the <TT>Saturation</TT> command to find
the integers N up to 60 such that the Hecke algebra of
J<sub>0</sub>(N) is not saturated in the full ring of endomorphisms.
<P>
<P>
<PRE>
&gt; function ind(N) 
&gt;    H := HeckeAlgebra(JZero(N)); 
&gt;    return Index(Saturation(H),H); 
&gt; end function;
&gt; for N in [2..60] do 
&gt;    i := ind(N);  
&gt;    if i gt 1 then N, i; end if;
&gt; end for;
44 2
46 2
54 3
56 2
60 2
</PRE>
Note that multiplicity one fails at 3 for J<sub>0</sub>(54).   It might
be interesting to find a precise relationship between failure of
multiplicity one and the index of the Hecke algebra T in its saturation.
<HR>
<H3><A NAME = "18272">Example <TT>ModAbVar_Homspace-Subgroups__and_Subrings2 (H142E67)</TT></A></H3>
This example illustrates constructing a subgroup.
<P>
<P>
<PRE>
&gt; J := JZero(33);
&gt; E := End(J); E;
Group of homomorphisms from JZero(33) to JZero(33) 
&gt; H := Subgroup([E.1, E.3]); H;
Group of homomorphisms from JZero(33) to JZero(33) 
&gt; Rank(H);
2
</PRE>
<HR>
<H3><A NAME = "18273">Example <TT>ModAbVar_Homspace-Subgroups__and_Subrings3 (H142E68)</TT></A></H3>
We compute the subring generated by T<sub>2</sub> on J<sub>0</sub>(100).
<P>
<P>
<PRE>
&gt; T2 := HeckeOperator(JZero(100),2);
&gt; R := Subring(T2); R;
Group of homomorphisms from JZero(100) to JZero(100) 
&gt; Rank(R);
3
</PRE>
<HR>
<H3><A NAME = "18274">Example <TT>ModAbVar_Homspace-Subgroups__and_Subrings4 (H142E69)</TT></A></H3>
The Hecke operator T<sub>2</sub> and the main Atkin-Lehner involution
together generate a commutative ring of rank 10 over Z.
<P>
<P>
<PRE>
&gt; J := JZero(100);
&gt; T2 := HeckeOperator(J,2);W := AtkinLehnerOperator(J,100);
&gt; R := Subring([End(J) | T2,W]);
&gt; Dimension(R);
10
&gt; Dimension(End(J));
13
&gt; IsRing(R);
true
&gt; IsCommutative(R);
false
</PRE>
<HR>
<H4><A NAME = "18275">Pullback and Pushforward of Hom Spaces</A></H4>

<P>
<P>
<P>
A homomorphism of abelian varieties induces a map from one space of
homomorphisms into another. The three commands below compute
the image of such maps.


<H5><A NAME = "18276">Pullback(H, phi) : HomModAbVar, MapModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
Given a space of homomorphisms H in Hom(A, B) and a morphism 
&phi; :B to C, compute the image of H in Hom(A, C) via the map that sends f 
to f * &phi; .  
</BLOCKQUOTE>
<H5><A NAME = "18277">Pullback(phi, H) : MapModAbVar, HomModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
Given a space of homomorphisms H in Hom(A, B) and a morphism 
&phi; :C to A, compute the image of H in Hom(C, B) via the map that sends f 
to &phi; * f.  
</BLOCKQUOTE>
<H5><A NAME = "18278">Pullback(phi, H, psi) : MapModAbVar, HomModAbVar, MapModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
Suppose H is a space of homomorphisms A to  B and 
&phi; :C to A and &psi; :B to D. Then this intrinsic computes and returns the ring 
of homomorphisms of A of the form &phi; * f * &psi; , where f is in 
H.  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18279">Example <TT>ModAbVar_Homspace-Pullback_and_Pushforward_of_Hom_Spaces (H142E70)</TT></A></H3>
<P>
<P>
<PRE>
&gt; H := Hom(JZero(11),JZero(22));
&gt; phi := NaturalMap(JZero(22),JZero(33));
&gt; psi := NaturalMap(JZero(33),JZero(11));
&gt; Pullback(H,phi);
Group of homomorphisms from JZero(11) to JZero(33) 
&gt; Pullback(psi,H);
Group of homomorphisms from JZero(33) to JZero(22) 
&gt; Pullback(psi,H,phi);
Group of homomorphisms from JZero(33) to JZero(33)
</PRE>
<HR>
<H4><A NAME = "18280">Arithmetic</A></H4>

<P>
<P>
<P>
The + and <TT>meet</TT> command compute the sum and intersection of 
two subgroups of Hom(A, B).


<H5><A NAME = "18281">H1 + H2 : HomModAbVar, HomModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
The subgroup generated by H<sub>1</sub> and H<sub>2</sub>, where H<sub>1</sub> and H<sub>2</sub> are 
assumed to both be subgroups of Hom(A, B), for abelian varieties A and 
B.  
</BLOCKQUOTE>
<H5><A NAME = "18282">H1 meet H2 : HomModAbVar, HomModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
The intersection of H<sub>1</sub> and H<sub>2</sub>, where H<sub>1</sub> and H<sub>2</sub> are 
assumed to both be subgroups of Hom(A, B), for abelian varieties A and 
B.  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18283">Example <TT>ModAbVar_Homspace-Arithmetic (H142E71)</TT></A></H3>
<P>
<P>
<PRE>
&gt; J := JZero(33);
&gt; E := End(J);
&gt; H1 := HeckeAlgebra(J); H1;
HeckeAlg(JZero(33)): Group of homomorphisms from JZero(33) to JZero(33) 
&gt; H2 := Subgroup([E.1,E.2]); H2;
Group of homomorphisms from JZero(33) to JZero(33) 
&gt; Dimension(E);
5
&gt; Dimension(H1);
3
&gt; Dimension(H2);
2
&gt; Dimension(H1 meet H2);
1
&gt; Dimension(H1 + H2);
4
</PRE>
<HR>
<H4><A NAME = "18284">Quotients</A></H4>

<P>
<P>
<P>
If H<sub>1</sub> and H<sub>2</sub> are subspaces of Hom(A, B) then the index of
H<sub>1</sub> in H<sub>2</sub> can be computed. The quotient H<sub>2</sub>/H<sub>1</sub> can also be taken.


<H5><A NAME = "18285">Index(H2, H1) : HomModAbVar, HomModAbVar -&gt;  RngIntElt</A></H5>
<BLOCKQUOTE>
The index of H<sub>1</sub> in H<sub>2</sub>, where H<sub>1</sub> and H<sub>2</sub> are both subgroups 
of Hom(A, B), for abelian varieties A and B. If H<sub>1</sub> is 
contained in H<sub>2</sub>, this is just the cardinality of H<sub>2</sub>/H<sub>1</sub>, or 0 if this 
cardinality is infinite. If H<sub>1</sub> is not contained in H<sub>2</sub>, then the index is by 
definition the generalized lattice index [H<sub>1</sub> + H<sub>2</sub>:H<sub>1</sub>]/[H<sub>1</sub> + H<sub>2</sub>:H<sub>2</sub>], 
assuming the denominator is nonzero, 
i.e., that H<sub>2</sub> has finite index in H<sub>1</sub> + H<sub>2</sub> (an error occurs if H<sub>2</sub> 
does not have finite index in H<sub>1</sub> + H<sub>2</sub>).  
</BLOCKQUOTE>
<H5><A NAME = "18286">Quotient(H2, H1) : HomModAbVar, HomModAbVar -&gt;  GrpAb, Map, Map</A></H5>
<H5>H2 / H1 : HomModAbVar, HomModAbVar -&gt;  GrpAb, Map, Map</H5>
<BLOCKQUOTE>
The abelian group quotient H<sub>2</sub>/H<sub>1</sub>, a map from H<sub>2</sub> to this 
quotient, and a lifting map from this quotient to H<sub>2</sub>, where H<sub>1</sub> and
H<sub>2</sub> are subgroups of Hom(A, B) and A and B are abelian varieties.  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18287">Example <TT>ModAbVar_Homspace-Quotients (H142E72)</TT></A></H3>
We define the subgroup of End(J<sub>0</sub>(54)) generated
by T<sub>1</sub>, T<sub>2</sub>, T<sub>3</sub>, and T<sub>4</sub>, find that it
has infinite index in the full Hecke algebra, and
compute the quotient, which is Z.
<P>
<P>
<PRE>
&gt; J := JZero(54);
&gt; T := HeckeAlgebra(J);
&gt; Dimension(T);
4
&gt; S := Subgroup([HeckeOperator(J,n) : n in [1..4]]);
&gt; Dimension(S);
3
&gt; Index(T,S);
0
&gt; Quotient(T,S);
Abelian Group isomorphic to Z
Defined on 1 generator (free)
Mapping from: HomModAbVar: T to Abelian Group isomorphic to Z
Defined on 1 generator (free) given by a rule [no inverse]
Mapping from: Abelian Group isomorphic to Z
Defined on 1 generator (free) to HomModAbVar: T given by a rule 
[no inverse]
&gt; G := T/S; G;
Abelian Group isomorphic to Z
Defined on 1 generator (free)
</PRE>
<P>
We compute  the subgroup generated by T<sub>3</sub>, T<sub>4</sub>, 
T<sub>5</sub>, and T<sub>10</sub>, and find that it has index
6 in its saturation.  
<P>
<P>
<PRE>
&gt; S := Subgroup([HeckeOperator(J,n) : n in [3,4,5,10]]);
&gt; Sat := Saturation(S);
&gt; Index(Sat,S);
6
&gt; Index(S,Sat);
1/6
&gt; Invariants(Sat/S);
[ 6 ]
</PRE>
<HR>
<H4><A NAME = "18288">Invariants</A></H4>

<P>
<P>
<P>
Domain and codomain of the homomorphisms in a space of homomorphisms of
abelian varieties can both be retrieved from the space as well as 
a field which all
homomorphisms in a space are defined over.
<P>
A possibly time consuming computation is that of the discriminant
of a space of homomorphisms.
Discriminants of Hecke algebras are particularly interesting to
compute because they are closely related to congruences between
eigenforms.


<H5><A NAME = "18289">Domain(H) : HomModAbVar -&gt;  ModAbVar</A></H5>
<BLOCKQUOTE>
The domain of the homomorphisms in the group H of homomorphisms between
modular abelian varieties.  
</BLOCKQUOTE>
<H5><A NAME = "18290">Codomain(H) : HomModAbVar -&gt;  ModAbVar</A></H5>
<BLOCKQUOTE>
The codomain of the homomorphisms in the group H of homomorphisms between
modular abelian varieties.  
</BLOCKQUOTE>
<H5><A NAME = "18291">FieldOfDefinition(H) : HomModAbVar -&gt;  ModAbVar</A></H5>
<BLOCKQUOTE>
A field over which all homomorphisms in the group H of homomorphisms of
abelian varieties are defined.  It is not guaranteed to be minimal.
</BLOCKQUOTE>
<H5><A NAME = "18292">Discriminant(H) : HomModAbVar -&gt;  FldRatElt, AlgMatElt</A></H5>
<BLOCKQUOTE>
The discriminant of the space H of homomorphisms of abelian varieties
with respect to the trace pairing matrix. 
This is the trace of endomorphisms acting on homology, not left 
multiplication on themselves, so, e.g., the discriminant of the Hecke algebra will 
be 2<sup>d</sup> times as big as it would be otherwise (if the sign is 0), 
where d is the dimension of A. If H is over Q , this function 
returns the discriminant of the lattice of elements in H that are 
homomorphisms.  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18293">Example <TT>ModAbVar_Homspace-Invariants (H142E73)</TT></A></H3>
<P>
<P>
<P>
<PRE>
&gt; H := Hom(JZero(11),JZero(33));
&gt; Domain(H);
Modular abelian variety JZero(11) of dimension 1 and level 11 over Q
&gt; Codomain(H);
Modular abelian variety JZero(33) of dimension 3 and level 3*11 over
Q
&gt; FieldOfDefinition(H);
Rational Field
&gt; A := BaseExtend(JZero(11),ComplexField());
&gt; H := End(A);
&gt; FieldOfDefinition(H);
Complex Field
</PRE>
Though H=Z, so the discriminant of the abstract ring H is 1,
the discriminant of the trace pairing of H acting on homology 
is 2:
<P>
<P>
<PRE>
&gt; Discriminant(H);
2
[2]
</PRE>
<P>
The prime p=389 is the only known example where p
divides the discriminant of the Hecke algebra of J<sub>0</sub>(p).
<P>
<P>
<PRE>
&gt; T := HeckeAlgebra(JZero(389,2 : Sign := +1));
&gt; d := Discriminant(T);
&gt; J := JZero(389,2,+1);
&gt; T := HeckeAlgebra(J);
&gt; d := Discriminant(T);
&gt; d mod 389;
0
&gt; Factorization(d);
[ &lt;2, 53&gt;, &lt;3, 4&gt;, &lt;5, 6&gt;, &lt;31, 2&gt;, &lt;37, 1&gt;, &lt;389, 1&gt;, &lt;3881, 1&gt;,
&lt;215517113148241, 1&gt;, &lt;477439237737571441, 1&gt; ]
</PRE>
All the "action" at 389 comes from the 20-dimensional
simple factor.
<P>
<P>
<PRE>
&gt; A := J(5); A;
Modular abelian variety 389E of dimension 20, level 389 and 
conductor 389^20 over Q with sign 1
&gt; Factorization(Discriminant(HeckeAlgebra(A)));
[ &lt;2, 98&gt;, &lt;5, 41&gt;, &lt;389, 1&gt;, &lt;215517113148241, 1&gt;, 
&lt;477439237737571441, 1&gt; ]
</PRE>
<HR>
<H4><A NAME = "18294">Structural Invariants</A></H4>

<P>
<P>
<P>
The following commands provide access to a basis and generators
for spaces of homomorphisms.  


<H5><A NAME = "18295">Basis(H) : HomModAbVar -&gt;  SeqEnum</A></H5>
<H5>Generators(H) : HomModAbVar -&gt;  SeqEnum</H5>
<BLOCKQUOTE>
A basis for the space H of homomorphisms of abelian varieties.  
</BLOCKQUOTE>
<H5><A NAME = "18296">Dimension(H) : HomModAbVar -&gt;  RngIntElt</A></H5>
<H5>Rank(H) : HomModAbVar -&gt;  RngIntElt</H5>
<BLOCKQUOTE>
The rank of the space H of homomorphisms of abelian varieties
as a Z-module or Q-vector space.  
</BLOCKQUOTE>
<H5><A NAME = "18297">Ngens(H) : HomModAbVar -&gt;  RngIntElt</A></H5>
<BLOCKQUOTE>
The number of generators of the space H of homomorphisms of abelian varieties.  
</BLOCKQUOTE>
<H5><A NAME = "18298">H . i : HomModAbVar, RngIntElt -&gt;  MapModAbVar</A></H5>
<BLOCKQUOTE>
The ith generator of the space H of homomorphisms of abelian varieties.  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18299">Example <TT>ModAbVar_Homspace-Structural_Invariants (H142E74)</TT></A></H3>
The following example illustrates each of the commands
for Hom(J<sub>0</sub>(11), J<sub>0</sub>(33)).
<P>
<P>
<PRE>
&gt; H := Hom(JZero(11),JZero(33));
&gt; Basis(H);
[
    Homomorphism from JZero(11) to JZero(33) given on integral homology
    by:
    [ 0  2 -1 -2  0  1]
    [ 1  0 -1 -1  1  1],
    Homomorphism from JZero(11) to JZero(33) given on integral homology
    by:
    [ 1  0 -2  2 -3  0]
    [ 1 -1  0  1 -2  1]
]
&gt; Dimension(H);
2
&gt; Ngens(H);
2
&gt; Rank(H);
2
&gt; H.1;
Homomorphism from JZero(11) to JZero(33) given on integral homology by:
[ 0  2 -1 -2  0  1]
[ 1  0 -1 -1  1  1]
</PRE>
<HR>
<H4><A NAME = "18300">Matrix and Module Structure</A></H4>

<P>
<P>
<P>
The following commands associate lattices, vector spaces, matrix algebras,
and matrix spaces to subspaces H of Hom(A, B).  


<H5><A NAME = "18301">Lattice(H) : HomModAbVar -&gt;  Lat</A></H5>
<H5>VectorSpace(H) : HomModAbVar -&gt;  ModTupFld</H5>
<BLOCKQUOTE>
A lattice or vector space 
with basis obtained from the components of the matrices 
of a basis for the space H of homomorphisms of abelian varieties.  
This free Z-module is constructed from the 
<TT>Eltseq</TT>s of the all of the basis elements of H.
</BLOCKQUOTE>
<H5><A NAME = "18302">MatrixAlgebra(H) : HomModAbVar -&gt;  AlgMat</A></H5>
<BLOCKQUOTE>
The matrix algebra generated by the underlying matrices of all 
elements in the space H of homomorphisms of abelian varieties, 
acting on homology.  
</BLOCKQUOTE>
<H5><A NAME = "18303">RMatrixSpace(H) : HomModAbVar -&gt;  ModMatFld</A></H5>
<BLOCKQUOTE>
The matrix space whose basis is the generators for the space H of
homomorphisms of abelian varieties.  
</BLOCKQUOTE>
<H5><A NAME = "18304">RModuleWithAction(H) : HomModAbVar -&gt;  ModED</A></H5>
<BLOCKQUOTE>
A module over the ring R generated by the space H of homomorphisms of
abelian varieties equipped with the action of H, where H must 
be a ring of endomorphisms.  
</BLOCKQUOTE>
<H5><A NAME = "18305">RModuleWithAction(H, p) : HomModAbVar, RngIntElt -&gt;  ModED</A></H5>
<BLOCKQUOTE>
A module over H tensor F<sub>p</sub> equipped with the action of H 
tensor F<sub>p</sub>, where H must be a ring of endomorphisms of an abelian variety
that has not been tensored with Q .  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18306">Example <TT>ModAbVar_Homspace-Matrix_and_Module_Structure (H142E75)</TT></A></H3>
<P>
<P>
We first demonstrate some of the commands
with Hom(J<sub>0</sub>(11), J<sub>0</sub>(33)).
<P>
<P>
<PRE>
&gt; H := Hom(JZero(11),JZero(33));
&gt; Lattice(H);
Lattice of rank 2 and degree 12
Basis:
( 0  2 -1 -2  0  1  1  0 -1 -1  1  1)
( 1  0 -2  2 -3  0  1 -1  0  1 -2  1)
&gt; RMatrixSpace(H);
RMatrixSpace of 2 by 6 matrices and dimension 2 over Integer Ring
&gt; RMatrixSpace(BaseExtend(H,RationalField()));
KMatrixSpace of 2 by 6 matrices and dimension 2 over Rational 
Field
&gt; VectorSpace(H);
Vector space of degree 12, dimension 2 over Rational Field
User basis:
( 1  0 -2  2 -3  0  1 -1  0  1 -2  1)
( 0 -2  1  2  0 -1 -1  0  1  1 -1 -1)
</PRE>
Next we consider the endomorphism algebra of J<sub>0</sub>(22).
<P>
<P>
<PRE>
&gt; H := End(JZero(22));
&gt; MatrixAlgebra(H);
Matrix Algebra of degree 4 with 4 generators over Integer Ring
&gt; RModuleWithAction(H);
RModule(IntegerRing(), 4)
Action:
[1 0 0 0]
[0 1 0 0]
[0 0 1 0]
[0 0 0 1]

[ 0  1  0  1]
[ 0  0  0  0]
[ 1  0  1 -1]
[ 0  1  0  1]

[ 0  1  0 -1]
[ 0  1  0  0]
[-1  2 -1  1]
[-1  1  0  0]

[ 0  1 -2  1]
[-1  2 -1  0]
[-1  0  1 -1]
[ 0 -1  1 -1]
</PRE>
<HR>
<H3><A NAME = "18307">Example <TT>ModAbVar_Homspace-Matrix_and_Module_Structure3 (H142E76)</TT></A></H3>
The following example illustrates that <TT>MatrixAlgebra</TT> computes
the algebra generated by H, even if H is not itself an algebra.
<P>
<P>
<PRE>
&gt; H := Subgroup([HeckeOperator(JZero(33),2)]); H;
Group of homomorphisms from JZero(33) to JZero(33) 
&gt; A := MatrixAlgebra(H); A;
Matrix Algebra of degree 6 with 1 generator over Integer Ring
&gt; Dimension(A);
2
&gt; Dimension(H);
1
</PRE>
<HR>
<H4><A NAME = "18308">Predicates</A></H4>

<P>
<P>
<P>
These commands determine whether a space of homomorphisms
is a ring, if it's commutative, if it's a field (and what field), if
it was created using the <TT>HeckeAlgebra</TT> command, whether it has
been tensored with Q, or whether it is saturated in the full ring
of endomorphisms.  Equality and inclusion can also be tested.


<H5><A NAME = "18309">IsRing(H) : HomModAbVar -&gt;  BoolElt</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if the space H of homomorphisms of abelian varieties
is a ring. (Note that a ring does not have to contain unity.)  
</BLOCKQUOTE>
<H5><A NAME = "18310">IsField(H) : HomModAbVar -&gt;  BoolElt, Fld, Map, Map</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if the space H of homomorphisms of abelian varieties
is a field, and if so returns that field, a map from the 
field to H, and a map from H to the field.  
</BLOCKQUOTE>
<H5><A NAME = "18311">IsCommutative(H) : HomModAbVar -&gt;  BoolElt</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if and only if the space H of homomorphisms of abelian
varieties is a commutative ring.  
</BLOCKQUOTE>
<H5><A NAME = "18312">IsHeckeAlgebra(H) : HomModAbVar -&gt;  BoolElt</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if the space H of homomorphisms of abelian varieties
was constructed using the <TT>HeckeAlgebra</TT> command. 
</BLOCKQUOTE>
<H5><A NAME = "18313">IsOverQ(H) : HomModAbVar -&gt;  HomModAbVar</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if the space H of homomorphisms of abelian varieties
is a Q-vector space instead of just a Z-module, 
i.e., a space of homomorphisms up to isogeny.  
</BLOCKQUOTE>
<H5><A NAME = "18314">IsSaturated(H) : HomModAbVar -&gt;  BoolElt</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if the space H of homomorphisms of abelian varieties
is equal to its saturation, i.e., the quotient of the 
ambient Hom(A, B) by H is torsion free.  
</BLOCKQUOTE>
<H5><A NAME = "18315">H1 eq H2 : HomModAbVar, HomModAbVar -&gt;  BoolElt</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if the spaces H<sub>1</sub> and H<sub>2</sub> of homomorphisms of
abelian varieties are equal.  
</BLOCKQUOTE>
<H5><A NAME = "18316">H1 subset H2 : HomModAbVar, HomModAbVar -&gt;  BoolElt</A></H5>
<BLOCKQUOTE>
Return <TT>true</TT> if the spaces H<sub>1</sub> and H<sub>2</sub> of homomorphisms of abelian 
varieties are both subgroups of a common 
Hom(A, B), and in addition H<sub>1</sub> is a subset of H<sub>2</sub>.  
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18317">Example <TT>ModAbVar_Homspace-Predicates (H142E77)</TT></A></H3>
We illustrate several of the commands for the endomorphism
ring of J<sub>0</sub>(33).
<P>
<P>
<PRE>
&gt; H := End(JZero(33));
&gt; IsCommutative(H);
false
&gt; IsField(H);
false 0 0 0
&gt; IsHeckeAlgebra(H);
false
&gt; IsOverQ(H);
false
&gt; IsOverQ(BaseExtend(H,RationalField()));
true
&gt; IsRing(H);
true
&gt; IsSaturated(H);
true
</PRE>
Next we compare the endomorphism ring with the Hecke algebra of J<sub>0</sub>(33).
<P>
<P>
<PRE>
&gt; T := HeckeAlgebra(JZero(33));
&gt; T eq H;
false
&gt; T subset H;
true
&gt; IsSaturated(T);
true
&gt; IsRing(T);
true
&gt; IsHeckeAlgebra(T);
true
&gt; IsCommutative(T);
true
&gt; IsField(BaseExtend(T,RationalField()));
false 0 0 0
</PRE>
The Hecke algebra of J<sub>0</sub>(33) is actually a product of 3 fields,
so it is not a field.  In contrast, the Hecke algebra of J<sub>0</sub>(23)
is a field.
<P>
<P>
<PRE>
&gt; T := HeckeAlgebra(JZero(23));
&gt; IsField(T);
false 0 0 0
</PRE>
In the following code, the answer you get might be different, since
computation of the defining polynomial for the number field involves
a randomized algorithm.
<P>
<P>
<PRE>
&gt; IsField(BaseExtend(T,RationalField()));
true Number Field with defining polynomial x^2 + 11*x + 29 over 
the Rational Field
Mapping from: Number Field with defining polynomial x^2 + 11*x + 
    29 over the Rational Field to HeckeAlg(JZero(23))_Q: Group of 
homomorphisms from JZero(23) to JZero(23) in the category of abelian 
varieties up to isogeny  given by a rule [no inverse]
Mapping from: HeckeAlg(JZero(23))_Q: Group of homomorphisms from 
JZero(23) to JZero(23) in the category of abelian varieties up to 
isogeny  to Number Field with defining polynomial x^2 + 11*x + 29
over the Rational Field given by a rule [no inverse]
</PRE>
<HR>
<H4><A NAME = "18318">Elements</A></H4>

<P>
<P>
<P>
Elements of spaces of homomorphisms exist as maps between abelian varieties
as discussed in Section <A  HREF = "text1639.htm#18163">Homomorphisms </A>. 


<H5><A NAME = "18319">H ! x : HomModAbVar, . -&gt;  BoolElt, MapModAbVar</A></H5>
<BLOCKQUOTE>
Coerce x into the space H of homomorphisms of abelian varieties.  
For this coercion to be successful x must be a homomorphism between 2
abelian varieties, an integer or a rational number or a matrix coercible into
the matrix space of H base extended to the rational numbers.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "18320">Example <TT>ModAbVar_Homspace-Random_Element (H142E78)</TT></A></H3>
<P>
<P>
<PRE>
&gt; H := End(JZero(22));
&gt; H ! Matrix(Integers(), 4, 4, 
&gt;              [9, -4, 0, 2, 0, 6, 0, 0, 2, -6, 11, -2, 3, -4, -0, 8]);
Homomorphism from JZero(22) to JZero(22) given on integral homology by:
[ 9 -4  0  2]
[ 0  6  0  0]
[ 2 -6 11 -2]
[ 3 -4  0  8]
</PRE>
<HR>
<PRE></PRE> <A  HREF = "text1641.htm">[Next]</A><A  HREF = "text1639.htm">[Prev]</A> <A  HREF = "text1641.htm">[Right]</A> <A  HREF = "text1639.htm">[Left]</A> <A  HREF = "text1635.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>