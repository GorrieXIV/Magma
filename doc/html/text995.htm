<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Norm Spaces and Basis Reduction</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text996.htm">[Next]</A><A  HREF = "text994.htm">[Prev]</A> <A  HREF = "text996.htm">[Right]</A> <A  HREF = "text994.htm">[Left]</A> <A  HREF = "text982.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "11257">Norm Spaces and Basis Reduction</A></H3>

<P>
<P>
For definite quaternion orders or ideals one can compute reduced bases 
and Gram matrices.
<P>
If the base ring of the order or ideal is Z or F<sub>q</sub>[X] with q odd,
the Gram matrices can be made unique up to isomorphism.  In fact, in 
these cases, the isomorphism testing of ideals and orders is based on 
this reduction.


<H5><A NAME = "11258">NormSpace(A) : AlgQuat -&gt; ModTupFld, Map</A></H5>
<BLOCKQUOTE>
Given a quaternion algebra A over any field F not of characteristic 
2, this function returns the underlying F-space with inner product 
the norm form.  A map from A into the structure is returned as second
value. 
</BLOCKQUOTE>
<H5><A NAME = "11259">NormSpace(S) : AlgQuatOrd -&gt; ModTupRng, Map</A></H5>
<H5>NormModule(S) : AlgQuatOrd -&gt; ModTupRng, Map</H5>
<BLOCKQUOTE>
Given a quaternion order S over Z or F<sub>q</sub>[X] (with q odd), 
this function returns the underlying module over its base ring, with 
inner product respect to the norm. A map from O into the structure 
is returned as second value.
</BLOCKQUOTE>
<H5><A NAME = "11260">GramMatrix(S) : AlgQuatOrd -&gt; AlgMatElt</A></H5>
<H5>GramMatrix(I) : AlgQuatOrdIdl -&gt; AlgMatElt</H5>
<BLOCKQUOTE>
The Gram matrix of the quaternion order S or ideal I over Z 
or F<sub>q</sub>[X] with respect to the norm on the basis for S.
</BLOCKQUOTE>
<H5><A NAME = "11261">ReducedGramMatrix(S) : AlgQuatOrd[RngInt] -&gt; AlgMatElt</A></H5>
<H5>ReducedGramMatrix(S) : AlgQuatOrdIdl[RngInt] -&gt; AlgMatElt</H5>
<BLOCKQUOTE>
Given an order or ideal S over Z in a definite quaternion algebra,
this function returns the Gram matrix G of the corresponding lattice.
<P>
The quaternion ideal machinery makes use of a Minkowski basis reduction 
algorithm which returns a unique normalized reduced Gram matrix G 
for any definite quaternion ideal. This forms the core of the isomorphism 
testing for quaternion ideals. 
</BLOCKQUOTE>
<H5><A NAME = "11262">ReducedBasis(S) : AlgQuatOrd[RngInt] -&gt; SeqEnum</A></H5>
<H5>ReducedBasis(S) : AlgQuatOrdIdl[RngInt] -&gt; SeqEnum</H5>
<BLOCKQUOTE>
Given an order or ideal S over Z in a definite quaternion algebra,
this function returns some basis B of S the Gram matrix G of the 
corresponding lattice associated with S.  Note that while there exists 
a unique Minkowski-reduced Gram matrix G, the basis B is not unique.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "11263">Example <TT>AlgQuat_Basis_Reduction (H91E22)</TT></A></H3>
Recall that Minkowski basis reduction is used which returns a unique 
normalized reduced Gram matrix G for any definite quaternion ideal.  
This forms the core of the isomorphism testing for quaternion ideals. 
We illustrate this by applying it to representatives of the set of left
ideal classes of an order.
<P>
<P>
<PRE>
&gt; A := QuaternionOrder(19,2);
&gt; ideals := LeftIdealClasses(A);
&gt; #ideals;
5
&gt; [ (1/Norm(I))*ReducedGramMatrix(I) : I in ideals ];
[
    [ 2  0  1  1]
    [ 0  2  1  1]
    [ 1  1 20  1]
    [ 1  1  1 20],


    [6 0 1 3]
    [0 6 3 1]
    [1 3 8 1]
    [3 1 1 8],


    [6 0 1 3]
    [0 6 3 1]
    [1 3 8 1]
    [3 1 1 8],


    [ 4  0  1 -1]
    [ 0  4  1  1]
    [ 1  1 10  0]
    [-1  1  0 10],


    [ 4  0  1 -1]
    [ 0  4  1  1]
    [ 1  1 10  0]
    [-1  1  0 10]
]
</PRE>
<HR>
<H5><A NAME = "11264">ReducedGramMatrix(S) : AlgQuatOrd[RngUPol] -&gt; AlgMatElt, SeqEnum</A></H5>
<H5>ReducedGramMatrix(S) : AlgQuatOrdIdl[RngUPol] -&gt; AlgMatElt, SeqEnum</H5>
<H5>ReducedBasis(S) : AlgQuatOrd[RngUPol] -&gt; SeqEnum</H5>
<H5>ReducedBasis(S) : AlgQuatOrdIdl[RngUPol] -&gt; SeqEnum</H5>

<PRE>    Canonical: BoolElt                  Default: <TT>false</TT></PRE>
<BLOCKQUOTE>
Given an order or ideal S over F<sub>q</sub>[X] in a quaternion algebra A,
this function returns a Gram matrix and/or a basis of S whose Gram matrix
is in dominant diagonal form (see the function <TT>DominantDiagonalForm</TT>
in Section <A  HREF = "text333.htm#3208">Automorphism Group and  Isometry Testing over F<sub>q</sub>[t]</A>).
The Gram matrix will not be unique unless A is definite and
<TT>Canonical</TT> is set to <TT>true</TT>.
</BLOCKQUOTE>
<H5><A NAME = "11265">ReducedBasis(O) : AlgAssVOrd[RngOrd] -&gt; [AlgAssVElt]</A></H5>
<H5>ReducedBasis(I) : AlgAssVOrdIdl[RngOrd] -&gt; [AlgAssVOrdElt]</H5>
<BLOCKQUOTE>
Returns a "reduced" basis for the order O or the ideal I over some
number ring. If O or I arise from a definite quaternion algebra,
then this basis is LLL-reduced with respect to the norm form; otherwise,
the basis is reduced with respect to a Minkowski-like embedding
(see <A  HREF = "text981.htm#bib_kirschmer-voight">[KV10, Section 4]</A>).
</BLOCKQUOTE>
<H5><A NAME = "11266">OptimizedRepresentation(O) : AlgAssVOrd -&gt; AlgQuat, Map</A></H5>
<H5>OptimisedRepresentation(O) : AlgAssVOrd -&gt; AlgQuat, Map</H5>
<BLOCKQUOTE>
Given an order O contained in a quaternion algebra A over Q or
a number field F, this function returns a new quaternion algebra A' 
such that A' = ((a, b)/F) where a and b are small (with respect to O),
and, as second return value, an isomorphism A to A'.
</BLOCKQUOTE>
<H5><A NAME = "11267">OptimizedRepresentation(A) : AlgQuat -&gt; AlgQuat, Map</A></H5>
<H5>OptimisedRepresentation(A) : AlgQuat -&gt; AlgQuat, Map</H5>
<BLOCKQUOTE>
Given a quaternion algebra A over Q or a number field F,
this function returns a new quaternion algebra A' such that A' = ((a, b)/F)
where a and b are small.  An isomorphism A to A' is returned
as second value.
</BLOCKQUOTE>
<H5><A NAME = "11268">Enumerate(O, A, B) : AlgQuatOrd[RngInt], RngIntElt, RngIntElt -&gt; [AlgQuatOrdElt]</A></H5>
<H5>Enumerate(O, B) : AlgQuatOrd[RngInt], RngIntElt -&gt; [AlgQuatOrdElt]</H5>
<H5>Enumerate(O, A, B) : AlgQuatOrdIdl[RngInt], RngElt, RngElt -&gt; [AlgQuatElt]</H5>
<H5>Enumerate(O, B) : AlgQuatOrd[RngInt], RngElt -&gt; [AlgQuatElt]</H5>
<BLOCKQUOTE>
The sequence of all elements x (up to sign) in the definite quaternion
order O or ideal I over Z such that the reduced norm of x
lies in the interval [A, ... B] or [0, ... B], respectively.
</BLOCKQUOTE>
<H5><A NAME = "11269">Enumerate(O, A, B) : AlgAssVOrd[RngOrd], RngElt, RngElt -&gt; [AlgAssVOrdElt]</A></H5>
<H5>Enumerate(O, B) : AlgAssVOrd[RngOrd], RngElt -&gt; [AlgAssVOrdElt]</H5>
<H5>Enumerate(O, B) : AlgAssVOrd[RngOrd], [RngElt] -&gt; [AlgAssVOrdElt]</H5>
<H5>Enumerate(I, B) : AlgAssVOrdIdl[RngOrd], [RngElt] -&gt; [AlgAssVOrdElt]</H5>
<BLOCKQUOTE>
The sequence of elements x (up to sign) in the definite quaternion order O or
ideal I over a number ring such that the absolute trace of the norm of x
lies in the interval [A, ... B] or [0, ... B], respectively.
</BLOCKQUOTE>
<PRE></PRE> <A  HREF = "text996.htm">[Next]</A><A  HREF = "text994.htm">[Prev]</A> <A  HREF = "text996.htm">[Right]</A> <A  HREF = "text994.htm">[Left]</A> <A  HREF = "text982.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>