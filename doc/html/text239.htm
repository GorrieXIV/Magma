<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <link rel='stylesheet' href='help.css' type='text/css'>
  <TITLE>Elliptic and Modular Functions</TITLE>
</head>
<body BGCOLOR="#FFFFFF">

 <A  HREF = "text240.htm">[Next]</A><A  HREF = "text238.htm">[Prev]</A> <A  HREF = "text240.htm">[Right]</A> <A  HREF = "text238.htm">[Left]</A> <A  HREF = "text233.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<PRE></PRE><H3><A NAME = "2178">Elliptic and Modular Functions</A></H3>

<P>
<P>
More information on elliptic functions can be found
for example in Chandrasekharan
<A  HREF = "text232.htm#bib_chand85">[Cha85]</A>, and
for modular functions and their use see Koblitz
<A  HREF = "text232.htm#bib_koblitz84">[Kob84]</A>.



<H5>Subsections</H5>
<UL>
<LI> <A  HREF = "text239.htm#2179">Eisenstein Series</A>
<LI> <A  HREF = "text239.htm#2185">Weierstrass Series</A>
<LI> <A  HREF = "text239.htm#2190">The Jacobi &theta; and Dedekind &eta;- functions</A>
<LI> <A  HREF = "text239.htm#2196">The j-Invariant and the Discriminant</A>
<LI> <A  HREF = "text239.htm#2204">Weber's Functions</A>
</UL>
<H4><A NAME = "2179">Eisenstein Series</A></H4>

<P>
<P>
Let f(z) be a modular function. Then f(z) may be written as a Fourier 
series f(z) = &sum;<sub>n &isin;Z</sub> a<sub>n</sub> q<sup>n</sup>,
where q = e<sup>2 &pi; i z</sup>, which has at most finitely many nonzero coefficients
a<sub>n</sub> with n&lt;0. Such a Fourier expansion of a modular function is
called its <I>q-expansion</I>.
In this and the next section we present intrinsics for q-expansions 
of the Eisenstein series and the Weierstrass wp-function. 
<P>
<P>
<P>
Let z be a point in the upper half-plane and let
L be a lattice in C. The Eisenstein series are
defined as the coefficients of the
Laurent Series expansion of the Weierstrass wp-function:
wp(z, L) = ((1)/(z<sup>2</sup>)) + &sum;<sub>2&le;k</sub> G<sub>k</sub>(L)(2k - 1)z<sup>2k - 2</sup>
where G<sub>k</sub>(L) are the Eisenstein series. The normalization
E<sub>2n</sub>(z) = ((1)/(2 &zeta;(2n))) G<sub>2n</sub>(z)
ensures that E<sub>2n</sub>(z) has a <I>rational</I> q-expansion.


<H5><A NAME = "2180">Eisenstein(k, z) : RngIntElt, RngSerElt -&gt; RngSerElt</A></H5>

<PRE>    Precision: RngIntElt                Default: </PRE>
<BLOCKQUOTE>
Given a positive even integer k = 2n and a complex power series z with 
positive valuation, return the q-expansion of the normalized Eisenstein 
series E<sub>2n</sub>(z). If z has finite precision this is the default for 
<TT>Precision</TT> otherwise the default precision of the parent of z is used.
</BLOCKQUOTE>
<H5><A NAME = "2181">Eisenstein(k, t) : RngIntElt, FldComElt -&gt; FldComElt</A></H5>
<BLOCKQUOTE>
Given a positive even integer k = 2n and a point t in the 
upper half plane, return the value of E<sub>2n</sub>(z) at t.
<P>
</BLOCKQUOTE>
<H5><A NAME = "2182">Eisenstein(k, L) : RngIntElt, SeqEnum -&gt; FldComElt</A></H5>
<BLOCKQUOTE>
Given a positive even integer k = 2n and a lattice L = [a, b]
in the complex plane, return the value of the Eisenstein series 
E<sub>2n</sub>(z) relative to the lattice L.
<P>
</BLOCKQUOTE>
<H5><A NAME = "2183">Eisenstein(k, F) : RngIntElt, QuadBinElt -&gt; RngSerElt</A></H5>
<BLOCKQUOTE>
Given a positive even integer k = 2n and a binary quadratic form 
F = ax<sup>2</sup> + bxy + cy<sup>2</sup>, return the value of the Eisenstein series 
E<sub>2n</sub>(z) at the point &tau; = ( - b + Sqrt(b<sup>2</sup> - 4ac) )/(2a)
where z is e<sup>2&pi; * i * &tau;</sup>.
</BLOCKQUOTE>
<HR>
<H3><A NAME = "2184">Example <TT>FldRe_Eisenstein (H25E8)</TT></A></H3>
We compute the q-expansion for the normalized Eisenstein series
E<sub>4</sub>(z).
<P>
<P>
<PRE>
&gt; C&lt;i&gt; := ComplexField();
&gt; R&lt;z&gt; := PowerSeriesRing(C);
&gt; E4&lt;q&gt; := Eisenstein(4, z);
&gt; E4;
1.00000000000000000000000000000 +
    240.000000000000000000000000000*q +
    2160.00000000000000000000000000*q^2 +
    6720.00000000000000000000000000*q^3 +
    17520.0000000000000000000000000*q^4 +
    30240.0000000000000000000000000*q^5 +
    60480.0000000000000000000000000*q^6 +
    82560.0000000000000000000000000*q^7 +
    140400.000000000000000000000000*q^8 +
    181680.000000000000000000000000*q^9 +
    272160.000000000000000000000000*q^10 +
    319680.000000000000000000000000*q^11 +
    490560.000000000000000000000000*q^12 +
    527520.000000000000000000000000*q^13 +
    743040.000000000000000000000000*q^14 +
    846720.000000000000000000000000*q^15 +
    1123440.00000000000000000000000*q^16 +
    1179360.00000000000000000000000*q^17 +
    1635120.00000000000000000000000*q^18 +
    1646400.00000000000000000000000*q^19 + O(q^20)
</PRE>
We now evaluate this series at the point z1 = 2.5 + i. Since the
expansion is in terms of q rather than z we first must calculate
the point q1 that corresponds to z1.
<P>
<P>
<PRE>
&gt; q1 := Exp(2*Pi(RealField())*i*(2.5 +i));
&gt; Evaluate(E4, q1);
0.559302852856190773766762411942 +
3.67329046709782088758389413820E-31*i
</PRE>
If we are interested only in the value of E<sub>4</sub> at a single point,
then we can compute it directly:
<P>
<P>
<PRE>
&gt; Eisenstein(4, 2.5 + i);
0.559302852856190773766762411942 +
3.67329046709782088758389413820E-31*i
</PRE>
<HR>
<H4><A NAME = "2185">Weierstrass Series</A></H4>



<H5><A NAME = "2186">WeierstrassSeries(z, q) : RngSerElt, RngSerElt -&gt; RngSerElt</A></H5>

<PRE>    Precision: RngIntElt                Default: </PRE>
<BLOCKQUOTE>
Return a normalized q-expansion of the Weierstrass wp-function:
wp(z, L) = ((1)/(z<sup>2</sup>)) + &sum;<sub>2&le;k</sub> G<sub>k</sub>(L)(2k - 1)z<sup>2k - 2</sup>
where G<sub>k</sub>(L) are the Eisenstein series and
WeierstrassSeries(z, q) = (2 &pi; i)<sup> - 2</sup>wp(q, z/(2 &pi; i))
Each term is an Eisenstein series, calculated to precision <TT>Precision</TT>,
which is by default the precision of q.
<P>
</BLOCKQUOTE>
<H5><A NAME = "2187">WeierstrassSeries(z, t) : RngSerElt, FldComElt -&gt; RngSerElt</A></H5>
<BLOCKQUOTE>
Given a complex power series z with positive valuation and a
point t =&tau; in the upper-half complex plane, return the 
normalized q-expansion of the Weierstrass wp-function.
This is equivalent to evaluating the q-series expansion at
q = e<sup>2&pi; i&tau;</sup>.
<P>
</BLOCKQUOTE>
<H5><A NAME = "2188">WeierstrassSeries(z, L) : RngSerElt, SeqEnum -&gt; RngSerElt</A></H5>
<BLOCKQUOTE>
Given a complex power series z with positive valuation and 
a lattice L = [a, b] in the complex plane, returns the 
normalized q-expansion of the Weierstrass wp-function
relative to the lattice L.
<P>
</BLOCKQUOTE>
<H5><A NAME = "2189">WeierstrassSeries(z, F) : RngSerElt, QuadBinElt -&gt; RngSerElt</A></H5>
<BLOCKQUOTE>
Given a complex power series z with positive valuation and 
a binary quadratic form F = ax<sup>2</sup> + bxy + cy<sup>2</sup>, this function returns 
the q-expansion of the Weierstrass wp-function at
&tau; = ( - b + Sqrt(b<sup>2</sup> - 4ac) )/(2a).
</BLOCKQUOTE>
<H4><A NAME = "2190">The Jacobi &theta; and Dedekind &eta;- functions</A></H4>

<P>
<P>
The first Jacobi &theta;-function, &theta;(q, z), is defined by
&theta;(q, z)=(1/i)&sum;<sub>n= - &infin;</sub>^&infin;( - 1)<sup>n</sup>q^((n + (1/2))<sup>2</sup>)e<sup>(2n + 1)i z</sup>=2&sum;<sub>n=0</sub>^&infin;( - 1)<sup>n</sup>q^((n + (1/2))<sup>2</sup>)sin(2n + 1)z.
<P>
Defined this way, &theta; satisfies &theta;(q, - z)= - &theta;(q, z), it is
periodic with period 2&pi; in the second variable: &theta;(q, z + 2&pi;)=
&theta;(q, z), and its zeroes are of the form m<sub>1</sub>&pi; + m<sub>2</sub>(log x/i)
for any integers m<sub>1</sub>, m<sub>2</sub>.


<H5><A NAME = "2191">JacobiTheta(q, z) : FldReElt, RngSerElt[FldRe] -&gt; RngSerElt</A></H5>
<H5>JacobiTheta(q, z) : FldComElt, RngSerElt[FldCom] -&gt; RngSerElt</H5>
<BLOCKQUOTE>
For a real or complex number q satisfying |q|&lt;1, return
the first of Jacobi's theta functions &theta;(q, z) as a power series
expansion in z, a series over the complex numbers.  
Pari is used here.
</BLOCKQUOTE>
<H5><A NAME = "2192">JacobiTheta(q, z) : FldReElt, FldReElt -&gt; FldReElt</A></H5>
<H5>JacobiTheta(q, z) : FldComElt, FldComElt -&gt; FldComElt</H5>
<BLOCKQUOTE>
For real or complex numbers q, z satisfying |q|&lt;1,
return the value of &theta;(q, z), the first of Jacobi's theta functions.
Pari is used here.
<P>
<P>
</BLOCKQUOTE>
<H5><A NAME = "2193">JacobiThetaNullK(q, k) : FldReElt, RngIntElt -&gt; FldReElt</A></H5>
<BLOCKQUOTE>
For integer k&ge;0, return the k-th derivative &theta;<sup>(k)</sup>(q, 0)
of &theta;(q, z) at z=0.
Pari is used here.
</BLOCKQUOTE>
<H5><A NAME = "2194">DedekindEta(z) : RngSerElt -&gt; RngSerElt</A></H5>
<BLOCKQUOTE>
Given a complex power series z with positive valuation,
return the q-expansion of Dedekind's &eta;-function. 
Note that the unnormalized series is returned, that is, 
the factor q<sup>1/24</sup> is <I>not</I> removed.
See <A  HREF = "text232.htm#bib_lang87">[Lan87]</A>.
</BLOCKQUOTE>
<H5><A NAME = "2195">DedekindEta(s) : FldComElt -&gt; FldComElt</A></H5>
<BLOCKQUOTE>
For complex argument s with positive imaginary part, this returns 
the actual
value of Dedekind's &eta;-function which is defined by
&eta;(s)=e<sup>2&pi;i s/24</sup> (1 + &sum;<sub>n=1</sub>^&infin;( - 1)<sup>n</sup> (q<sup>n(3n - 1)/2</sup> + q<sup>n(3n + 1)/2</sup>) ) where q = e<sup>2&pi;i s</sup>.
</BLOCKQUOTE>
<H4><A NAME = "2196">The j-Invariant and the Discriminant</A></H4>

<P>
<P>
The discriminant of the elliptic curve corresponding to the complex lattice
L<sub>&tau;</sub>, spanned by 1 and &tau; is given by
&Delta;(&tau;) = q (1 + &sum;<sub>n=1</sub>^&infin;( - 1)<sup>n</sup> (q<sup>n(3n - 1)/2</sup> + q<sup>n(3n + 1)/2</sup>) ) 
where q = e<sup>2&pi;i &tau;</sup>.


<H5><A NAME = "2197">jInvariant(q) : RngSerElt -&gt; RngSerElt</A></H5>
<BLOCKQUOTE>
Given a power series q over a real or complex field with positive 
valuation, return the q-expansion of the elliptic j-invariant.  
The expansion begins with
j(q) = q<sup> - 1</sup> + 744 + 196884 q + ... .
<P>
Note that:
j(q) = (((E<sub>4</sub>(q))<sup>3</sup>)/(&Delta;(q))) where 
E<sub>4</sub>(q) = <TT>Eisenstein(4, q)</TT> and &Delta;(q) = <TT>Delta(q)</TT>.
</BLOCKQUOTE>
<H5><A NAME = "2198">jInvariant(s) : FldComElt -&gt; FldComElt</A></H5>
<BLOCKQUOTE>
For complex argument s with positive imaginary part, this returns the
value of the elliptic j-invariant at s.
This is a modular function of weight 0 whose
Fourier expansion starts with
j(s)=e<sup> - 2&pi;i s</sup> + 744 + 196884e<sup>2&pi;i s</sup> + ... .
</BLOCKQUOTE>
<H5><A NAME = "2199">jInvariant(L) : SeqEnum -&gt; FldComElt</A></H5>
<BLOCKQUOTE>
Given a lattice L = [a, b] in the complex plane, this function
returns the value of the elliptic j-invariant of L.  This is 
the j-invariant of &tau; where &tau; = a/b or &tau; = b / a, 
whichever is in the upper half complex plane.
</BLOCKQUOTE>
<H5><A NAME = "2200">jInvariant(F) : QuadBinElt -&gt; FldComElt</A></H5>
<BLOCKQUOTE>
For a binary quadratic form F = ax<sup>2</sup> + bxy + cy<sup>2</sup> with negative discriminant,
this returns the elliptic j-invariant of F.  This is the j-invariant
of &tau; where &tau; = ( - b + Sqrt(b<sup>2</sup> - 4ac)) / (2a).
</BLOCKQUOTE>
<H5><A NAME = "2201">Delta(z) : RngSerElt -&gt; RngSerElt</A></H5>
<BLOCKQUOTE>
Given a complex power series z, this function returns a 
q-series expansion of the discriminant &Delta;(z).
</BLOCKQUOTE>
<H5><A NAME = "2202">Delta(t) : FldComElt -&gt; FldComElt</A></H5>
<BLOCKQUOTE>
Given a point t in the upper half plane,
return the q-series expansion of the discriminant &Delta;(q) 
evaluated at q = e<sup>2&pi;i t</sup>.
<P>
</BLOCKQUOTE>
<H5><A NAME = "2203">Delta(L) : SeqEnum -&gt; FldComElt</A></H5>
<BLOCKQUOTE>
Given a pair L = [a,b] of complex numbers generating a lattice in
C, return the q-series expansion of the discriminant &Delta;(q)
evaluated at q = e<sup>2&pi;i&tau;</sup> where &tau; = a/b or &tau; = b / a, whichever is in the 
upper half complex plane.
</BLOCKQUOTE>
<H4><A NAME = "2204">Weber's Functions</A></H4>



<H5><A NAME = "2205">WeberF(s) : FldComElt -&gt; FldComElt</A></H5>
<BLOCKQUOTE>
For complex argument s in the upper half-plane, this 
returns the value of Weber's function f, defined in such a way that 
j(s)=((f(s)<sup>24</sup> - 16)<sup>3</sup>/f(s)<sup>24</sup>).
</BLOCKQUOTE>
<H5><A NAME = "2206">WeberF2(g) : RngSerElt -&gt; RngSerElt</A></H5>
<BLOCKQUOTE>
For a complex power series g having positive valuation, this 
function returns the q-expansion of Weber's f<sub>2</sub> function 
f<sub>2</sub>(x)=(&eta;(2x)Sqrt(2)/&eta;(x)) 
defined in such a way that 
j(s)=((f<sub>2</sub>(s)<sup>24</sup> + 16)<sup>3</sup>/f<sub>2</sub>(s)<sup>24</sup>).
</BLOCKQUOTE>
<H5><A NAME = "2207">WeberF1(s) : FldComElt -&gt; FldComElt</A></H5>
<H5>WeberF2(s) : FldComElt -&gt; FldComElt</H5>
<BLOCKQUOTE>
For complex number s lying in the upper half-plane, these return
the value of Weber's functions f<sub>1</sub> and f<sub>2</sub>, defined in such a way 
that 
j(s)=((f<sub>1/2</sub>(s)<sup>24</sup> + 16)<sup>3</sup>/f<sub>1/2</sub>(s)<sup>24</sup>).
In fact, f<sub>2</sub> is as defined above and
f<sub>1</sub>(x)=f<sub>2</sub>( - 1/x)=(&eta;(x/2)/&eta;(x)).
</BLOCKQUOTE>
<HR>
<H3><A NAME = "2208">Example <TT>FldRe_Eisenstein (H25E9)</TT></A></H3>
We compute the q-expansion for the Weber function f<sub>2</sub>(z).
<P>
<P>
<PRE>
&gt; C&lt;i&gt; := ComplexField();
&gt; R&lt;x&gt; := PowerSeriesRing(C);
&gt; f2&lt;q&gt; := WeberF2(x); 
&gt; f2;
1.41421356237309504&equiv;68872421 +
    (1.41421356237309504&equiv;68872421 +
    0.370240244846530520584656749172*i)*q +
    (1.36574922765338060759226121771 +
    0.370240244846530520584656749172*i)*q^2 +
    (2.77996279002647565639394994192 +
    0.366010933793292419482272977081*i)*q^3 +
    (2.78023959778761313408864734217 +
    0.736251178639822940066929726253*i)*q^4 +
    (4.14598882544099374168090855987 +
    0.736265672260303709036837819528*i)*q^5 +
    (5.56020175541059398072755542234 +
    1.10227660605359612851911079661*i)*q^6 +
    ...
</PRE>
<HR>
<PRE></PRE> <A  HREF = "text240.htm">[Next]</A><A  HREF = "text238.htm">[Prev]</A> <A  HREF = "text240.htm">[Right]</A> <A  HREF = "text238.htm">[Left]</A> <A  HREF = "text233.htm">[Up]</A> <A  HREF = "ind.htm">[Index]</A> <A  HREF = "MAGMA.htm">[Root]</A>
<br><small>Version: V2.22 of <I>
Thu Jun  9 16:37:49 EST 2016
</I></small>
</body></html>